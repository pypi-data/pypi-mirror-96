define("ipyturtle2",["@jupyter-widgets/base"],(function(t){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(2);e.MODULE_VERSION=n.version,e.MODULE_NAME=n.name},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(0)),n(i(3))},function(t){t.exports=JSON.parse('{"name":"ipyturtle2","version":"0.8.1","description":"Turtle implemention for Jupyter Notebook","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/boyuai/ipyturtle2","bugs":{"url":"https://github.com/boyuai/ipyturtle2/issues"},"license":"BSD-3-Clause","author":{"name":"wangsijie","email":"i@sijie.wang"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/boyuai/ipyturtle2"},"scripts":{"build":"npm run build:lib && npm run build:nbextension","build:labextension":"npm run clean:labextension && mkdirp ipyturtle2/labextension && cd ipyturtle2/labextension && npm pack ../..","build:lib":"tsc","build:nbextension":"webpack -p","build:all":"npm run build:labextension && npm run build:nbextension","clean":"npm run clean:lib && npm run clean:nbextension","clean:lib":"rimraf lib","clean:labextension":"rimraf ipyturtle2/labextension","clean:nbextension":"rimraf ipyturtle2/nbextension/static/index.js","prepack":"npm run build:lib","test":"npm run test:firefox","test:chrome":"karma start --browsers=Chrome tests/karma.conf.js","test:debug":"karma start --browsers=Chrome --singleRun=false --debug=true tests/karma.conf.js","test:firefox":"karma start --browsers=Firefox tests/karma.conf.js","test:ie":"karma start --browsers=IE tests/karma.conf.js","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch"},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2 || ^3"},"devDependencies":{"@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@types/expect.js":"^0.3.29","@types/mocha":"^5.2.5","@types/node":"^10.11.6","@types/webpack-env":"^1.13.6","acorn":"^7.2.0","css-loader":"^3.2.0","expect.js":"^0.3.1","fs-extra":"^7.0.0","karma":"^3.1.0","karma-chrome-launcher":"^2.2.0","karma-firefox-launcher":"^1.1.0","karma-ie-launcher":"^1.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-typescript":"^5.0.3","karma-typescript-es6-transform":"^5.0.3","mkdirp":"^0.5.1","mocha":"^5.2.0","npm-run-all":"^4.1.3","rimraf":"^2.6.2","source-map-loader":"^0.2.4","style-loader":"^1.0.0","ts-loader":"^5.2.1","typescript":"~3.8","webpack":"^4.20.2","webpack-cli":"^3.1.2"},"jupyterlab":{"extension":"lib/plugin"}}')},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,a){function r(t){try{l(n.next(t))}catch(t){a(t)}}function o(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,o)}l((n=n.apply(t,e||[])).next())}))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(4),r=i(0);i(5);const o=s(i(9));function l(t){return 2*Math.PI*(t/360)}class c extends a.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:c.model_name,_model_module:c.model_module,_model_module_version:c.model_module_version,_view_name:c.view_name,_view_module:c.view_module,_view_module_version:c.view_module_version})}}e.TurtleModel=c,c.serializers=Object.assign({},a.DOMWidgetModel.serializers),c.model_name="TurtleModel",c.model_module=r.MODULE_NAME,c.model_module_version=r.MODULE_VERSION,c.view_name="TurtleView",c.view_module=r.MODULE_NAME,c.view_module_version=r.MODULE_VERSION;class d extends a.DOMWidgetView{constructor(){super(...arguments),this.isTurtleOn=!0,this.baseCommand={id:0,isPenOn:!0,isFilling:!1,isTurtleOn:!0,isAnimating:!1,x:0,y:0,heading:0,color:"black",fillColor:"black",lineWidth:1},this.fillPaths=[],this.lastCommandId=0,this.isExecCommands=!1,this.rotationSpeed=10,this.speed=5}render(){this.el.classList.add("turtle-widget"),this.div=document.createElement("div");const t=this.model.get("_is_canvas_fixed"),e=this.model.get("_canvas_width"),i=this.model.get("_canvas_height");this.div.style.position=t?"fixed":"static",this.div.style.right="50px",this.div.style.top="140px",this.div.style.width=e+"px",this.div.style.height=i+"px",this.div.style.border="thin solid #0000FF",this.div.style.background="#efefef",this.div.style.cursor="move",this.div.style.zIndex="999",this.div.className="turtle_div",this.div.setAttribute("draggable","true"),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",e.toString()),this.canvas.setAttribute("height",i.toString()),this.canvas.style.width=e+"px",this.canvas.style.height=i+"px",this.div.appendChild(this.canvas),this.el.appendChild(this.div),this.canvas.className="turtle_canvas";const n=this.canvas.getContext("2d");this.clearImageData=n.getImageData(0,0,this.canvas.width,this.canvas.height),this.drawTurtle(this.baseCommand),this.bindMouseEvent(),this.registerHooks(),this.update()}bindMouseEvent(){let t=0,e=0,i=0,n=0;this.div.addEventListener("dragstart",t=>{i=t.clientX,n=t.clientY},!1),this.div.addEventListener("drag",s=>{s.preventDefault(),s.clientX&&(t=i-s.clientX,e=n-s.clientY,i=s.clientX,n=s.clientY,this.div.style.top=this.div.offsetTop-e+"px",this.div.style.left=this.div.offsetLeft-t+"px")}),this.div.addEventListener("dragover",t=>{t.preventDefault()})}update(){return this.isExecCommands||this.execCommands(),super.update()}execCommands(){return n(this,void 0,void 0,(function*(){this.isExecCommands=!0;let t=this.model.get("_commands")||[],e=t.filter(t=>t.id>this.lastCommandId);if(e.length>0)for(const t of e){if(!document.body.contains(this.el))return;let{type:e,id:i}=t;if(i<=this.lastCommandId)continue;this.lastCommandId=i,this.baseCommand=t,this.clearTurtle();let n={};"line"===e?n=yield this.drawLine(t):"reset"===e?this.reset():"beginFill"===e?this.beginFill(t):"endFill"===e?this.endFill():"updateTurtle"===e||("left"===e?n=yield this.rotateLeft(t):"right"===e?n=yield this.rotateRight(t):"write"===e?this.writeText(t):"dot"===e?this.drawDot(t):"circle"===e?n=yield this.drawCircle(t):"spiralCircle"===e?n=yield this.drawSpiralCircle(t):"spiralForward"===e&&(n=yield this.drawSpiralForward(t))),this.drawTurtle(Object.assign(Object.assign({},t),n)),t.isAnimating&&(yield this.waitFrame(20))}t=this.model.get("_commands")||[],e=t.filter(t=>t.id>this.lastCommandId),e.length>0?yield this.execCommands():this.isExecCommands=!1}))}drawContext(t){const{lineWidth:e,color:i,fillColor:n}=this.baseCommand,s=this.canvas.getContext("2d");s.save(),s.setTransform(1,0,0,-1,this.canvas.width/2,this.canvas.height/2),s.lineWidth=e,s.strokeStyle=i,s.fillStyle=n,t(s),s.restore()}waitFrame(t=20){return new Promise(e=>{setTimeout(()=>{requestAnimationFrame(e)},t)})}drawTurtle(t){const{x:e,y:i,heading:n,color:s,fillColor:a,isTurtleOn:r}=t;if(!r)return;const o=this.model.get("_turtle_width"),c=this.model.get("_turtle_height"),d=Math.cos(l(n)),u=Math.sin(l(n)),h=c*d,f=c*u,m=e-.7*h,p=i-.7*f,g=e-.5*o*u-1*h,y=i+.5*o*d-1*f,v=e+.5*o*u-1*h,b=i-.5*o*d-1*f;this.drawContext(t=>{this.imageData=t.getImageData(0,0,this.canvas.width,this.canvas.height),t.strokeStyle=s,t.fillStyle=a,t.beginPath(),t.moveTo(e,i),t.lineTo(v,b),t.lineTo(m,p),t.lineTo(g,y),t.closePath(),t.fill(),t.stroke()})}clearTurtle(){this.imageData&&(this.canvas.getContext("2d").putImageData(this.imageData,0,0),this.imageData=void 0)}reset(){this.fillPaths=[],this.canvas.getContext("2d").putImageData(this.clearImageData,0,0)}beginFill(t){const{x:e,y:i,color:n}=t;this.drawContext(t=>{this.fillImageData=t.getImageData(0,0,this.canvas.width,this.canvas.height)}),this.fillPaths=[{type:"begin",x:e,y:i,color:n}]}endFill(){this.drawContext(t=>{this.fillPaths.length<=1?this.fillPaths=[]:(t.putImageData(this.fillImageData,0,0),this.fillPaths.forEach(e=>{"begin"===e.type?(t.beginPath(),t.moveTo(e.x,e.y)):"line"===e.type?t.lineTo(e.x,e.y):"arc"===e.type&&t.arc(e.x,e.y,e.radius,l(e.start),l(e.end),e.anticlockwise)}),t.closePath(),t.fill(),this.fillPaths.forEach(e=>{"begin"===e.type||("line"===e.type?(t.beginPath(),t.save(),t.strokeStyle=e.color,t.moveTo(e.startX,e.startY),t.lineTo(e.x,e.y),t.stroke(),t.restore()):"arc"===e.type?(t.beginPath(),t.save(),t.strokeStyle=e.color,t.moveTo(e.startX,e.startY),t.arc(e.x,e.y,e.radius,l(e.start),l(e.end),e.anticlockwise),t.stroke(),t.restore()):"dot"===e.type?(t.beginPath(),t.save(),t.fillStyle=e.dotColor,t.arc(e.x,e.y,e.size,0,2*Math.PI),t.fill(),t.restore()):"text"===e.type&&(t.save(),t.font=e.fontStyle,t.textAlign=e.align,t.fillStyle=e.textColor,t.transform(1,0,0,-1,0,0),t.fillText(e.text,e.x,-e.y),t.restore()))}))}),this.fillPaths=[]}rotateLeft(t){return n(this,void 0,void 0,(function*(){const{degree:e,x:i,y:n,heading:s}=t;let a=0;for(;a+=this.rotationSpeed,a>e&&(a=e),this.drawTurtle(Object.assign(Object.assign({},t),{x:i,y:n,heading:s+a})),t.isAnimating&&(yield this.waitFrame(5)),this.clearTurtle(),a!==e;);return{heading:s+a}}))}rotateRight(t){return n(this,void 0,void 0,(function*(){const{degree:e,x:i,y:n,heading:s}=t;let a=0;for(;a+=this.rotationSpeed,a>e&&(a=e),this.drawTurtle(Object.assign(Object.assign({},t),{x:i,y:n,heading:s-a})),t.isAnimating&&(yield this.waitFrame(20)),this.clearTurtle(),a!==e;);return{heading:s-a}}))}drawLine(t){return n(this,void 0,void 0,(function*(){let{distance:e,x:i,y:n,heading:s,isPenOn:a,isFilling:r,color:o}=t;const c=Math.cos(l(s)),d=Math.sin(l(s));let u,h=i+e*c,f=n+e*d,m=i,p=i,g=n,y=n;u=e>0?1:-1;let v=0;for(;v+=this.speed*u,Math.abs(v)>=Math.abs(e)?(v=e,p=h,y=f):(p+=c*this.speed*u,y+=d*this.speed*u),a&&this.drawContext(t=>{t.beginPath(),t.moveTo(i,n),t.lineTo(p,y),t.closePath(),t.stroke()}),i=p,n=y,this.drawTurtle(Object.assign(Object.assign({},t),{x:i,y:n})),t.isAnimating&&(yield this.waitFrame(20)),this.clearTurtle(),v!==e;);return r&&this.fillPaths.push({type:"line",color:o,x:i,y:n,startX:m,startY:g}),{x:i,y:n}}))}writeText(t){const{text:e,align:i,font:n,x:s,y:a,color:r,isFilling:o}=t,[l,c,d]=n,u=`${d} ${c}px  ${l}`;this.drawContext(t=>{t.font=u,t.textAlign=i,t.fillStyle=r,t.transform(1,0,0,-1,0,0),t.fillText(e,s,-a)}),o&&this.fillPaths.push({type:"text",text:e,textColor:r,x:s,y:a,fontStyle:u,align:i})}drawDot(t){const{x:e,y:i,size:n,dotColor:s,isFilling:a}=t;this.drawContext(t=>{t.beginPath(),t.fillStyle=s,t.arc(e,i,n,0,2*Math.PI),t.fill()}),a&&this.fillPaths.push({type:"dot",dotColor:s,x:e,y:i,size:n})}drawCircle(t){return n(this,void 0,void 0,(function*(){let e,i,{radius:n,extent:s,x:a,y:r,heading:o,isPenOn:c,isFilling:d,color:u}=t,h=!1;s*=n>0?1:-1,s<0&&(h=!0),e=o-90,i=e+s;const f=a+n*Math.cos(l(e+180)),m=r+n*Math.sin(l(e+180)),p=Math.abs(l(Math.abs(s))*n),g=Math.ceil(p/this.speed),y=s/g;let v,b,x=e;for(let e=0;e<g;e++){if(c){const t=n<0?180:0;this.drawContext(e=>{e.beginPath(),e.arc(f,m,Math.abs(n),l(x+t),l(x+y+t),h),e.stroke()})}x+=y,v=f+n*Math.cos(l(x)),b=m+n*Math.sin(l(x)),this.drawTurtle(Object.assign(Object.assign({},t),{x:v,y:b,heading:x+90})),t.isAnimating&&(yield this.waitFrame(20)),this.clearTurtle()}return v=f+n*Math.cos(l(i)),b=m+n*Math.sin(l(i)),o=i+90,d&&this.fillPaths.push({type:"arc",color:u,x:f,y:m,radius:n,start:e,end:i,startX:a,startY:r,endX:v,endY:v,anticlockwise:h}),{x:v,y:b,heading:o}}))}drawSpiralCircle(t){return n(this,void 0,void 0,(function*(){let{x:e,y:i,heading:n,steps:s,startRadius:a,radiusStride:r,angleStride:o}=t;for(let l=0;l<s;l++){const s=a+l*r,c=yield this.drawCircle(Object.assign(Object.assign({},t),{type:"circle",x:e,y:i,heading:n,radius:s,extent:o}));e=c.x,i=c.y,n=c.heading,this.drawTurtle(Object.assign(Object.assign({},t),{x:e,y:i,heading:n})),t.isAnimating&&(yield this.waitFrame(20)),this.clearTurtle()}return{x:e,y:i,heading:n}}))}drawSpiralForward(t){return n(this,void 0,void 0,(function*(){let{x:e,y:i,heading:n,steps:s,startArcLength:a,arcLengthStride:r,angleStride:o}=t;for(let l=0;l<s;l++){const s=a+l*r,c=yield this.drawLine(Object.assign(Object.assign({},t),{type:"line",x:e,y:i,heading:n,distance:s}));e=c.x,i=c.y;const{heading:d}=yield this.rotateLeft(Object.assign(Object.assign({},t),{type:"left",x:e,y:i,heading:n,degree:o}));n=d}return{x:e,y:i,heading:n}}))}registerHooks(){window.__ipyturtle_get_image_data=t=>new Promise((e,i)=>{const s=t?o.default(this.canvas):this.canvas;null==s||s.toBlob(t=>n(this,void 0,void 0,(function*(){const i=yield null==t?void 0:t.arrayBuffer();e(i)})),"png")})}}e.TurtleView=d},function(e,i){e.exports=t},function(t,e,i){var n=i(6),s=i(7);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var a={insert:"head",singleton:!1};n(s,a);t.exports=s.locals||{}},function(t,e,i){"use strict";var n,s=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},a=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),r=[];function o(t){for(var e=-1,i=0;i<r.length;i++)if(r[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],s=0;s<t.length;s++){var a=t[s],l=e.base?a[0]+e.base:a[0],c=i[l]||0,d="".concat(l," ").concat(c);i[l]=c+1;var u=o(d),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(r[u].references++,r[u].updater(h)):r.push({identifier:d,updater:g(h,e),references:1}),n.push(d)}return n}function c(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var s=i.nc;s&&(n.nonce=s)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var r=a(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var d,u=(d=[],function(t,e){return d[t]=e,d.filter(Boolean).join("\n")});function h(t,e,i,n){var s=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=u(e,s);else{var a=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function f(t,e,i){var n=i.css,s=i.media,a=i.sourceMap;if(s?t.setAttribute("media",s):t.removeAttribute("media"),a&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var m=null,p=0;function g(t,e){var i,n,s;if(e.singleton){var a=p++;i=m||(m=c(e)),n=h.bind(null,i,a,!1),s=h.bind(null,i,a,!0)}else i=c(e),n=f.bind(null,i,e),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=s());var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var s=o(i[n]);r[s].references--}for(var a=l(t,e),c=0;c<i.length;c++){var d=o(i[c]);0===r[d].references&&(r[d].updater(),r.splice(d,1))}i=a}}}},function(t,e,i){(e=i(8)(!1)).push([t.i,".custom-widget {\r\n  background-color: lightseagreen;\r\n  padding: 0px 2px;\r\n}\r\n",""]),t.exports=e},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var s=(r=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),a=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[i].concat(a).concat([s]).join("\n")}var r,o,l;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var s={};if(n)for(var a=0;a<this.length;a++){var r=this[a][0];null!=r&&(s[r]=!0)}for(var o=0;o<t.length;o++){var l=[].concat(t[o]);n&&s[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){const e=t.getContext("2d"),{width:i,height:n}=t,s={x:[],y:[]},a=e.getImageData(0,0,i,n);let r=0;for(let t=0;t<n;t++)for(let e=0;e<i;e++)r=4*(t*i+e),a.data[r+3]>0&&(s.x.push(e),s.y.push(t));s.x.sort((function(t,e){return t-e})),s.y.sort((function(t,e){return t-e}));const o=s.x.length-1,l=1+s.x[o]-s.x[0],c=1+s.y[o]-s.y[0],d=e.getImageData(s.x[0],s.y[0],l,c),u=document.createElement("canvas");return u.width=l,u.height=c,u.getContext("2d").putImageData(d,0,0),u}}])}));
//# sourceMappingURL=embed-bundle.js.map