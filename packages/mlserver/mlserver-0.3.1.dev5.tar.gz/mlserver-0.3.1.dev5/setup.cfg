[flake8]
max-line-length = 88
extend-ignore = 
	E203,
exclude = 
	./mlserver/grpc/dataplane_pb2*
	./mlserver/grpc/model_repository_pb2*
	./mlserver.egg-info
	./.tox

[mypy]
ignore_missing_imports = True
plugins = pydantic.mypy

[tox:tox]
basepython = py3
envlist = 
	py3
	sklearn
	xgboost
	lightgbm
	tempo
	all

[testenv]
deps = -r{toxinidir}/requirements-dev.txt
commands = pytest {posargs} {toxinidir}/tests

[testenv:sklearn]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/sklearn
	-r{toxinidir}/requirements-dev.txt
commands = pytest {posargs} {toxinidir}/runtimes/sklearn

[testenv:xgboost]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/xgboost
	-r{toxinidir}/requirements-dev.txt
commands = pytest {posargs} {toxinidir}/runtimes/xgboost

[testenv:lightgbm]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/lightgbm
	-r{toxinidir}/requirements-dev.txt
commands = pytest {posargs} {toxinidir}/runtimes/lightgbm

[testenv:tempo]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/tempo
	-r{toxinidir}/requirements-dev.txt
commands = pytest {posargs} {toxinidir}/runtimes/tempo

[testenv:all]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/sklearn
	-e{toxinidir}/runtimes/xgboost
	-e{toxinidir}/runtimes/mllib
	-e{toxinidir}/runtimes/lightgbm
	-e{toxinidir}/runtimes/tempo
	-r{toxinidir}/requirements-dev.txt
commands = pytest {posargs}

[testenv:licenses]
deps = 
	-e{toxinidir}
	-e{toxinidir}/runtimes/sklearn
	-e{toxinidir}/runtimes/xgboost
	-e{toxinidir}/runtimes/mllib
	-e{toxinidir}/runtimes/lightgbm
	-e{toxinidir}/runtimes/tempo
	-r{toxinidir}/requirements-dev.txt
commands = 
	pip-licenses \
	--from=mixed \
	--format=csv \
	--output-file=./licenses/license_info.csv
	pip-licenses \
	--from=mixed \
	--format=plain-vertical \
	--with-license-file \
	--no-license-path \
	--output-file=./licenses/license.txt

[egg_info]
tag_build = 
tag_date = 0

