(this["webpackJsonpmcmc-monitor"]=this["webpackJsonpmcmc-monitor"]||[]).push([[0],{121:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var r=n(9),c=n(1),i=n(18),o=n.n(i),a=(n(121),n(2));var s=function(){var e=Object(r.e)().filter((function(e){return"MainWindow"===e.name}))[0];if(!e)throw Error("Unable to find main window plugin.");return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)("header",{className:"App-header",children:Object(a.jsx)(e.component,{})})})},u=n(53),l=(n(123),n(15)),b=n(11),j=n(167),d=n(169),f=n(170),p=n(171),O=n(172),h=n(182),m=n(151),x=n(173),k=n(174),v=(n(124),function(e){var t=e.title,n=e.rowKey,r=e.onDeleteRow,i=Object(c.useCallback)((function(){r&&r(n)}),[r,n]);return Object(a.jsx)(m.a,{title:t,onClick:i,children:Object(a.jsx)(x.a,{})})}),y=function(e){var t=e.title,n=e.rowKey,r=e.onConfirmDeleteRow,i=Object(c.useCallback)((function(){r&&r(n,!0)}),[r,n]),o=Object(c.useCallback)((function(){r&&r(n,!1)}),[r,n]);return Object(a.jsxs)("span",{children:["Confirm delete?",Object(a.jsx)(m.a,{title:t,onClick:i,children:Object(a.jsx)(x.a,{})}),Object(a.jsx)(m.a,{title:"Cancel",onClick:o,children:"\u2716"})]})},g=function(e){var t=e.title,n=e.rowKey,r=e.onEditRow;return Object(a.jsx)(m.a,{title:t,onClick:function(){return r&&r(n)},children:Object(a.jsx)(k.a,{})})},w=function(e){return 0==e?e:e?"object"==typeof e?e.element?e.element:e.text||"":e:""},C=function(e){var t=e.rows,n=e.columns,r=e.onDeleteRow,i=void 0===r?void 0:r,o=e.deleteRowLabel,s=void 0===o?void 0:o,u=e.onEditRow,l=void 0===u?void 0:u,m=e.editRowLabel,x=void 0===m?void 0:m,k=e.selectionMode,C=void 0===k?"none":k,I=e.selectedRowKeys,R=void 0===I?{}:I,M=e.onSelectedRowKeysChanged,D=void 0===M?void 0:M,E=e.noConfirmDeleteRow,P=Object(c.useMemo)((function(){var e={};return Object.keys(R).forEach((function(t){e[t]=R[t]})),e}),[R]),N=Object(c.useState)(null),S=Object(b.a)(N,2),J=S[0],V=S[1],W=Object(c.useCallback)((function(e){D&&("single"===C?e in P&&P[e]?D([]):D([e+""]):"multiple"===C&&D(Object.keys(P).filter((function(t){return t!=e&&P[t]})).concat(P[e]?[]:[e.toString()])))}),[D,C,P]),K=Object(c.useCallback)((function(e,t){t&&i&&i(e),V(null)}),[i]),U=Object(c.useCallback)((function(e){E?K(e,!0):V(e)}),[E,K]),T=Object(c.useCallback)((function(e){l&&l(e)}),[l]);return Object(a.jsxs)(j.a,{className:"NiceTable",children:[Object(a.jsx)(d.a,{children:Object(a.jsxs)(f.a,{children:[Object(a.jsx)(p.a,{style:{width:0}},"_first"),n.map((function(e){return Object(a.jsx)(p.a,{children:Object(a.jsx)("span",{children:e.label})},e.key)}))]})}),Object(a.jsx)(O.a,{children:t.map((function(e){return Object(a.jsxs)(f.a,{children:[Object(a.jsxs)(p.a,{children:[i&&(J===e.key?Object(a.jsx)(y,{title:s||"",onConfirmDeleteRow:K,rowKey:e.key}):Object(a.jsx)(v,{title:s||"",onDeleteRow:U,rowKey:e.key})),l&&Object(a.jsx)(g,{title:x||"",onEditRow:T,rowKey:e.key}),"none"!==C&&Object(a.jsx)(h.a,{checked:P[e.key]||!1,onClick:function(){return W(e.key)}})]}),n.map((function(t){return Object(a.jsx)(p.a,{children:Object(a.jsx)("span",{children:w(e.columnValues[t.key])})},t.key)}))]},e.key)}))})]})},I=function(e){var t=e.iterations,n=Object(c.useMemo)((function(){var e={};return t.forEach((function(t){var n=t.chainId;n+""in e?e[n+""].iterationCount++:e[n+""]={iterationCount:1}})),Object.keys(e).sort().map((function(e){return Number(e)})).map((function(t){return Object(l.a)({chainId:t},e[t+""])}))}),[t]),r=Object(c.useMemo)((function(){return n.map((function(e,t){var n={chainId:e.chainId+"",iterationCount:e.iterationCount};return{key:e.chainId+"",columnValues:n}}))}),[n]),i=Object(c.useMemo)((function(){return[{key:"chainId",label:"Chain"},{key:"iterationCount",label:"Num. iterations"}]}),[]);return Object(a.jsx)(C,{rows:r,columns:i})},R=function(e){e.run;var t=e.iterations;return Object(a.jsx)(I,{iterations:t||[]})};var M=n(183),D=n(175),E=n(176),P=function(e){return Object(a.jsxs)(M.a,{TransitionProps:{unmountOnExit:void 0===e.unmountOnExit||e.unmountOnExit},defaultExpanded:e.defaultExpanded,children:[Object(a.jsxs)(D.a,{children:[e.icon&&Object(a.jsx)("span",{style:{paddingRight:10},children:e.icon}),Object(a.jsx)("span",{style:{paddingTop:3},children:e.label})]}),Object(a.jsx)(E.a,{children:Object(a.jsx)("div",{style:{width:"100%"},children:e.children})})]})},N=n(14),S=n(20),J=(n(149),function(e){for(var t=Object(N.a)(e),n=1;n<e.length;n++)t[n]=t[n-1]+(e[n]-t[n-1])/n;return t}),V=function(e){return function(e){var t=J(e),n=Object(N.a)(e);n[0]=0;for(var r=1;r<e.length;r++)n[r]=n[r-1]+(e[r]-t[r-1])*(e[r]-t[r]);return n.map((function(e,t){return t>0?e/t:0}))}(e).map((function(e){return Math.sqrt(e)}))},W=function(e){var t=e.iterations,n=e.paramKey,r=e.markerColor,i=t[0],o=Object(c.useMemo)((function(){return i?Object.keys(i.parameters||{}):[]}),[i]);if(!o.includes(n))return Object(a.jsxs)("div",{children:["Not found: ",n," ",Object(a.jsx)("pre",{children:JSON.stringify(o)})]});var s=t.map((function(e){return e.parameters[n]})),u=J(s),l=V(s),b=s.map((function(e,t){return{x:t,y:e}})),j=u.map((function(e,t){return{x:t,y:e}})),d=l.map((function(e,t){return{x:t,y:u[t]+e}})),f=l.map((function(e,t){return{x:t,y:u[t]-e}}));return Object(a.jsxs)(S.e,{margin:70,height:400,width:1e3,children:[Object(a.jsx)(S.b,{data:j,stroke:"blue"}),Object(a.jsx)(S.b,{data:f,stroke:"pink",strokeStyle:"dashed"}),Object(a.jsx)(S.b,{data:d,stroke:"pink",strokeStyle:"dashed"}),Object(a.jsx)(S.c,{data:b,fill:"none",stroke:r,strokeWidth:1}),Object(a.jsx)(S.a,{text:"".concat(n," vs iteration"),xPercent:.5,yPercent:-.05}),Object(a.jsx)(S.d,{title:"Iteration number"}),Object(a.jsx)(S.f,{title:n})]})},K=function(e){e.run;var t=e.iterations,n=Object(c.useMemo)((function(){var e={};return(t||[]).forEach((function(t){var n=t.chainId;n+""in e?e[n+""].iterations.push(t):e[n+""]={iterations:[]}})),Object.keys(e).sort().map((function(e){return Number(e)})).map((function(t){return Object(l.a)({chainId:t},e[t+""])}))}),[t]);return Object(a.jsx)("div",{children:n.map((function(e){return Object(a.jsx)(P,{label:"Iterations plot for chain ".concat(e.chainId),unmountOnExit:!0,children:Object(a.jsxs)("div",{children:[Object(a.jsx)(W,{iterations:e.iterations,paramKey:"energy__",markerColor:"darkgreen"}),Object(a.jsx)(W,{iterations:e.iterations,paramKey:"lp__",markerColor:"darkblue"})]})},e.chainId)}))})};var U=n(24),T=function(e){return new Date(1e3*e).toISOString()},L=function(e){var t=e.iterations,n=t[0],r=Object(c.useMemo)((function(){return n?Object.keys(n.parameters||{}):[]}),[n]),i=Object(c.useMemo)((function(){return t.map((function(e,t){var n,c={timestamp:T(e.timestamp),chainId:e.chainId+""},i=Object(U.a)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;c["param-"+o]=e.parameters[o]}}catch(a){i.e(a)}finally{i.f()}return{key:t+"",columnValues:c}}))}),[t,r]),o=Object(c.useMemo)((function(){return[{key:"chainId",label:"Chain"},{key:"timestamp",label:"Timestamp"}].concat(Object(N.a)(r.map((function(e){return{key:"param-"+e,label:e}}))))}),[r]);return Object(a.jsx)(C,{rows:i,columns:o})},F=function(e){e.run;var t=e.iterations,n=Object(c.useMemo)((function(){var e={};return(t||[]).forEach((function(t){var n=t.chainId;n+""in e?e[n+""].iterations.push(t):e[n+""]={iterations:[]}})),Object.keys(e).sort().map((function(e){return Number(e)})).map((function(t){return Object(l.a)({chainId:t},e[t+""])}))}),[t]);return Object(a.jsx)("div",{children:n.map((function(e){return Object(a.jsx)(P,{label:"Iterations table for chain ".concat(e.chainId),unmountOnExit:!0,children:Object(a.jsx)("div",{style:{height:300,overflow:"auto"},children:Object(a.jsx)(L,{iterations:e.iterations})})},e.chainId)}))})};var B=n(180),_=n(181),A=function(e,t){return"gotoPage"===t.type?t.page:e},q=function(e,t){return"AddRun"===t.type?Object(l.a)(Object(l.a)({},e),{},{runs:[].concat(Object(N.a)(e.runs),[t.run])}):"DeleteRuns"===t.type?Object(l.a)(Object(l.a)({},e),{},{runs:e.runs.filter((function(e){return!t.runIds.includes(e.runId)}))}):e},H=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),n=t[0],i=t[1],o=Object(c.useContext)(r.a);Object(c.useEffect)((function(){var e=setInterval((function(){var e=o.getHitherJobs();i(e)}),1e3);return function(){clearInterval(e)}}),[o]);var s={pendingJobs:n.filter((function(e){return"pending"===e.status})),runningJobs:n.filter((function(e){return"running"===e.status})),finishedJobs:n.filter((function(e){return"finished"===e.status})),erroredJobs:n.filter((function(e){return"error"===e.status}))},u=s.runningJobs,l=s.finishedJobs,j=s.erroredJobs,d=s.pendingJobs.length,f=u.length,p=l.length,O=j.length,h="Jobs: ".concat(d," pending | ").concat(f," running | ").concat(p," finished | ").concat(O," errored"),m=O>0?Object(a.jsxs)("span",{children:[":",Object(a.jsx)("span",{style:{color:"pink"},children:O})]}):Object(a.jsx)("span",{});return Object(a.jsxs)("span",{title:h,style:{fontFamily:"courier"},children:[d,":",f,":",p,m]})},z=n.p+"static/media/logo.e906eb4b.svg",G=n(177),Q=n(178),X=n(179),Y=function(){var e,t,n=Object(c.useContext)(r.c),i=n.websocketStatus,o=n.onReconnectWebsocket;switch(i){case"waiting":e=Object(a.jsx)(G.a,{style:{color:"blue"}}),t="Loading...";break;case"connected":e=Object(a.jsx)(Q.a,{style:{color:""}}),t="Connected";break;case"disconnected":e=Object(a.jsx)(X.a,{style:{color:"red"}}),t="Disconnected from server. Click to attempt reconnect."}var s=Object(c.useCallback)((function(){"disconnected"===i&&o()}),[i,o]);return Object(a.jsx)(m.a,{title:t,onClick:s,children:e})},Z=function(){var e=function(){var e=Object(r.e)();return Object(c.useMemo)((function(){return e.filter((function(e){return"WorkspaceView"===e.type})).map((function(e){return e}))}),[e])}().filter((function(e){return"WorkspaceView"===e.name}))[0];if(!e)throw Error("Unable to find workspace view plugin");var t=Object(c.useReducer)(q,{runs:[]}),n=Object(b.a)(t,2),i=n[0],o=n[1],s=Object(c.useCallback)((function(e){e.forEach((function(e){return o(e)}))}),[]),u=Object(r.f)({feedUri:"feed://91e20967e11b30db1894a6f8b42d6437215494cd815d3d9b926bcab90f5924a9",subfeedName:"~7033bedf6c058a2871dc22bda839652c5abe0097",onMessages:s}).appendMessages,l=Object(c.useCallback)((function(e){u([e])}),[u]),j=Object(c.useReducer)(A,{page:"main"}),d=Object(b.a)(j,2),f=d[0],p=d[1];return Object(a.jsxs)("div",{style:{margin:0},children:[Object(a.jsx)(B.a,{position:"static",style:{height:50,background:"#d85636"},children:Object(a.jsxs)(_.a,{children:[Object(a.jsx)("img",{src:z,className:"App-logo",alt:"logo",height:30,style:{paddingBottom:15}}),"\xa0",Object(a.jsx)("span",{style:{paddingBottom:10,color:"#312a00",fontFamily:"sans-serif",fontWeight:"bold"},children:"MCMC Monitor"}),Object(a.jsx)("span",{style:{marginLeft:"auto"}}),Object(a.jsxs)("span",{style:{paddingBottom:15,color:"#312a00"},children:[Object(a.jsx)(Y,{}),Object(a.jsx)(H,{})]})]})}),Object(a.jsx)("div",{style:{margin:30},children:Object(a.jsx)(e.component,{workspace:i,workspaceDispatch:l,workspaceRoute:f,workspaceRouteDispatch:p})})]})};var $=function(e){return Object(a.jsx)("span",{style:{color:"gray",cursor:"pointer",textDecoration:"underline"},onClick:e.onClick,children:e.children})},ee=function(e){var t=e.run,n=e.onClick,r=Object(c.useCallback)((function(){n(t)}),[n,t]);return Object(a.jsx)($,{onClick:r,children:t.runLabel})},te=function(e){var t=e.workspace,n=e.workspaceDispatch,r=e.workspaceRouteDispatch,i=Object(c.useCallback)((function(e){r({type:"gotoPage",page:{page:"run",runId:e.runId}})}),[r]),o=Object(c.useMemo)((function(){return t.runs.slice().reverse().map((function(e){return{key:e.runId,columnValues:{label:{text:e.runLabel,element:Object(a.jsx)("span",{style:{marginRight:5,whiteSpace:"nowrap"},children:Object(a.jsx)(ee,{run:e,onClick:i})})},uri:e.uri}}}))}),[t.runs,i]),s=Object(c.useMemo)((function(){return[{key:"label",label:"Run"},{key:"uri",label:"URI"}]}),[]),u=Object(c.useCallback)((function(e){n({type:"DeleteRuns",runIds:[e]})}),[n]);return Object(a.jsx)("div",{children:Object(a.jsx)(C,{rows:o,columns:s,onDeleteRow:u,noConfirmDeleteRow:!0})})},ne=function(e){var t=e.workspace,n=e.runId,i=e.workspaceRouteDispatch,o=Object(c.useMemo)((function(){return t.runs.filter((function(e){return e.runId===n}))[0]}),[n,t.runs]),s=function(e){if(!e)return{feedUri:void 0,subfeedName:void 0};var t=e.split("/");return{feedUri:t.slice(0,3).join("/"),subfeedName:t[3]}}(null===o||void 0===o?void 0:o.uri),u=s.feedUri,l=s.subfeedName,b=Object(r.f)({feedUri:u,subfeedName:l}),j=b.messages,d=b.loadedInitialMessages,f=Object(c.useMemo)((function(){return d?j.filter((function(e){return function(e){try{return!("iteration"!==e.type||!e.timestamp||!e.chainId)}catch(t){return!1}}(e)})):void 0}),[j,d]),p=Object(c.useCallback)((function(){i({type:"gotoPage",page:{page:"main"}})}),[i]),O=function(){var e=Object(r.e)();return Object(c.useMemo)((function(){return e.filter((function(e){return"RunView"===e.type})).map((function(e){return e}))}),[e])}();return o?Object(a.jsxs)("div",{children:[Object(a.jsx)($,{onClick:p,children:"Back"}),d?Object(a.jsx)("span",{children:O.map((function(e){return Object(a.jsx)(e.component,{run:o,iterations:f},e.name)}))}):Object(a.jsx)("div",{children:"Loading..."})]}):Object(a.jsxs)("div",{children:["Run not found: ",n]})},re=function(e){var t=e.workspace,n=e.workspaceRoute,r=e.workspaceDispatch,c=e.workspaceRouteDispatch;if("main"===n.page)return Object(a.jsx)(te,{workspace:t,workspaceDispatch:r,workspaceRouteDispatch:c});if("run"===n.page)return Object(a.jsx)(ne,{workspace:t,runId:n.runId,workspaceRouteDispatch:c});throw Error("Invalid page")};var ce=function(e){!function(e){e.registerPlugin({type:"MainWindow",name:"MainWindow",label:"Main Window",component:Z})}(e),function(e){e.registerPlugin({type:"WorkspaceView",name:"WorkspaceView",label:"Workspace View",component:re})}(e),function(e){e.registerPlugin({type:"RunView",name:"ChainsTable",label:"Chains Table",component:R})}(e),function(e){e.registerPlugin({type:"RunView",name:"IterationsTable",label:"Iterations Table",component:F})}(e),function(e){e.registerPlugin({type:"RunView",name:"IterationsPlot",label:"Iterations Plot",component:K})}(e)},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,185)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))},oe=Object(r.d)();ce(oe);var ae={webSocketUrl:"ws://".concat(window.location.hostname,":").concat(u.webSocketPort),baseSha1Url:"http://".concat(window.location.hostname,":").concat(u.httpPort,"/sha1"),baseFeedUrl:"http://".concat(window.location.hostname,":").concat(u.httpPort,"/feed")};o.a.render(Object(a.jsx)(r.b,{extensionContext:oe,apiConfig:ae,children:Object(a.jsx)(s,{})}),document.getElementById("root")),ie()},53:function(e){e.exports=JSON.parse('{"webSocketPort":10408,"httpPort":10409}')}},[[150,1,2]]]);
//# sourceMappingURL=main.8436b40f.chunk.js.map