{"version":3,"sources":["listEditViewTests.es6.js"],"names":[],"mappings":";;;;AAAA,MAAM,kCAAN,EAA0C,YAAW;AACjD;;;AAGA,QAAM,eAAe,EAAE,QAAF,+yBAArB;;AAwBA,QAAM,WAAW,SAAS,QAAT,GAAsC;AAAA,YAApB,KAAoB,uEAAd,EAAc;AAAA,YAAV,KAAU,uEAAJ,EAAI;;AACnD,gBAAQ,MAAM,MAAN,SAAmB,KAAnB,GAA6B,EAArC;AACA,gBAAW,KAAX;;AAEA,YAAM,MACF,EAAE,aAAa;AACX,mBAAO,KADI;AAEX,0BAAc,MAAM,MAAN,CAAa;AAAA,uBAAM,EAAE,MAAF,GAAW,CAAjB;AAAA,aAAb,CAFH;AAGX,mBAAO;AAHI,SAAb,CAAF,EAKC,QALD,CAKU,aALV,CADJ;;AAQA,YAAM,OAAO,IAAI,QAAQ,KAAR,CAAc,YAAlB,CAA+B;AACxC,gBAAI,GADoC;AAExC,wBAAY,KAF4B;AAGxC,iBAAK;AAHmC,SAA/B,CAAb;;AAMA,aAAK,MAAL;;AAEA,eAAO,CAAC,IAAD,EAAO,KAAK,CAAL,CAAO,oCAAP,CAAP,CAAP;AACH,KArBD;;AAuBA,aAAS,iBAAT,EAA4B,YAAW;AACnC,WAAG,gBAAH,EAAqB,YAAW;AAAA,4BACJ,SAAS,EAAT,CADI;AAAA;AAAA,gBACnB,WADmB;;AAE5B,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACH,SAHD;;AAKA,WAAG,gBAAH,EAAqB,YAAW;AAAA,6BACA,SAAS,CAAC,KAAD,CAAT,CADA;AAAA;AAAA,gBACrB,IADqB;AAAA,gBACf,WADe;;AAG5B,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,KAAlC;;AAEA,iBAAK,CAAL,CAAO,oCAAP,EAA6C,GAA7C,CAAiD,KAAjD,EAAwD,IAAxD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,KAAlC;AACH,SAPD;;AASA,WAAG,sBAAH,EAA2B,YAAW;AAAA,6BACN,SAAS,CAAC,KAAD,EAAQ,KAAR,EAAe,OAAf,CAAT,CADM;AAAA;AAAA,gBAC3B,IAD2B;AAAA,gBACrB,WADqB;;AAElC,gBAAM,UAAU,KAAK,CAAL,CAAO,oCAAP,CAAhB;;AAEA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,eAAlC;;AAEA,oBAAQ,EAAR,CAAW,CAAX,EAAc,GAAd,CAAkB,KAAlB,EAAyB,IAAzB;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,aAAlC;;AAEA,oBAAQ,EAAR,CAAW,CAAX,EAAc,GAAd,CAAkB,EAAlB,EAAsB,IAAtB;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,SAAlC;;AAEA,oBAAQ,EAAR,CAAW,CAAX,EAAc,GAAd,CAAkB,EAAlB,EAAsB,IAAtB;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,KAAlC;;AAEA,oBAAQ,EAAR,CAAW,CAAX,EAAc,GAAd,CAAkB,EAAlB,EAAsB,IAAtB;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACH,SAjBD;AAkBH,KAjCD;;AAmCA,aAAS,SAAT,EAAoB,YAAW;AAC3B,WAAG,gBAAH,EAAqB,YAAW;AAAA,6BACA,SAAS,EAAT,CADA;AAAA;AAAA,gBACrB,IADqB;AAAA,gBACf,WADe;;AAG5B,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,0CAAP,EAAmD,KAAnD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;AAEH,SAXD;;AAaA,WAAI,gBAAJ,EAAsB,YAAW;AAAA,6BACD,SAAS,CAAC,KAAD,CAAT,CADC;AAAA;AAAA,gBACtB,IADsB;AAAA,gBAChB,WADgB;;AAE7B,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,KAAlC;;AAEA,iBAAK,CAAL,CAAO,0CAAP,EAAmD,KAAnD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;AAEH,SARD;;AAUA,WAAG,sBAAH,EAA2B,YAAW;AAAA,8BACN,SAAS,CAAC,KAAD,EAAQ,KAAR,EAAe,OAAf,CAAT,CADM;AAAA;AAAA,gBAC3B,IAD2B;AAAA,gBACrB,WADqB;;AAGlC,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,eAAlC;;AAEA,mBAAO,KAAK,CAAL,CAAO,0CAAP,EAAmD,MAA1D,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,0CAAP,EAAmD,EAAnD,CAAsD,CAAtD,EAAyD,KAAzD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,WAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;AAEA,mBAAO,KAAK,CAAL,CAAO,0CAAP,EAAmD,MAA1D,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,0CAAP,EAAmD,EAAnD,CAAsD,CAAtD,EAAyD,KAAzD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,KAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;AAEA,mBAAO,KAAK,CAAL,CAAO,0CAAP,EAAmD,MAA1D,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,0CAAP,EAAmD,KAAnD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;AAEH,SA1BD;AA2BH,KAnDD;;AAqDA,aAAS,UAAT,EAAqB,YAAW;AAC5B,WAAG,aAAH,EAAkB,YAAW;AAAA,8BACG,SAAS,CAAC,KAAD,EAAQ,KAAR,EAAe,OAAf,CAAT,CADH;AAAA;AAAA,gBAClB,IADkB;AAAA,gBACZ,WADY;;AAEzB,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,eAAlC;;AAEA,iBAAK,CAAL,CAAO,uCAAP,EAAgD,KAAhD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,eAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,oCAAP,EAA6C,EAA7C,CAAgD,CAAhD,EACK,GADL,CACS,MADT,EAEK,IAFL;AAGA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,oBAAlC;AACH,SAbD;;AAeA,WAAG,mBAAH,EAAwB,YAAW;AAAA,8BACH,SAAS,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,CAAT,CADG;AAAA;AAAA,gBACxB,IADwB;AAAA,gBAClB,WADkB;;AAE/B,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;;AAEA,iBAAK,CAAL,CAAO,uCAAP,EAAgD,KAAhD;AACA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,EAAlC;AACA,mBAAO,KAAK,CAAL,CAAO,oCAAP,EAA6C,MAApD,EACK,OADL,CACa,CADb;;AAGA,iBAAK,CAAL,CAAO,oCAAP,EAA6C,EAA7C,CAAgD,CAAhD,EACK,GADL,CACS,MADT,EAEK,IAFL;AAGA,mBAAO,YAAY,GAAZ,EAAP,EAA0B,OAA1B,CAAkC,MAAlC;AACH,SAbD;;AAeA,WAAG,yBAAH,EAA8B,YAAW;AAAA,8BACrB,SAAS,EAAT,EAAa,qBAAb,CADqB;AAAA;AAAA,gBAC9B,IAD8B;;AAGrC,iBAAK,CAAL,CAAO,uCAAP,EAAgD,KAAhD;AACA,gBAAM,SAAS,KAAK,CAAL,CAAO,OAAP,EAAgB,EAAhB,CAAmB,CAAnB,CAAf;AACA,mBAAO,OAAO,IAAP,CAAY,MAAZ,CAAP,EAA4B,OAA5B,CAAoC,KAApC;AACA,mBAAO,OAAO,IAAP,CAAY,UAAZ,CAAP,EAAgC,IAAhC,CAAqC,IAArC;AACH,SAPD;AAQH,KAvCD;AAwCH,CAnLD","file":"listEditViewTests.js","sourcesContent":["suite('djblets/forms/views/ListEditView', function() {\n    /*\n     * See templates/djblets_forms/list_edit_widget.html.\n     */\n    const formTemplate = _.template(dedent`\n        <div class=\"djblets-c-list-edit-widget\">\n         <ul class=\"djblets-c-list-edit-widget__entries\">\n          <% if (items.length > 0) { %>\n           <% items.forEach(function(item, i) { %>\n            <li class=\"djblets-c-list-edit-widget__entry\"\n                data-list-index=\"<%- i %>\">\n             <input value=\"<%- item %>\" type=\"text\"<%= attrs %>>\n             <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n            </li>\n           <% }); %>\n          <% } else { %>\n           <li class=\"djblets-c-list-edit-widget__entry\" data-list-index=\"0\">\n            <input type=\"text\">\n            <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n           </li>\n          <% } %>\n         </ul>\n         <button class=\"djblets-c-list-edit-widget__add-item\"></button>\n         <input class=\"djblets-c-list-edit-widget__value\"\n                type=\"hidden\" value=\"<%- nonZeroItems.join(',') %>\">\n        </div>\n    `);\n\n    const makeView = function makeView(items=[], attrs='') {\n        attrs = attrs.length ? ` ${attrs}` : '';\n        attrs = `${attrs} class=\"djblets-c-list-edit-widget__input\"`;\n\n        const $el =\n            $(formTemplate({\n                items: items,\n                nonZeroItems: items.filter(i => (i.length > 0)),\n                attrs: attrs,\n            }))\n            .appendTo($testsScratch);\n\n        const view = new Djblets.Forms.ListEditView({\n            el: $el,\n            inputAttrs: attrs,\n            sep: ',',\n        });\n\n        view.render();\n\n        return [view, view.$('.djblets-c-list-edit-widget__value')];\n    };\n\n    describe('Updating fields', function() {\n        it('With no values', function() {\n            const [, $valueField] = makeView([]);\n            expect($valueField.val()).toEqual('');\n        });\n\n        it('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__input').val('Foo').blur();\n            expect($valueField.val()).toEqual('Foo');\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            const $inputs = view.$('.djblets-c-list-edit-widget__input');\n\n            expect($valueField.val()).toEqual('one,two,three');\n\n            $inputs.eq(2).val('baz').blur();\n            expect($valueField.val()).toEqual('one,two,baz');\n\n            $inputs.eq(0).val('').blur();\n            expect($valueField.val()).toEqual('two,baz');\n\n            $inputs.eq(1).val('').blur();\n            expect($valueField.val()).toEqual('baz');\n\n            $inputs.eq(2).val('').blur();\n            expect($valueField.val()).toEqual('');\n        });\n    });\n\n    describe('Removal', function() {\n        it('With no values', function() {\n            const [view, $valueField] = makeView([]);\n\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it ('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['One', 'Two', 'Three']);\n\n            expect($valueField.val()).toEqual('One,Two,Three');\n\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(3);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One,Three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(2);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(2);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n    });\n\n    describe('Addition', function() {\n        it('With values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            expect($valueField.val()).toEqual('one,two,three');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('one,two,three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('one,two,three,four');\n        });\n\n        it('With blank values', function() {\n            const [view, $valueField] = makeView(['', '', '']);\n            expect($valueField.val()).toEqual('');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('four');\n        });\n\n        it('With correct attributes', function() {\n            const [view,] = makeView([], 'size=\"100\" readonly');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            const $input = view.$('input').eq(1);\n            expect($input.attr('size')).toEqual('100');\n            expect($input.prop('readonly')).toBe(true);\n        });\n    });\n});\n"]}