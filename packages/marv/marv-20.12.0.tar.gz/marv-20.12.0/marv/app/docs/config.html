
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuration &#8212; MARV Robotics 20.12.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_paramlinks.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scanner" href="scan.html" />
    <link rel="prev" title="Views" href="views.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="configuration">
<span id="config"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>The configuration file <code class="docutils literal notranslate"><span class="pre">marv.conf</span></code> is in Python config parser / ini-syntax and consists of at least one <a class="reference internal" href="#cfg-section-marv"><span class="std std-ref">marv section</span></a> and one or more <a class="reference internal" href="#cfg-section-collection"><span class="std std-ref">collection section</span></a>. See some <a class="reference internal" href="#cfg-examples"><span class="std std-ref">Examples</span></a> below.</p>
<p>If you make changes to your configuration, keep in mind that you have to stop <code class="docutils literal notranslate"><span class="pre">gunicorn</span></code>, run <code class="docutils literal notranslate"><span class="pre">marv</span> <span class="pre">init</span></code>, and start <code class="docutils literal notranslate"><span class="pre">gunicorn</span></code> again.</p>
<div class="section" id="relative-paths">
<h2>Relative paths<a class="headerlink" href="#relative-paths" title="Permalink to this headline">¶</a></h2>
<p>The location of <code class="docutils literal notranslate"><span class="pre">marv.conf</span></code> is the site directory and relative paths are relative to that directory.</p>
</div>
<div class="section" id="marv-section">
<span id="cfg-section-marv"></span><h2>marv section<a class="headerlink" href="#marv-section" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[marv]</span>
</pre></div>
</div>
<div class="section" id="acl">
<span id="cfg-marv-acl"></span><h3>acl<a class="headerlink" href="#acl" title="Permalink to this headline">¶</a></h3>
<p>Use access control lists to control who can perform which actions. See <a class="reference internal" href="api/marv.html#module-marv_webapi.acls" title="marv_webapi.acls"><code class="xref py py-mod docutils literal notranslate"><span class="pre">marv_webapi.acls</span></code></a> for more information.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">acl</span> <span class="o">=</span> <span class="s">marv_webapi.acls:public</span>
</pre></div>
</div>
<p>Default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">acl</span> <span class="o">=</span> <span class="s">marv_webapi.acls:authenticated</span>
</pre></div>
</div>
</div>
<div class="section" id="collections">
<span id="cfg-marv-collections"></span><h3>collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<p>Name of one or more collections, corresponding to a <a class="reference internal" href="#cfg-section-collection"><span class="std std-ref">collection section</span></a>.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">collections</span> <span class="o">=</span> <span class="s">bags</span>
</pre></div>
</div>
</div>
<div class="section" id="dburi">
<span id="cfg-marv-dburi"></span><h3>dburi<a class="headerlink" href="#dburi" title="Permalink to this headline">¶</a></h3>
<p>Location of sqlite database. Despite the generic name, only sqlite is supported.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dburi</span> <span class="o">=</span> <span class="s">sqlite:////var/local/lib/marv/db/db.sqlite</span>
</pre></div>
</div>
<p>Default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dburi</span> <span class="o">=</span> <span class="s">sqlite:///path/to/sitedir/db/db.sqlite</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep the <code class="docutils literal notranslate"><span class="pre">db/db.sqlite</span></code> suffix for ease of migrations.</p>
</div>
</div>
<div class="section" id="reverse-proxy">
<span id="cfg-marv-reverse-proxy"></span><h3>reverse_proxy<a class="headerlink" href="#reverse-proxy" title="Permalink to this headline">¶</a></h3>
<p>When marv is running behind a reverse proxy, serving of files can be offloaded for greatly improved performance. Currently, the only supported reverse proxy is <code class="docutils literal notranslate"><span class="pre">nginx</span></code>.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">reverse_proxy</span> <span class="o">=</span> <span class="s">nginx</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="deploy.html#deploy-nginx"><span class="std std-ref">Gunicorn behind NGINX</span></a> for the corresponding nginx configuration.</p>
</div>
<div class="section" id="storedir">
<span id="cfg-marv-store"></span><h3>storedir<a class="headerlink" href="#storedir" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">storedir</span> <span class="o">=</span> <span class="s">/var/local/lib/marv/store</span>
</pre></div>
</div>
<p>Default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">storedir</span> <span class="o">=</span> <span class="s">./store</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-checkpoint-commands">
<span id="cfg-upload-checkpoint-commands"></span><h3>upload_checkpoint_commands<a class="headerlink" href="#upload-checkpoint-commands" title="Permalink to this headline">¶</a></h3>
<p>List of commands that is executed before marv touches a collection’s scanroot as part of an upload from a leaf. See <a class="reference internal" href="upload.html#upload"><span class="std std-ref">Upload (EE)</span></a> for more information.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">upload_checkpoint_commands</span> <span class="o">=</span>
    <span class="na">/path/to/checkpoint/script</span>
</pre></div>
</div>
<p>Content of checkpoint script:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>basename <span class="s2">&quot;</span><span class="si">${</span><span class="nv">MARV_SCANROOT</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
sudo btrfs subvolume snapshot -r <span class="s2">&quot;</span><span class="si">${</span><span class="nv">MARV_SCANROOT</span><span class="si">}</span><span class="s2">&quot;</span> /snapshots/<span class="s2">&quot;</span><span class="si">${</span><span class="nv">NAME</span><span class="si">}</span><span class="s2">&quot;</span>-<span class="k">$(</span>date -u <span class="s1">&#39;+%Y-%m-%dT%H:%M:%SZ&#39;</span><span class="k">)</span>
</pre></div>
</div>
<p>Checkpoint script needs to be executable (<code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code>) and user running marv needs to have sudoer permission for btrfs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">marvuser</span> <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">btrfs</span> <span class="n">subvolume</span> <span class="n">snapshot</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">scanroot</span> <span class="o">/</span><span class="n">snapshots</span><span class="o">/*</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="collection-section">
<span id="cfg-section-collection"></span><h2>collection section<a class="headerlink" href="#collection-section" title="Permalink to this headline">¶</a></h2>
<p>Configuration for a collection of datasets.</p>
<div class="section" id="scanner">
<span id="cfg-c-scanner"></span><h3>scanner<a class="headerlink" href="#scanner" title="Permalink to this headline">¶</a></h3>
<p>A scanner is responsible to group files into named datasets.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">scanner</span> <span class="o">=</span> <span class="s">marv_robotics.bag:scan</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="scan.html#marv_robotics.bag.scan" title="marv_robotics.bag.scan"><code class="xref py py-func docutils literal notranslate"><span class="pre">marv_robotics.bag.scan()</span></code></a></p>
</div>
<div class="section" id="scanroots">
<span id="cfg-c-scanroots"></span><h3>scanroots<a class="headerlink" href="#scanroots" title="Permalink to this headline">¶</a></h3>
<p>One or more directories to scan for datasets.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">scanroots</span> <span class="o">=</span>
    <span class="na">./foo</span>
    <span class="na">./bar</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>MARV Robotics does not need write access to your bag files. As a safety measure install and run MARV as a user having only read-only access to your bag files.</p>
</div>
</div>
<div class="section" id="nodes">
<span id="cfg-c-nodes"></span><h3>nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h3>
<p>List of nodes made available within this collection under the name following the column, which is also the name of the function the node is created from. When listing colums or filters are added, the given extractor function run for all the collection’s datasets. For this to be quick, all node output used in listing colums and filters must be readily available. Therefore all nodes listed in the configuration are persisted in the store. For a node to be persisted it needs to define a message schema. See <a class="reference internal" href="tutorial/write-your-own.html#tutorial-declare-image-node"><span class="std std-ref">Declare image node</span></a> for an example.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">nodes</span> <span class="o">=</span>
    <span class="c1"># pkg.module:func_name</span>
    <span class="na">marv_nodes:dataset</span>
    <span class="na">marv_robotics.bag:bagmeta</span>
</pre></div>
</div>
<p>For a list of nodes see <a class="reference internal" href="nodes.html#nodes"><span class="std std-ref">Nodes</span></a>.</p>
</div>
<div class="section" id="filters">
<span id="cfg-c-filters"></span><h3>filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<p>Listings of datasets for the web frontend and API responses can be filtered.</p>
<p>Nodes extract and process data from datasets. Node output persisted in the store is available via a node’s name. For this to happen the node needs to define a message type and be listed in <a class="reference internal" href="#cfg-c-nodes"><span class="std std-ref">nodes</span></a>. Filters and <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a> use <a class="reference internal" href="#cfg-sexp"><span class="std std-ref">S-Expressions</span></a> to extract values from node output. Via API or web frontend a user supplies filter input to be compared with the extracted value using a selected operator. A filter’s name is displayed in the web frontend and its ID is used via API.</p>
<p>At least one operator has to be configured per filter and valid operators depend on the field type. The <code class="docutils literal notranslate"><span class="pre">tags</span></code> and <code class="docutils literal notranslate"><span class="pre">comments</span></code> filter are special and have to be defined exactly as shown below.</p>
<p>See <a class="reference internal" href="#cfg-sexp"><span class="std std-ref">S-Expressions</span></a> on how to create functions to extract values from node output.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">filters</span> <span class="o">=</span>
    <span class="c1"># id     | Display Name | operators         | field type | extractor function</span>
    <span class="na">name     | Name         | substring         | string     | (get &quot;dataset.name&quot;)</span>
    <span class="na">setid    | Set Id       | startswith        | string     | (get &quot;dataset.id&quot;)</span>
    <span class="na">size     | Size         | lt le eq ne ge gt | filesize   | (sum (get &quot;dataset.files[:].size&quot;))</span>
    <span class="na">tags     | Tags         | any all           | subset     | (tags )</span>
    <span class="na">comments | Comments     | substring         | string     | (comments )</span>
    <span class="na">fulltext | Fulltext     | words             | words      | (get &quot;fulltext.words&quot;)</span>
    <span class="na">files    | File paths   | substring_any     | string[]   | (get &quot;dataset.files[:].path&quot;)</span>
    <span class="na">end_time | End time     | lt le eq ne ge gt | datetime   | (get &quot;bagmeta.end_time&quot;)</span>
    <span class="na">duration | Duration     | lt le eq ne ge gt | timedelta  | (get &quot;bagmeta.duration&quot;)</span>
    <span class="na">topics   | Topics       | any all           | subset     | (get &quot;bagmeta.topics[:].name&quot;)</span>
</pre></div>
</div>
<p>In case you use emacs, it’s easy to align these: <code class="docutils literal notranslate"><span class="pre">C-u</span> <span class="pre">M-x</span> <span class="pre">align-regexp</span> <span class="pre">|</span> <span class="pre">RET</span> <span class="pre">RET</span> <span class="pre">y</span></code>.</p>
<div class="section" id="field-type">
<h4>field type<a class="headerlink" href="#field-type" title="Permalink to this headline">¶</a></h4>
<p>The field type determines what python type the extractor function is expected to return, how this is interpreted and displayed, and what is expected as filter input.</p>
<div class="section" id="datetime">
<h5><code class="docutils literal notranslate"><span class="pre">datetime</span></code><a class="headerlink" href="#datetime" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, nanoseconds since epoch</div>
<div class="line">input: int, millisecons since epoch</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code></div>
</div>
</div>
<div class="section" id="filesize">
<h5><code class="docutils literal notranslate"><span class="pre">filesize</span></code><a class="headerlink" href="#filesize" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, bytes</div>
<div class="line">input: int, bytes</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code></div>
</div>
</div>
<div class="section" id="float">
<h5><code class="docutils literal notranslate"><span class="pre">float</span></code><a class="headerlink" href="#float" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: float</div>
<div class="line">input: float</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code></div>
</div>
</div>
<div class="section" id="int">
<h5><code class="docutils literal notranslate"><span class="pre">int</span></code><a class="headerlink" href="#int" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int</div>
<div class="line">input: int</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code></div>
</div>
</div>
<div class="section" id="string">
<h5><code class="docutils literal notranslate"><span class="pre">string</span></code><a class="headerlink" href="#string" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: unicode</div>
<div class="line">input: utf-8</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">substring</span></code>, <code class="docutils literal notranslate"><span class="pre">startswith</span></code></div>
</div>
</div>
<div class="section" id="id1">
<h5><code class="docutils literal notranslate"><span class="pre">string[]</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: list of unicode</div>
<div class="line">input: utf-8</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">substring_any</span></code></div>
</div>
</div>
<div class="section" id="subset">
<h5><code class="docutils literal notranslate"><span class="pre">subset</span></code><a class="headerlink" href="#subset" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: list of unicode</div>
<div class="line">input: list of utf-8</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">any</span></code>, <code class="docutils literal notranslate"><span class="pre">all</span></code></div>
</div>
</div>
<div class="section" id="timedelta">
<h5><code class="docutils literal notranslate"><span class="pre">timedelta</span></code><a class="headerlink" href="#timedelta" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, nanoseconds</div>
<div class="line">input: int, millisecons</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code></div>
</div>
</div>
<div class="section" id="words">
<h5><code class="docutils literal notranslate"><span class="pre">words</span></code><a class="headerlink" href="#words" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: list of unicode</div>
<div class="line">input: list of utf-8</div>
<div class="line">operators: <code class="docutils literal notranslate"><span class="pre">words</span></code></div>
</div>
</div>
</div>
<div class="section" id="operators">
<h4>operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h4>
<div class="section" id="lt-le-eq-ne-ge-gt">
<h5><code class="docutils literal notranslate"><span class="pre">lt</span></code> <code class="docutils literal notranslate"><span class="pre">le</span></code> <code class="docutils literal notranslate"><span class="pre">eq</span></code> <code class="docutils literal notranslate"><span class="pre">ne</span></code> <code class="docutils literal notranslate"><span class="pre">ge</span></code> <code class="docutils literal notranslate"><span class="pre">gt</span></code><a class="headerlink" href="#lt-le-eq-ne-ge-gt" title="Permalink to this headline">¶</a></h5>
<p>Comparison of numeric input with numeric stored value.</p>
</div>
<div class="section" id="substring">
<h5><code class="docutils literal notranslate"><span class="pre">substring</span></code><a class="headerlink" href="#substring" title="Permalink to this headline">¶</a></h5>
<p>Match input as substring anywhere in stored string.</p>
</div>
<div class="section" id="startswith">
<h5><code class="docutils literal notranslate"><span class="pre">startswith</span></code><a class="headerlink" href="#startswith" title="Permalink to this headline">¶</a></h5>
<p>Stored string starts with input string.</p>
</div>
<div class="section" id="substring-any">
<h5><code class="docutils literal notranslate"><span class="pre">substring_any</span></code><a class="headerlink" href="#substring-any" title="Permalink to this headline">¶</a></h5>
<p>The input string is a substring of any string in a stored list of strings.</p>
</div>
<div class="section" id="any">
<h5><code class="docutils literal notranslate"><span class="pre">any</span></code><a class="headerlink" href="#any" title="Permalink to this headline">¶</a></h5>
<p>The set of input strings intersects with the set of stored strings.</p>
</div>
<div class="section" id="all">
<h5><code class="docutils literal notranslate"><span class="pre">all</span></code><a class="headerlink" href="#all" title="Permalink to this headline">¶</a></h5>
<p>The set of input strings is a subset of the set of stored strings.</p>
</div>
</div>
</div>
<div class="section" id="listing-columns">
<span id="cfg-c-listing-columns"></span><h3>listing_columns<a class="headerlink" href="#listing-columns" title="Permalink to this headline">¶</a></h3>
<p>Columns displayed for the collection’s listing.</p>
<p>For certain colums the id is important, so keep the ids used in the <a class="reference internal" href="#cfg-default-config"><span class="std std-ref">Default configuration</span></a>. The heading is used as column heading, formatters are explained below and see <a class="reference internal" href="#cfg-sexp"><span class="std std-ref">S-Expressions</span></a> on how to write functions to extract values from node output.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listing_columns</span> <span class="o">=</span>
    <span class="c1"># id | Heading | formatter | extractor function</span>
    <span class="na">name | Name    | route     | (detail_route (get &quot;dataset.id&quot;) (get &quot;dataset.name&quot;))</span>
    <span class="na">size | Size    | filesize  | (sum (get &quot;dataset.files[:].size&quot;))</span>
</pre></div>
</div>
<div class="section" id="formatter">
<span id="cfg-c-formatter"></span><h4>formatter<a class="headerlink" href="#formatter" title="Permalink to this headline">¶</a></h4>
<p>Marv ships with a set of formatters. See <a class="reference internal" href="widgets.html#widget-custom"><span class="std std-ref">Custom</span></a> on how to override these and supply your own.</p>
<div class="section" id="acceleration">
<h5><code class="docutils literal notranslate"><span class="pre">acceleration</span></code><a class="headerlink" href="#acceleration" title="Permalink to this headline">¶</a></h5>
<p>Renders numeric value with unit. Unit can be chosen in frontend (EE).</p>
<div class="line-block">
<div class="line">extract: float (m/s^2)</div>
</div>
</div>
<div class="section" id="date">
<h5><code class="docutils literal notranslate"><span class="pre">date</span></code><a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, nanoseconds since epoch</div>
</div>
</div>
<div class="section" id="id2">
<h5><code class="docutils literal notranslate"><span class="pre">datetime</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, nanoseconds since epoch</div>
</div>
</div>
<div class="section" id="distance">
<h5><code class="docutils literal notranslate"><span class="pre">distance</span></code><a class="headerlink" href="#distance" title="Permalink to this headline">¶</a></h5>
<p>Renders numeric value with unit. Unit can be chosen in frontend (EE).</p>
<div class="line-block">
<div class="line">extract: float (m)</div>
</div>
</div>
<div class="section" id="id3">
<h5><code class="docutils literal notranslate"><span class="pre">float</span></code><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>Renders float with two decimal places.</p>
<div class="line-block">
<div class="line">extract: float</div>
</div>
</div>
<div class="section" id="icon">
<h5><code class="docutils literal notranslate"><span class="pre">icon</span></code><a class="headerlink" href="#icon" title="Permalink to this headline">¶</a></h5>
<p>Render a <a class="reference external" href="https://getbootstrap.com/docs/3.3/components/#glyphicons">glyphicon</a> by name (<code class="docutils literal notranslate"><span class="pre">glyphicon-&lt;name&gt;</span></code>) with optional additional space-separated css classes and a title rendered in a tooltip for the icon.</p>
<div class="line-block">
<div class="line">extract: <code class="docutils literal notranslate"><span class="pre">{'icon':</span> <span class="pre">name,</span> <span class="pre">'classes':</span> <span class="pre">css_classes,</span> <span class="pre">'title':</span> <span class="pre">title}</span></code></div>
</div>
</div>
<div class="section" id="id4">
<h5><code class="docutils literal notranslate"><span class="pre">int</span></code><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int</div>
</div>
</div>
<div class="section" id="link">
<h5><code class="docutils literal notranslate"><span class="pre">link</span></code><a class="headerlink" href="#link" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: <code class="docutils literal notranslate"><span class="pre">{'href':</span> <span class="pre">'',</span> <span class="pre">'title':</span> <span class="pre">''}</span></code></div>
</div>
</div>
<div class="section" id="pill">
<h5><code class="docutils literal notranslate"><span class="pre">pill</span></code><a class="headerlink" href="#pill" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, float, unicode</div>
</div>
</div>
<div class="section" id="route">
<h5><code class="docutils literal notranslate"><span class="pre">route</span></code><a class="headerlink" href="#route" title="Permalink to this headline">¶</a></h5>
<p>Used only for the detail route so far in conjunction with <a class="reference internal" href="#cfg-sexp-detail-route"><span class="std std-ref">detail_route</span></a>.</p>
</div>
<div class="section" id="speed">
<h5><code class="docutils literal notranslate"><span class="pre">speed</span></code><a class="headerlink" href="#speed" title="Permalink to this headline">¶</a></h5>
<p>Renders numeric value with unit. Unit can be chosen in frontend (EE).</p>
<div class="line-block">
<div class="line">extract: float (m/s)</div>
</div>
</div>
<div class="section" id="id5">
<h5><code class="docutils literal notranslate"><span class="pre">string</span></code><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, float, unicode</div>
</div>
</div>
<div class="section" id="id6">
<h5><code class="docutils literal notranslate"><span class="pre">timedelta</span></code><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">extract: int, nanoseconds since epoch</div>
</div>
</div>
</div>
</div>
<div class="section" id="listing-sort">
<span id="cfg-c-listing-sort"></span><h3>listing_sort<a class="headerlink" href="#listing-sort" title="Permalink to this headline">¶</a></h3>
<p>Column and sort order for listing.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listing_sort</span> <span class="o">=</span> <span class="s">start_time | descending</span>
</pre></div>
</div>
<p>The first field corresponds to an id in <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, the second is one of <code class="docutils literal notranslate"><span class="pre">ascending</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">descending</span></code>.</p>
</div>
<div class="section" id="listing-summary">
<span id="cfg-c-listing-summary"></span><h3>listing_summary<a class="headerlink" href="#listing-summary" title="Permalink to this headline">¶</a></h3>
<p>Summary calculated for the filtered rows of the listing.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listing_summary</span> <span class="o">=</span>
    <span class="c1"># id     | Title    | formatter | extractor</span>
    <span class="na">datasets | datasets | int       | (len (rows))</span>
    <span class="na">size     | size     | filesize  | (sum (rows &quot;size&quot; 0))</span>
    <span class="na">duration | duration | timedelta | (sum (rows &quot;duration&quot; 0))</span>
</pre></div>
</div>
<p>A unique id, a title displayed below the value, a formatter explained in <a class="reference internal" href="#cfg-c-formatter"><span class="std std-ref">formatter</span></a> and extractor function explained in <a class="reference internal" href="#cfg-sexp"><span class="std std-ref">S-Expressions</span></a>.</p>
</div>
<div class="section" id="detail-summary-widgets">
<span id="cfg-c-detail-summary-widgets"></span><h3>detail_summary_widgets<a class="headerlink" href="#detail-summary-widgets" title="Permalink to this headline">¶</a></h3>
<p>List of widgets to be rendered on the first tab of the detail view, aka the summary section.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">detail_summary_widgets</span> <span class="o">=</span>
    <span class="na">summary_keyval</span>
    <span class="na">bagmeta_table</span>
</pre></div>
</div>
<p>You can write your own and use some of the already existing <a class="reference internal" href="nodes.html#widget-nodes"><span class="std std-ref">Widget nodes</span></a>.</p>
</div>
<div class="section" id="detail-sections">
<span id="cfg-c-detail-sections"></span><h3>detail_sections<a class="headerlink" href="#detail-sections" title="Permalink to this headline">¶</a></h3>
<p>List of detail section to be rendered beyond the summary section. For any given dataset those sections will be rendered only if the dataset contains the necessary data. In absence of meaningful data, sections will be omitted from the web frontend detail view.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">detail_sections</span> <span class="o">=</span>
    <span class="na">connections_section</span>
    <span class="na">video_section</span>
</pre></div>
</div>
<p>You can write your own and use some of the already existing <a class="reference internal" href="nodes.html#section-nodes"><span class="std std-ref">Section nodes</span></a>.</p>
</div>
</div>
<div class="section" id="s-expressions">
<span id="cfg-sexp"></span><h2>S-Expressions<a class="headerlink" href="#s-expressions" title="Permalink to this headline">¶</a></h2>
<p>S-Expressions are used in the config file to create small functions that extract values from output of stored <a class="reference internal" href="#cfg-c-nodes"><span class="std std-ref">nodes</span></a>. S-Expressions are (nested) lists in parentheses, with list elements being separated by spaces.</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">get</span> <span class="s">&quot;dataset.name&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nb">get</span> <span class="s">&quot;dataset.files[:].path&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">sum</span> <span class="p">(</span><span class="nb">get</span> <span class="s">&quot;dataset.files[:].size&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">tags</span><span class="p">)</span>
<span class="p">(</span><span class="nv">comments</span><span class="p">)</span>
</pre></div>
</div>
<p>The first element of a list is the name of a function. Any additional arguments are passed as arguments to the function and the list defining a function is replaced with its return value.</p>
<p>Valid arguments are:</p>
<ul class="simple">
<li><p>functions enclosed in <code class="docutils literal notranslate"><span class="pre">()</span></code></p></li>
<li><p>all json literals
- <code class="docutils literal notranslate"><span class="pre">null</span></code>
- <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>
- integers <code class="docutils literal notranslate"><span class="pre">-17</span></code>, <code class="docutils literal notranslate"><span class="pre">42</span></code>, …
- floats <code class="docutils literal notranslate"><span class="pre">1.2</span></code>, <code class="docutils literal notranslate"><span class="pre">-1e10</span></code>
- <code class="docutils literal notranslate"><span class="pre">&quot;strings</span> <span class="pre">with</span> <span class="pre">escape</span> <span class="pre">sequences</span> <span class="pre">\u0022</span> <span class="pre">\&quot;</span> <span class="pre">\\</span> <span class="pre">\b</span> <span class="pre">\f</span> <span class="pre">\n</span> <span class="pre">\r</span> <span class="pre">\t&quot;</span></code></p></li>
</ul>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>Functions in S-expressions get and process data from store node output. Some may be used in all scopes <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, and <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a>; some only in some (see below).</p>
<div class="section" id="comments">
<h4><code class="docutils literal notranslate"><span class="pre">comments</span></code><a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h4>
<p>Return list of unicode objects with text of comments.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="detail-route">
<span id="cfg-sexp-detail-route"></span><h4><code class="docutils literal notranslate"><span class="pre">detail_route</span></code><a class="headerlink" href="#detail-route" title="Permalink to this headline">¶</a></h4>
<p>Return dictionary rendering link to detail route of dataset. First argument is the dataset’s setid, second optional name is displayed instead of setid.</p>
<p>scope: <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="filter">
<h4><code class="docutils literal notranslate"><span class="pre">filter</span></code><a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h4>
<p>Filter list by removing <code class="docutils literal notranslate"><span class="pre">null</span></code> elements (Python <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<p>Examples:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">filter</span> <span class="nb">null</span> <span class="p">(</span><span class="nv">makelist</span> <span class="p">(</span><span class="nb">get</span> <span class="s">&quot;unit.name&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="format">
<h4><code class="docutils literal notranslate"><span class="pre">format</span></code><a class="headerlink" href="#format" title="Permalink to this headline">¶</a></h4>
<p>Wrapper for <code class="docutils literal notranslate"><span class="pre">fmt.format(*args)</span></code>. First argument is the format string <code class="docutils literal notranslate"><span class="pre">fmt</span></code>, remaining arguments are passed on.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="get">
<h4><code class="docutils literal notranslate"><span class="pre">get</span></code><a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h4>
<p>Get a value from a nodes output. First argument defines node and traversal into its output, second optional argument is used as default value instead of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Examples:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">get</span> <span class="s">&quot;bagmeta.start_time&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nb">get</span> <span class="s">&quot;dataset.files[:].size&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The specifier starts with the nodes name. A <code class="docutils literal notranslate"><span class="pre">.</span></code> performs dictionary key lookup. Lists can be traversed into in part or full using slicing and further dictionary lookup is performed on each element of the list.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="getitem">
<h4><code class="docutils literal notranslate"><span class="pre">getitem</span></code><a class="headerlink" href="#getitem" title="Permalink to this headline">¶</a></h4>
<p>Get an item from a list or dictionary.</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">getitem</span> <span class="p">(</span><span class="nv">split</span> <span class="p">(</span><span class="nb">get</span> <span class="s">&quot;foo.bar&quot;</span><span class="p">)</span> <span class="s">&quot;/&quot;</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="join">
<h4><code class="docutils literal notranslate"><span class="pre">join</span></code><a class="headerlink" href="#join" title="Permalink to this headline">¶</a></h4>
<p>Wrapper for <code class="docutils literal notranslate"><span class="pre">joinstr.join(args)</span></code>. First argument is the join string remaining arguments are joined with.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="len">
<h4><code class="docutils literal notranslate"><span class="pre">len</span></code><a class="headerlink" href="#len" title="Permalink to this headline">¶</a></h4>
<p>Return length of first argument.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="id7">
<h4><code class="docutils literal notranslate"><span class="pre">link</span></code><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>Render link with first argument as href and second argument displayed.</p>
<p>scope: <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="makelist">
<h4><code class="docutils literal notranslate"><span class="pre">makelist</span></code><a class="headerlink" href="#makelist" title="Permalink to this headline">¶</a></h4>
<p>Takes one or more arguments and returns a list containing these.</p>
<p>Examples:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">filter</span> <span class="nb">null</span> <span class="p">(</span><span class="nv">makelist</span> <span class="p">(</span><span class="nb">get</span> <span class="s">&quot;unit.name&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="max">
<h4><code class="docutils literal notranslate"><span class="pre">max</span></code><a class="headerlink" href="#max" title="Permalink to this headline">¶</a></h4>
<p>Return maximum element of first argument.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="min">
<h4><code class="docutils literal notranslate"><span class="pre">min</span></code><a class="headerlink" href="#min" title="Permalink to this headline">¶</a></h4>
<p>Return minimum element of first argument.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="rows">
<h4><code class="docutils literal notranslate"><span class="pre">rows</span></code><a class="headerlink" href="#rows" title="Permalink to this headline">¶</a></h4>
<p>Return all rows matching current filter criteria. The optional second and third arguments extracts a specific column defined in <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a> instead of the full row and provide a default value for it.</p>
<p>Examples:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">sum</span> <span class="p">(</span><span class="nv">rows</span> <span class="s">&quot;size&quot;</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>scope: <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="rsplit">
<h4><code class="docutils literal notranslate"><span class="pre">rsplit</span></code><a class="headerlink" href="#rsplit" title="Permalink to this headline">¶</a></h4>
<p>Split string from the right. First argument is the string, further arguments are passed to python’s string rsplit method.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="set">
<h4><code class="docutils literal notranslate"><span class="pre">set</span></code><a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h4>
<p>Return set with items from one iterable argument.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="split">
<h4><code class="docutils literal notranslate"><span class="pre">split</span></code><a class="headerlink" href="#split" title="Permalink to this headline">¶</a></h4>
<p>Split string. First argument is the string, further arguments are passed to python’s string split method.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="sum">
<h4><code class="docutils literal notranslate"><span class="pre">sum</span></code><a class="headerlink" href="#sum" title="Permalink to this headline">¶</a></h4>
<p>Return sum of arguments.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a>, <a class="reference internal" href="#cfg-c-listing-summary"><span class="std std-ref">listing_summary</span></a></p>
</div>
<div class="section" id="tags">
<h4><code class="docutils literal notranslate"><span class="pre">tags</span></code><a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h4>
<p>Return list of tags associated with dataset.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
<div class="section" id="trace">
<h4><code class="docutils literal notranslate"><span class="pre">trace</span></code><a class="headerlink" href="#trace" title="Permalink to this headline">¶</a></h4>
<p>Print trace messages.</p>
<p>scope: <a class="reference internal" href="#cfg-c-filters"><span class="std std-ref">filters</span></a>, <a class="reference internal" href="#cfg-c-listing-columns"><span class="std std-ref">listing_columns</span></a></p>
</div>
</div>
</div>
<div class="section" id="examples">
<span id="cfg-examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="default-configuration">
<span id="cfg-default-config"></span><h3>Default configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">marv</span><span class="p">]</span>
<span class="n">collections</span> <span class="o">=</span> <span class="n">bags</span>
<span class="c1"># Use next line to run behind nginx</span>
<span class="c1"># reverse_proxy = nginx</span>


<span class="p">[</span><span class="n">collection</span> <span class="n">bags</span><span class="p">]</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">marv_robotics</span><span class="o">.</span><span class="n">bag</span><span class="p">:</span><span class="n">scan</span>

<span class="n">scanroots</span> <span class="o">=</span>
    <span class="o">/</span><span class="n">scanroot</span>

<span class="n">nodes</span> <span class="o">=</span>
    <span class="n">marv_nodes</span><span class="p">:</span><span class="n">dataset</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">bag</span><span class="p">:</span><span class="n">bagmeta</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">cam</span><span class="p">:</span><span class="n">ffmpeg</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">cam</span><span class="p">:</span><span class="n">images</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">bagmeta_table</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">connections_section</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">gnss_section</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">images_section</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">summary_keyval</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">trajectory_section</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span><span class="n">video_section</span>
    <span class="c1"># marv_robotics.fulltext:fulltext</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">gnss</span><span class="p">:</span><span class="n">gnss_plots</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">motion</span><span class="p">:</span><span class="n">acceleration</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">motion</span><span class="p">:</span><span class="n">distance_gps</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">motion</span><span class="p">:</span><span class="n">motion_section</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">motion</span><span class="p">:</span><span class="n">speed</span>
    <span class="n">marv_robotics</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span><span class="n">trajectory</span>

<span class="n">filters</span> <span class="o">=</span>
    <span class="c1"># id       | Display Name  | operators         | value type | value function</span>
    <span class="n">name</span>       <span class="o">|</span> <span class="n">Name</span>          <span class="o">|</span> <span class="n">substring</span>         <span class="o">|</span> <span class="n">string</span>     <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.name&quot;</span><span class="p">)</span>
    <span class="n">setid</span>      <span class="o">|</span> <span class="n">Set</span> <span class="n">Id</span>        <span class="o">|</span> <span class="n">startswith</span>        <span class="o">|</span> <span class="n">string</span>     <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.id&quot;</span><span class="p">)</span>
    <span class="n">size</span>       <span class="o">|</span> <span class="n">Size</span>          <span class="o">|</span> <span class="n">lt</span> <span class="n">le</span> <span class="n">eq</span> <span class="n">ne</span> <span class="n">ge</span> <span class="n">gt</span> <span class="o">|</span> <span class="n">filesize</span>   <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.files[:].size&quot;</span><span class="p">))</span>
    <span class="n">status</span>     <span class="o">|</span> <span class="n">Status</span>        <span class="o">|</span> <span class="nb">any</span> <span class="nb">all</span>           <span class="o">|</span> <span class="n">subset</span>     <span class="o">|</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span>
    <span class="n">tags</span>       <span class="o">|</span> <span class="n">Tags</span>          <span class="o">|</span> <span class="nb">any</span> <span class="nb">all</span>           <span class="o">|</span> <span class="n">subset</span>     <span class="o">|</span> <span class="p">(</span><span class="n">tags</span><span class="p">)</span>
    <span class="n">comments</span>   <span class="o">|</span> <span class="n">Comments</span>      <span class="o">|</span> <span class="n">substring</span>         <span class="o">|</span> <span class="n">string</span>     <span class="o">|</span> <span class="p">(</span><span class="n">comments</span><span class="p">)</span>
    <span class="c1"># fulltext   | Fulltext      | words             | words      | (get &quot;fulltext.words&quot;)</span>
    <span class="n">files</span>      <span class="o">|</span> <span class="n">File</span> <span class="n">paths</span>    <span class="o">|</span> <span class="n">substring_any</span>     <span class="o">|</span> <span class="n">string</span><span class="p">[]</span>   <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.files[:].path&quot;</span><span class="p">)</span>
    <span class="n">added_time</span> <span class="o">|</span> <span class="n">Added</span>         <span class="o">|</span> <span class="n">lt</span> <span class="n">le</span> <span class="n">eq</span> <span class="n">ne</span> <span class="n">ge</span> <span class="n">gt</span> <span class="o">|</span> <span class="n">datetime</span>   <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.time_added&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">|</span> <span class="n">Start</span> <span class="n">time</span>    <span class="o">|</span> <span class="n">lt</span> <span class="n">le</span> <span class="n">eq</span> <span class="n">ne</span> <span class="n">ge</span> <span class="n">gt</span> <span class="o">|</span> <span class="n">datetime</span>   <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.start_time&quot;</span><span class="p">)</span>
    <span class="n">end_time</span>   <span class="o">|</span> <span class="n">End</span> <span class="n">time</span>      <span class="o">|</span> <span class="n">lt</span> <span class="n">le</span> <span class="n">eq</span> <span class="n">ne</span> <span class="n">ge</span> <span class="n">gt</span> <span class="o">|</span> <span class="n">datetime</span>   <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.end_time&quot;</span><span class="p">)</span>
    <span class="n">duration</span>   <span class="o">|</span> <span class="n">Duration</span>      <span class="o">|</span> <span class="n">lt</span> <span class="n">le</span> <span class="n">eq</span> <span class="n">ne</span> <span class="n">ge</span> <span class="n">gt</span> <span class="o">|</span> <span class="n">timedelta</span>  <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.duration&quot;</span><span class="p">)</span>
    <span class="n">topics</span>     <span class="o">|</span> <span class="n">Topics</span>        <span class="o">|</span> <span class="nb">any</span> <span class="nb">all</span>           <span class="o">|</span> <span class="n">subset</span>     <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.topics&quot;</span><span class="p">)</span>
    <span class="n">msg_types</span>  <span class="o">|</span> <span class="n">Message</span> <span class="n">types</span> <span class="o">|</span> <span class="nb">any</span> <span class="nb">all</span>           <span class="o">|</span> <span class="n">subset</span>     <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.msg_types&quot;</span><span class="p">)</span>

<span class="n">listing_columns</span> <span class="o">=</span>
    <span class="c1"># id       | Heading    | formatter | value function</span>
    <span class="n">name</span>       <span class="o">|</span> <span class="n">Name</span>       <span class="o">|</span> <span class="n">route</span>     <span class="o">|</span> <span class="p">(</span><span class="n">detail_route</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.id&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.name&quot;</span><span class="p">))</span>
    <span class="n">size</span>       <span class="o">|</span> <span class="n">Size</span>       <span class="o">|</span> <span class="n">filesize</span>  <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.files[:].size&quot;</span><span class="p">))</span>
    <span class="n">tags</span>       <span class="o">|</span> <span class="n">Tags</span>       <span class="o">|</span> <span class="n">pill</span><span class="p">[]</span>    <span class="o">|</span> <span class="p">(</span><span class="n">tags</span><span class="p">)</span>
    <span class="n">added</span>      <span class="o">|</span> <span class="n">Added</span>      <span class="o">|</span> <span class="n">datetime</span>  <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;dataset.time_added&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">|</span> <span class="n">Start</span> <span class="n">time</span> <span class="o">|</span> <span class="n">datetime</span>  <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.start_time&quot;</span><span class="p">)</span>
    <span class="n">duration</span>   <span class="o">|</span> <span class="n">Duration</span>   <span class="o">|</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;bagmeta.duration&quot;</span><span class="p">)</span>
    <span class="n">max_speed</span>  <span class="o">|</span> <span class="n">Max</span> <span class="n">speed</span>  <span class="o">|</span> <span class="n">speed</span>     <span class="o">|</span> <span class="p">(</span><span class="nb">max</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;speed[:].value&quot;</span><span class="p">))</span>
    <span class="n">distance</span>   <span class="o">|</span> <span class="n">Distance</span>   <span class="o">|</span> <span class="n">distance</span>  <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">get</span> <span class="s2">&quot;distance_gps[:].value&quot;</span><span class="p">))</span>

<span class="n">listing_sort</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">|</span> <span class="n">descending</span>

<span class="n">listing_summary</span> <span class="o">=</span>
    <span class="c1"># id     | Title      | formatter | extractor</span>
    <span class="n">datasets</span> <span class="o">|</span> <span class="n">datasets</span>   <span class="o">|</span> <span class="nb">int</span>       <span class="o">|</span> <span class="p">(</span><span class="nb">len</span> <span class="p">(</span><span class="n">rows</span><span class="p">))</span>
    <span class="n">size</span>     <span class="o">|</span> <span class="n">size</span>       <span class="o">|</span> <span class="n">filesize</span>  <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">rows</span> <span class="s2">&quot;size&quot;</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">duration</span> <span class="o">|</span> <span class="n">duration</span>   <span class="o">|</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">rows</span> <span class="s2">&quot;duration&quot;</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">distance</span> <span class="o">|</span> <span class="n">distance</span>   <span class="o">|</span> <span class="n">distance</span>  <span class="o">|</span> <span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">rows</span> <span class="s2">&quot;distance&quot;</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">detail_summary_widgets</span> <span class="o">=</span>
    <span class="n">summary_keyval</span>
    <span class="n">bagmeta_table</span>

<span class="n">detail_sections</span> <span class="o">=</span>
    <span class="n">connections_section</span>
    <span class="n">images_section</span>
    <span class="n">video_section</span>
    <span class="n">gnss_section</span>
    <span class="n">motion_section</span>
    <span class="n">trajectory_section</span>
</pre></div>
</div>
</div>
<div class="section" id="system-wide-configuration">
<h3>System-wide configuration<a class="headerlink" href="#system-wide-configuration" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">/etc/marv/marv.conf</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">marv</span><span class="p">]</span>
<span class="n">collections</span> <span class="o">=</span> <span class="n">bags</span>

<span class="c1"># keep db/db.sqlite as the suffix!</span>
<span class="n">dburi</span> <span class="o">=</span> <span class="n">sqlite</span><span class="p">:</span><span class="o">///</span><span class="n">var</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">marv</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">db</span><span class="o">.</span><span class="n">sqlite</span>

<span class="c1"># store could also be somewhere else</span>
<span class="n">store</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">marv</span><span class="o">/</span><span class="n">store</span>

<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-collections">
<h3>Multiple collections<a class="headerlink" href="#multiple-collections" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">marv</span><span class="p">]</span>
<span class="n">collections</span> <span class="o">=</span> <span class="n">bags</span> <span class="n">bags2</span> <span class="n">videos</span>

<span class="p">[</span><span class="n">collection</span> <span class="n">bags</span><span class="p">]</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">marv_robotics</span><span class="o">.</span><span class="n">bag</span><span class="p">:</span><span class="n">scan</span>

<span class="o">...</span>

<span class="p">[</span><span class="n">collection</span> <span class="n">bags2</span><span class="p">]</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">marv_robotics</span><span class="o">.</span><span class="n">bag</span><span class="p">:</span><span class="n">scan</span>

<span class="o">...</span>

<span class="p">[</span><span class="n">collection</span> <span class="n">videos</span><span class="p">]</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">my_own_scanner</span><span class="p">:</span><span class="n">scan</span>

<span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MARV Robotics</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/setup-basic-site.html">Tutorial: Setup basic site</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/write-your-own.html">Tutorial: Write your own nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contribution guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns.html">Patterns and known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#relative-paths">Relative paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="#marv-section">marv section</a></li>
<li class="toctree-l2"><a class="reference internal" href="#collection-section">collection section</a></li>
<li class="toctree-l2"><a class="reference internal" href="#s-expressions">S-Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scan.html">Scanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgets.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="httpapi.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="upload.html">Upload (EE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="accesscontrol.html">Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="maintenance.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrate/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGES.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/marv.html">marv</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="views.html" title="previous chapter">Views</a></li>
      <li>Next: <a href="scan.html" title="next chapter">Scanner</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; Copyright 2016-2019  Ternaris.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/config.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>