
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Translate Toolkit Developers Guide &#8212; Translate Toolkit 3.3.3 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bootstrap.js"></script>
    <script src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Making a Translate Toolkit Release" href="releasing.html" />
    <link rel="prev" title="Contributing" href="contributing.html" /> 
  </head><body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Translate Toolkit</a>
        <span class="navbar-text pull-left"><b>3.3.3</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html#tools">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html#scripts">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats/index.html">Supported formats</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="styleguide.html">Translate Styleguide</a></li>
<li class="toctree-l1"><a class="reference internal" href="styleguide.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html#command-line-functional-testing">Command Line Functional Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Translate Toolkit Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasing.html">Making a Translate Toolkit Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="deprecation.html">Deprecation of Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History of the Translate Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Translate Toolkit Developers Guide</a><ul>
<li><a class="reference internal" href="#history">History</a></li>
<li><a class="reference internal" href="#resources">Resources</a><ul>
<li><a class="reference internal" href="#git-access">Git access</a></li>
<li><a class="reference internal" href="#issues">Issues</a></li>
<li><a class="reference internal" href="#communication">Communication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-bugzilla">Working with Bugzilla</a><ul>
<li><a class="reference internal" href="#automated-bugzilla-update-from-commits">Automated Bugzilla update from commits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source-code-map">Source code map</a></li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#general-overview-of-the-programs">General overview of the programs</a><ul>
<li><a class="reference internal" href="#command-line-options">Command line options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#converters">Converters</a></li>
<li><a class="reference internal" href="#tools">Tools</a></li>
<li><a class="reference internal" href="#checks">Checks</a></li>
<li><a class="reference internal" href="#storage">Storage</a><ul>
<li><a class="reference internal" href="#base-classes">Base Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="contributing.html"
         title="previous chapter">&laquo; Contributing</a></li>
  <li><a href="releasing.html"
         title="next chapter">Making a Translate Toolkit Release &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
  <li><a href="../_sources/developers/developers.rst.txt"
	  rel="nofollow"><i class="icon-file"></i> Source</a></li>
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="translate-toolkit-developers-guide">
<span id="id1"></span><h1>Translate Toolkit Developers Guide<a class="headerlink" href="#translate-toolkit-developers-guide" title="Permalink to this headline">¶</a></h1>
<p>The goal of the translate toolkit is to simplify and unify the process of
translation.</p>
<div class="section" id="history">
<span id="developers-history"></span><h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<p>The initial toolkit was designed to convert Mozilla .dtd and .properties files
into Gettext PO format.  The logic was not that PO was in any way superior but
that by simplifying the translations process i.e. allowing a translator to use
one format and one tool that we could get more people involved and more
translators.</p>
<p>The tools have now evolved to include other formats such as OpenOffice.org and
the goal is still to migrate various formats to a common format, PO and in the
future XLIFF as more tools become available for that format.</p>
<p>These tools we group as converters.  Along the way we developed other tools
that allowed us to manipulate PO files and check them for consistency.  As we
evolved the converter tools we have also improved and abstracted the classes
that read the various file types.  In the future we hope to define these better
so that we have a more or less stable API for converters.</p>
</div>
<div class="section" id="resources">
<span id="developers-resources"></span><h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<div class="section" id="git-access">
<span id="developers-git-access"></span><h3>Git access<a class="headerlink" href="#git-access" title="Permalink to this headline">¶</a></h3>
<p>Translate Toolkit uses Git as a Version Control System. You can directly clone
the translate repository or fork it at GitHub.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">translate</span><span class="o">/</span><span class="n">translate</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="section" id="issues">
<span id="developers-bugzilla"></span><h3>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/translate/translate/issues">https://github.com/translate/translate/issues</a></p></li>
</ul>
</div>
<div class="section" id="communication">
<span id="developers-communication"></span><h3>Communication<a class="headerlink" href="#communication" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://gitter.im/translate/dev">Development</a> - no support related questions</p></li>
<li><p><a class="reference external" href="https://gitter.im/translate/pootle">Help</a></p></li>
</ul>
</div>
</div>
<div class="section" id="working-with-bugzilla">
<span id="developers-working-with-bugzilla"></span><h2>Working with Bugzilla<a class="headerlink" href="#working-with-bugzilla" title="Permalink to this headline">¶</a></h2>
<p>When you close bugs ensure that you give a description and git hash for the
fix.  This ensures that the reporter or code reviewer can see your work and has
an easy method of finding your fix.  This is made easier by GitHub’s Bugzilla
integration.</p>
<div class="section" id="automated-bugzilla-update-from-commits">
<h3>Automated Bugzilla update from commits<a class="headerlink" href="#automated-bugzilla-update-from-commits" title="Permalink to this headline">¶</a></h3>
<p>Github will post comments on Bugzilla bugs when the commit messages make
references to the bug by its bug number.</p>
<ul>
<li><p>Bugs are recognised by the following format (which are case-insensitive):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bug</span> <span class="mi">123</span>
</pre></div>
</div>
</li>
<li><p>Multiple bugs can be specified by separating them with a comma, ampersand,
plus or “and”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bug</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">124</span> <span class="ow">and</span> <span class="mi">125</span>
</pre></div>
</div>
</li>
<li><p>Commits to all branches will be processed.</p></li>
<li><p>If there is a “fix”, “close”, or “address” before the bug then that bug is
closed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fix</span> <span class="n">bug</span> <span class="mi">123</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="source-code-map">
<span id="developers-source-code-map"></span><h2>Source code map<a class="headerlink" href="#source-code-map" title="Permalink to this headline">¶</a></h2>
<p>The source code for the tools is hosted on <a class="reference external" href="https://github.com/translate/translate">GitHub</a>.  This rough map will allow you to
navigate the source code tree:</p>
<ul class="simple">
<li><p>convert – convert between different formats and PO format</p></li>
<li><p>filters – <a class="reference internal" href="../commands/pofilter.html"><span class="doc">pofilter</span></a> and its helper functions (badly named,
it is really a checking tool)</p></li>
<li><p>storage – all base file formats: XLIFF, .properties, OpenOffice.org, TMX,
etc.</p></li>
<li><p>misc – various helper functions</p></li>
<li><p>tools – all PO manipulation programs: <a class="reference internal" href="../commands/pocount.html"><span class="doc">pocount</span></a>,
<a class="reference internal" href="../commands/pogrep.html"><span class="doc">pogrep</span></a>, etc</p></li>
<li><p>lang – modules with data / tweaks for various languages</p></li>
<li><p>search – translation memory, terminology matching, and indexing / searching</p></li>
<li><p>share – data files</p></li>
</ul>
</div>
<div class="section" id="setup">
<span id="developers-setup"></span><h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>The toolkit is installed by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>As root</p>
<p>The various setup options are yours to explore</p>
</div>
<div class="section" id="general-overview-of-the-programs">
<span id="developers-general-overview-of-the-programs"></span><h2>General overview of the programs<a class="headerlink" href="#general-overview-of-the-programs" title="Permalink to this headline">¶</a></h2>
<p>Each tool in the toolkit has both a core program and a command line wrapper.
For example the oo2po converter:</p>
<ul class="simple">
<li><p>oo2po – the command line tool</p></li>
<li><p>oo2po.py – the core program</p></li>
</ul>
<p>This is done so that the tools can be used from within the Pootle server thus
reusing the toolkit easily.</p>
<div class="section" id="command-line-options">
<span id="developers-command-line-options"></span><h3>Command line options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h3>
<p>Getting lost with the command line options?  Well you might want to volunteer
to move some of them into configuration files.  But in terms of programming you
might be confused as to where they are located.  Many of the command line
options are implemented in each tool.  Things such as <code class="docutils literal notranslate"><span class="pre">--progress</span></code> and
<code class="docutils literal notranslate"><span class="pre">--errorlevel</span></code> are used in each program.  Thus these are abstracted in
<strong>misc/optrecurse.py</strong>.  While each tools unique command line options are
implemented in <strong>xxx.py</strong>.</p>
</div>
</div>
<div class="section" id="converters">
<span id="developers-converters"></span><h2>Converters<a class="headerlink" href="#converters" title="Permalink to this headline">¶</a></h2>
<p>The converters each have a class that handles the conversion from one format to
another.  This class has one important method <strong>convertfile</strong> which handles the
actual conversion.</p>
<p>A function <strong>convertXXX</strong> manages the conversion for the command line
equivalent and essentially has at least 3 parameters: inputfile, outputfile and
templatefile.  It itself will call the conversion class to handle conversion of
individual files.  Recursing through multiple files is handled by the
optrecurse.py logic.</p>
<p>The converters <strong>main</strong> function handles any unique command line options.</p>
<p>Where we are headed is to get to a level where the storage formats themselves
are more aware of themselves and their abilities.  Thus the converter could end
up as one program that accepts storage format plugins to convert from anything
to almost anything else.  Although our target localisation formats are PO and
XLIFF only.</p>
<p>If you want to create a new converter it is best to look at a simple instance
such as <a class="reference internal" href="../commands/csv2tbx.html"><span class="doc">csv2tbx</span></a> or <a class="reference internal" href="../commands/txt2po.html"><span class="doc">txt2po</span></a> and their
associated storage classes.  The <a class="reference internal" href="../api/storage.html"><span class="doc">storage base class documentation</span></a> will give you the information you need for the storage class
implementation.</p>
</div>
<div class="section" id="tools">
<span id="developers-tools"></span><h2>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h2>
<p>The tools in some way copy the logic of the converters.  We have a class so
that we can reuse a lot of the functionality in Pootle.  We have a core
function that take: input, output and templates.  And we have a <strong>main</strong>
function to handle the command line version.</p>
<p><a class="reference internal" href="../commands/pocount.html"><span class="doc">pocount</span></a> should be converted to this but does not follow this
conventions.  In fact pocount should move the counting to the storage formats
to allow any format to return its own word count.</p>
</div>
<div class="section" id="checks">
<span id="developers-checks"></span><h2>Checks<a class="headerlink" href="#checks" title="Permalink to this headline">¶</a></h2>
<p>There’s really only one, <a class="reference internal" href="../commands/pofilter.html"><span class="doc">pofilter</span></a>.  But there are lots of
helper functions for pofilter.  pofilters main task is to check for errors in
PO or XLIFF files.  Here are the helper file and their descriptions.</p>
<ul class="simple">
<li><p>autocorrect.py – when using <code class="docutils literal notranslate"><span class="pre">--autocorrect</span></code> it will attempt some basic
corrections found in this file</p></li>
<li><p>checks.py – the heart. This contains: the actual checks and their error
reports, and defined variables and accelerators for e.g, <code class="docutils literal notranslate"><span class="pre">--mozilla</span></code></p></li>
<li><p>decorations.py – various helper functions to identify accelerators,
variables and markers</p></li>
<li><p>helpers.py – functions used by the tests</p></li>
<li><p>prefilters.py – functions to e.g. remove variables and accelerators before
applying tests to the PO message</p></li>
</ul>
<p>pofilter is now relatively mature.  The best areas for contributions are:</p>
<ul class="simple">
<li><p>more tests</p></li>
<li><p>language specific configuration files</p></li>
<li><p>tests for the tests – so we don’t break our good tests</p></li>
<li><p>defining a config files scheme to do cool stuff off of the command line.
Globally enable or disable tests based on language, etc</p></li>
<li><p>some approach to retesting that would remove ‘# (pofilter)’ failure markings
if the test now passes.</p></li>
<li><p>ability to mark false positives</p></li>
</ul>
<p>The <a class="reference internal" href="../api/filters.html"><span class="doc">API documentation</span></a> is a good start if you want to add
a new tests.  To add a new language have a look at a language you understand
amongst those already implemented.</p>
</div>
<div class="section" id="storage">
<span id="developers-storage"></span><h2>Storage<a class="headerlink" href="#storage" title="Permalink to this headline">¶</a></h2>
<p>These are the heart of the converters.  Each destination storage format is
implemented in its own file.  Up until toolkit version 0.8, there was no
formally defined API (the tools have been evolving and only recently
stabilised), but they generally followed this structure.  These classes are
defined:</p>
<ul class="simple">
<li><p>XXelement – handles the low level individual elements of the file format.
e.g. PO message, CSV records, DTD elements</p></li>
<li><p>XXfile – handles the document or file level of the format.  Eg a PO file, a
CSV file a DTD file</p>
<ul>
<li><p>fromlines – read in a file and initialise the various elements</p></li>
<li><p>tolines – convert the elements stored in XXelements and portions in XXfile
to a raw file in that format</p></li>
</ul>
</li>
</ul>
<p>In the XML based formats e.g.  TMX, XLIFF and HTML there is usually just an
extended parser to manage the file creation.</p>
<p>Within each storage format there are many helper functions for escaping and
managing the unique features of the actual format.</p>
<p>You can help by:</p>
<ul class="simple">
<li><p>abstracting more of the functions and documenting that so that we can get a
better API</p></li>
<li><p>adding other formats and converters e.g. .DOC, .ODF and others</p></li>
<li><p>helping us move to a position where any format should convert to the base
format: PO and in the future XLIFF without having to create a specific
converter wrapper.</p></li>
<li><p>Ensuring that our formats <a class="reference internal" href="../formats/conformance.html"><span class="doc">conform to the standards</span></a></p></li>
</ul>
<div class="section" id="base-classes">
<span id="developers-base-classes"></span><h3>Base Classes<a class="headerlink" href="#base-classes" title="Permalink to this headline">¶</a></h3>
<p>From toolkit 0.9 onwards, we are moving towards basing all storage formats on a
set of <a class="reference internal" href="../formats/base_classes.html"><span class="doc">base classes</span></a>, in the move to a universal
API.  We’re also fixing things so that escaping is much more sane and handled
within the class itself not by the converters.</p>
<p>In base classes we have different terminology</p>
<ul class="simple">
<li><p>XXXunit = XXXelement</p></li>
<li><p>XXXstore = XXXfile</p></li>
</ul>
<p>We have also tried to unify terminology but this has been filtered into the old
classes as far as possible.</p>
</div>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2002-2021, Translate.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.5.1.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>