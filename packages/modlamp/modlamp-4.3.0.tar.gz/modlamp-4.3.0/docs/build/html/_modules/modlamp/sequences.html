
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>modlamp.sequences &#8212; modlAMP v4.3.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="shortcut icon" href="../../_static/modlamp.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">modlAMP v4.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for modlamp.sequences</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. currentmodule:: modlamp.sequences</span>

<span class="sd">.. moduleauthor:: modlab Alex Mueller ETH Zurich &lt;alex.mueller@pharma.ethz.ch&gt;</span>

<span class="sd">This module incorporates different classes to generate peptide sequences with different characteristics from scratch.</span>
<span class="sd">The following classes are available:</span>

<span class="sd">============================        ===============================================================================</span>
<span class="sd">Class                               Characteristics</span>
<span class="sd">============================        ===============================================================================</span>
<span class="sd">:py:class:`Random`                  Generates random sequences with a specified amino acid distribution.</span>
<span class="sd">:py:class:`Helices`                 Generates presumed amphipathic helical sequences with a hydrophobic moment.</span>
<span class="sd">:py:class:`Kinked`                  Generates presumed amphipathic helices with a kink (Pro residue).</span>
<span class="sd">:py:class:`Oblique`                 Generates presumed oblique oriented sequences in presence of libid membranes.</span>
<span class="sd">:py:class:`Centrosymmetric`         Generates centrosymmetric sequences with a symmetry axis.</span>
<span class="sd">:py:class:`AmphipathicArc`          Generates presumed amphipathic helices with controlled hydrophobic arc size.</span>
<span class="sd">:py:class:`HelicesACP`              Generates sequences with the amino acid probabiliy of helical ACPs.</span>
<span class="sd">:py:class:`MixedLibrary`            Generates a mixed library of sequences of most other classes.</span>
<span class="sd">:py:class:`Hepahelices`             Generates presumed amphipathic helices with a heparin-binding-domain.</span>
<span class="sd">:py:class:`AMPngrams`               Generates sequences from most frequent ngrams in the APD3.</span>
<span class="sd">============================        ===============================================================================</span>

<span class="sd">All classes share the same method :py:func:`generate_sequences()` for sequence generation, potentially enabling</span>
<span class="sd">automation or looping over different classes.</span>

<span class="sd">.. note:: During the process of sequence generation, duplicates are only removed for the :py:class:`MixedLibrary`</span>
<span class="sd">    class. To remove duplicates, call the class methods :py:func:`self.filter_duplicates()`.</span>
<span class="sd">    </span>
<span class="sd">.. seealso:: :class:`modlamp.core.BaseSequence` from which all classes in this module inherit.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">cycle</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">modlamp.core</span> <span class="k">import</span> <span class="n">BaseSequence</span><span class="p">,</span> <span class="n">ngrams_apd</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Alex MÃ¼ller, Gisela Gabernet&quot;</span>
<span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;restructuredtext en&quot;</span>


<div class="viewcode-block" id="Random"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random">[docs]</a><span class="k">class</span> <span class="nc">Random</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for random peptide sequences.</span>

<span class="sd">    This class incorporates methods for generating peptide random peptide sequences of defined length.</span>
<span class="sd">    The amino acid probabilities can be chosen from different probabilities:</span>

<span class="sd">    - **rand**: equal probabilities for all amino acids</span>
<span class="sd">    - **AMP**: amino acid probabilities taken from the antimicrobial peptide database `APD3 &lt;http://aps.unmc.edu/AP/statistic/statistic.php&gt;`_, March 17, 2016, containing 2674 sequences.</span>
<span class="sd">    - **AMPnoCM**: same amino acid probabilities as **AMP** but lacking Cys and Met (for synthesizability)</span>
<span class="sd">    - **ACP**: amino acid probabilities taken from 339 linear peptides in CancerPPD database `CancerPPD  &lt;http://http://crdd.osdd.net/raghava/cancerppd/&gt;`</span>
<span class="sd">    - **randnoCM**: equal probabilities for all amino acids, except 0.0 for both Cys and Met (for synthesizability)</span>

<span class="sd">    The probability values for all natural AA can be found in the following table:</span>

<span class="sd">    ===  ====    ======    =========    ==========  ==========</span>
<span class="sd">    AA   rand    AMP       AMPnoCM      randnoCM    ACP</span>
<span class="sd">    ===  ====    ======    =========    ==========  ==========</span>
<span class="sd">    A    0.05    0.0766    0.0812275    0.05555555  0.14526966</span>
<span class="sd">    C    0.05    0.071     0.0          0.0         0.</span>
<span class="sd">    D    0.05    0.026     0.0306275    0.05555555  0.00690031</span>
<span class="sd">    E    0.05    0.0264    0.0310275    0.05555555  0.00780824</span>
<span class="sd">    F    0.05    0.0405    0.0451275    0.05555555  0.06991102</span>
<span class="sd">    G    0.05    0.1172    0.1218275    0.05555555  0.04957327</span>
<span class="sd">    H    0.05    0.021     0.0256275    0.05555555  0.01725077</span>
<span class="sd">    I    0.05    0.061     0.0656275    0.05555555  0.05647358</span>
<span class="sd">    K    0.05    0.0958    0.1004275    0.05555555  0.27637552</span>
<span class="sd">    L    0.05    0.0838    0.0884275    0.05555555  0.17759216</span>
<span class="sd">    M    0.05    0.0123    0.0          0.0         0.00998729</span>
<span class="sd">    N    0.05    0.0386    0.0432275    0.05555555  0.00798983</span>
<span class="sd">    P    0.05    0.0463    0.0509275    0.05555555  0.01307427</span>
<span class="sd">    Q    0.05    0.0251    0.0297275    0.05555555  0.00381333</span>
<span class="sd">    R    0.05    0.0545    0.0591275    0.05555555  0.02941711</span>
<span class="sd">    S    0.05    0.0613    0.0659275    0.05555555  0.02651171</span>
<span class="sd">    T    0.05    0.0455    0.0501275    0.05555555  0.01543490</span>
<span class="sd">    V    0.05    0.0572    0.0618275    0.05555555  0.04013074</span>
<span class="sd">    W    0.05    0.0155    0.0201275    0.05555555  0.04067550</span>
<span class="sd">    Y    0.05    0.0244    0.0290275    0.05555555  0.00581079</span>
<span class="sd">    ===  ====    ======    =========    ==========  ==========</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Random.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proba</span><span class="o">=</span><span class="s1">&#39;rand&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to actually generate the sequences.</span>

<span class="sd">        :param proba: {str or list} AA probability to be used to generate sequences. Available from str: AMP, AMPnoCM, </span>
<span class="sd">            rand, randnoCM. You can also provide your own list of porbabilities as a list (in AA order, length 20, sum to 1)</span>
<span class="sd">        :return: A list of random AMP sequences with defined AA probabilities</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; b = Random(6, 5, 20)</span>
<span class="sd">        &gt;&gt;&gt; b.generate_sequences(proba=&#39;AMP&#39;)</span>
<span class="sd">        &gt;&gt;&gt; b.sequences</span>
<span class="sd">        [&#39;CYGALWHIFV&#39;,&#39;NIVRHHAPSTVIK&#39;,&#39;LCPNPILGIV&#39;,&#39;TAVVRGKESLTP&#39;,&#39;GTGSVCKNSCRGRFGIIAF&#39;,&#39;VIIGPSYGDAEYA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;AMPnoCM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_AMPnoCM</span>
        <span class="k">elif</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;AMP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_AMP</span>
        <span class="k">elif</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;randnoCM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_randnoCM</span>
        <span class="k">elif</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;ACP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_ACP</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">proba</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">proba</span>
        <span class="c1"># else just keep self.prob which is defined as equal probabilities for all AA</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">))</span>  <span class="c1"># weighed random selection of AA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Helices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices">[docs]</a><span class="k">class</span> <span class="nc">Helices</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for peptide sequences probable to form helices.</span>
<span class="sd">    This class incorporates methods for generating presumed amphipathic alpha-helical peptide sequences.</span>
<span class="sd">    These sequences are generated by placing basic residues along the sequence with distance 3-4 AA to each other.</span>
<span class="sd">    The remaining empty spots are filled up by hydrophobic AAs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Helices.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate amphipathic helical sequences with class features defined in :class:`Helices()`</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: a list of sequences with presumed amphipathic helical structure.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h = Helices(5, 7, 21)</span>
<span class="sd">        &gt;&gt;&gt; h.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;KGIKVILKLAKAGVKAVRL&#39;,&#39;IILKVGKV&#39;,&#39;IAKAGRAIIK&#39;,&#39;LKILKVVGKGIRLIVRIIKAL&#39;,&#39;KAGKLVAKGAKVAAKAIKI&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>  <span class="c1"># gap cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
                <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>  <span class="c1"># next gap</span>
            
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Kinked"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked">[docs]</a><span class="k">class</span> <span class="nc">Kinked</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for peptide sequences probable to form helices with a kink.</span>

<span class="sd">    This class incorporates methods for presumed kinked amphipathic alpha-helical peptide sequences:</span>
<span class="sd">    Sequences are generated by placing basic residues along the sequence with distance 3-4 AA to each other.</span>
<span class="sd">    The remaining spots are filled up by hydrophobic AAs. Then, a basic residue is replaced by proline, presumably</span>
<span class="sd">    leading to a kink in the hydrophobic face of the amphipathic helices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Kinked.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to actually generate the presumed kinked sequences with features defined in the class instances.</span>

<span class="sd">        :return: sequence list with strings stored in the attribute :py:attr:`sequences`</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; k = Kinked(8, 7, 28)</span>
<span class="sd">        &gt;&gt;&gt; k.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; k.sequences</span>
<span class="sd">        [&#39;IILRLHPIG&#39;,&#39;ARGAKVAIKAIRGIAPGGRVVAKVVKVG&#39;,&#39;GGKVGRGVAFLVRIILK&#39;,&#39;KAVKALAKGAPVILCVAKVI&#39;, ...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">poslist</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># used to</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">poslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">basepos</span><span class="p">)</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>  <span class="c1"># gap cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
                <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>  <span class="c1"># next gap</span>
                <span class="n">poslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">basepos</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
            
            <span class="c1"># place proline around the middle of the sequence</span>
            <span class="n">propos</span> <span class="o">=</span> <span class="n">poslist</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poslist</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">propos</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Oblique"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique">[docs]</a><span class="k">class</span> <span class="nc">Oblique</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for oblique sequences with a so called linear hydrophobicity gradient.</span>

<span class="sd">    This class incorporates methods for generating peptide sequences with a linear hydrophobicity gradient, meaning that</span>
<span class="sd">    these sequences have a hydrophobic tail. This feature gives rise to the hypothesis that they orient themselves</span>
<span class="sd">    tilted/oblique in membrane environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Oblique.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the possible oblique sequences.</span>

<span class="sd">        :return: A list of sequences in the attribute :py:attr:`sequences`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; o = Oblique(4, 10, 30)</span>
<span class="sd">        &gt;&gt;&gt; o.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; o.sequences</span>
<span class="sd">        [&#39;GLLKVIRIAAKVLKVAVLVGIIAI&#39;,&#39;AIGKAGRLALKVIKVVIKVALILLAAVA&#39;,&#39;KILRAAARVIKGGIKAIVIL&#39;,&#39;VRLVKAIGKLLRIILRLARLAVGGILA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>  <span class="c1"># iterative cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
                <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>  <span class="c1"># next gap</span>
            
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)):</span>
                <span class="c1"># transform last 3rd of sequence into hydrophobic ones --&gt; hydrophobicity gradient = oblique</span>
                <span class="n">seq</span><span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Centrosymmetric"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric">[docs]</a><span class="k">class</span> <span class="nc">Centrosymmetric</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for peptide sequences produced out of 7 AA centro-symmetric blocks yielding peptides of length</span>
<span class="sd">    14 or 21 AA (2*7 or 3*7).</span>

<span class="sd">    This class incorporates methods to generate special peptide sequences with an overall presumed</span>
<span class="sd">    hydrophobic moment. Sequences are generated by centro-symmetric blocks of seven amino acids. Two or three blocks</span>
<span class="sd">    are added to build a final sequence of length 14 or 21 amino acids length. If the option ``symmetric`` is used,</span>
<span class="sd">    two or three identical blocks are concatenated. If the the option ``asymmetric`` is used, two or three different</span>
<span class="sd">    blocks are concatenated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Centrosymmetric.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="s1">&#39;asymmetric&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate overall symmetric or asymmetric sequences out of two or three blocks of centro-symmetric blocks of 7</span>
<span class="sd">        amino acids. The resulting sequence presumably has a large hydrophobic moment.</span>

<span class="sd">        :param symmetry: {str} type of centrosymmetric sequences. ``symmetric``: builds sequences out of only one</span>
<span class="sd">            block, ``asymmetric``: builds sequences out of different blocks</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: centro-symmetric peptide sequences of the form [h,+,h,a,h,+,h]</span>
<span class="sd">            with h = hydrophobic AA, + = basic AA, a = anchor AA (F,Y,W,(P)), sequence length is 14 or 21 AA</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; s = Centrosymmetric(5)</span>
<span class="sd">        &gt;&gt;&gt; s.generate_sequences(symmetry=&#39;symmetric&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s.sequences</span>
<span class="sd">        [&#39;ARIFIRAARIFIRA&#39;,&#39;GRIYIRGGRIYIRGGRIYIRG&#39;,&#39;IRGFGRIIRGFGRIIRGFGRI&#39;,&#39;GKAYAKGGKAYAKG&#39;,&#39;AKGYGKAAKGYGKAAKGYGKA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">symmetry</span> <span class="o">==</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># iterate over number of sequences to generate</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># number of sequence blocks to take (2 or 3)</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>  <span class="c1"># template sequence AA list with length 7</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>  <span class="c1"># generate symmetric sequence block of 7 AA with an anchor in the middle</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_aroma</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">symmetry</span> <span class="o">==</span> <span class="s1">&#39;asymmetric&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># iterate over number of sequences to generate</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># number of sequence blocks to take (2 or 3)</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>  <span class="c1"># template sequence AA list with length 7</span>
                <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>  <span class="c1"># generate symmetric sequence block of 7 AA with an anchor in the middle</span>
                        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="n">seq</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_aroma</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">continue</span>
                    <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">blocks</span><span class="p">))</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;Unknown symmetry option given! Choose from [symmetric, asymmetric].&#39;</span><span class="p">)</span></div></div>
    

<div class="viewcode-block" id="AmphipathicArc"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc">[docs]</a><span class="k">class</span> <span class="nc">AmphipathicArc</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for generating positively-charged amphipathic peptide sequences based on an alpha-helix pattern with</span>
<span class="sd">    different arc sizes.</span>

<span class="sd">    The probability values for the Hydrophobic and Polar positions of the helix can be found in the following table:</span>

<span class="sd">    ===   ====   =====</span>
<span class="sd">    AA    Hydr   Polar</span>
<span class="sd">    ===   ====   =====</span>
<span class="sd">    A     0.00   0.045</span>
<span class="sd">    C     0.00   0.00</span>
<span class="sd">    D     0.00   0.045</span>
<span class="sd">    E     0.00   0.045</span>
<span class="sd">    F     0.16   0.00</span>
<span class="sd">    G     0.00   0.045</span>
<span class="sd">    H     0.00   0.045</span>
<span class="sd">    I     0.16   0.00</span>
<span class="sd">    K     0.00   0.25</span>
<span class="sd">    L     0.16   0.00</span>
<span class="sd">    M     0.00   0.00</span>
<span class="sd">    N     0.00   0.05</span>
<span class="sd">    P     0.00   0.045</span>
<span class="sd">    Q     0.00   0.045</span>
<span class="sd">    R     0.00   0.25</span>
<span class="sd">    S     0.00   0.045</span>
<span class="sd">    T     0.00   0.045</span>
<span class="sd">    V     0.16   0.00</span>
<span class="sd">    W     0.16   0.00</span>
<span class="sd">    Y     0.16   0.045</span>
<span class="sd">    ===   ====   =====</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="AmphipathicArc.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arcsize</span><span class="o">=</span><span class="mi">180</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the possible amphipathic helices with defined hydrophobic arc sizes (option</span>
<span class="sd">        ``arcsize``), with mixed arc sizes (option ``arcsize=None``)</span>

<span class="sd">        :param arcsize: {int} to choose among 100, 140, 180, 220, 260, or choose `mixed` to generate a mixture.</span>
<span class="sd">        :return: A list of sequences in the attribute :py:attr:`sequences`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; from modlamp.sequences import AmphipathicArc</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel = AmphipathicArc(4, 10, 25)</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.generate_sequences(100)</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.sequences</span>
<span class="sd">        [&#39;YLYANLRQE&#39;, &#39;GVKPRIK&#39;, &#39;RWKKKVKDSVKDFEKRFKDIEKRIQRKLA&#39;, &#39;KIKEQLRNSVSGWHRN&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;mixed&#39;</span><span class="p">:</span>  <span class="c1"># generate mixed arc sizes</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
                
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="mi">140</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="mi">220</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="mi">260</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Arc size unknown, choose among: 100, 140, 180, 220, 260 or &#39;mixed&#39;&quot;</span><span class="p">)</span>

        <span class="n">idxcycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">idxcycle</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">icycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>  <span class="c1"># jumping from one probability to next one in idx array</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">icycle</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob_amphihel</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">i</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">icycle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">idxcycle</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="AmphipathicArc.make_H_gradient"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.make_H_gradient">[docs]</a>    <span class="k">def</span> <span class="nf">make_H_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate the generated sequences to have a hydrophobic gradient by substituting the last third of</span>
<span class="sd">        the sequence amino acids to hydrophobic.</span>

<span class="sd">        :return: A list of sequences in :py:attr:`sequences`</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; amphi_grad = AmphipathicArc(10, 7, 30)</span>
<span class="sd">        &gt;&gt;&gt; amphi_grad.generate_sequences(180)</span>
<span class="sd">        &gt;&gt;&gt; amphi_grad.make_H_gradient()</span>
<span class="sd">        &gt;&gt;&gt; amphi_grad.sequences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">)):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
                <span class="n">seq</span><span class="p">[</span><span class="o">-</span><span class="n">aa</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob_amphihel</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HelicesACP"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP">[docs]</a><span class="k">class</span> <span class="nc">HelicesACP</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for peptides sequences with the amino acid probability of alpha-helical ACPs.</span>

<span class="sd">    This class incorporates methods for generating presumed alpha-helical peptides with the amino acid probability</span>
<span class="sd">    distribution of alpha-helical ACPs. For each of the positions in the helix (1-18) the amino acid distribution among</span>
<span class="sd">    62 anuran and hymenopteran alpha-helical ACPs was computed and is used to design the new sequences</span>
<span class="sd">    (G. Gabernet, A. T. MÃ¼ller, J. A. Hiss, G. Schneider, *Med. Chem. Commun.* **2016**, 7, 2232â2245.).</span>

<span class="sd">    .. image:: ../docs/static/helixplot_legend.png</span>
<span class="sd">        :height: 300px</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="HelicesACP.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the sequences with the mentioned amino acid probabilities.</span>

<span class="sd">        :return: A list of potentially helical peptides with the amino acid distribution of ACP helical peptides</span>
<span class="sd">            according to the position in the helix wheel.</span>

<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; from modlamp.sequences import HelicesACP</span>
<span class="sd">        &gt;&gt;&gt; helACP = HelicesACP(4, 7, 18)</span>
<span class="sd">        &gt;&gt;&gt; helACP.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; helACP.sequences</span>
<span class="sd">        [&#39;FLFDVAKKVAGTALT&#39;, &#39;GLGIILGAGG&#39;, &#39;GLRIKLGVWAKKA&#39;, &#39;GFWGFIKTI&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">%</span> <span class="mi">18</span>  <span class="c1"># for helices &gt;18aa, the probabilities start from the beginning again</span>
                <span class="n">seq</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob_ACPhel</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MixedLibrary"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary">[docs]</a><span class="k">class</span> <span class="nc">MixedLibrary</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for holding a virtual peptide library.</span>

<span class="sd">    This class :class:`MixedLibrary` incorporates methods to generate a virtual peptide library composed out of different</span>
<span class="sd">    sub-libraries. The available library subtypes are all from the classes :class:`Centrosymmetric`, :class:`Helices`,</span>
<span class="sd">    :class:`Kinked`, :class:`Oblique` or :class:`Random`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="MixedLibrary.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">,</span> <span class="n">centrosymmetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">centroasymmetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">helix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kinked</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">oblique</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rand</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">randAMP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">randAMPnoCM</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initializing method of the class :class:`MixedLibrary`. Except from **number**, all other parameters are</span>
<span class="sd">        ratios of sequences of the given sequence class.</span>

<span class="sd">        :param seqnum: {int} number of sequences to be generated</span>
<span class="sd">        :param centrosymmetric: ratio of symmetric centrosymmetric sequences in the library</span>
<span class="sd">        :param centroasymmetric: ratio of asymmetric centrosymmetric sequences in the library</span>
<span class="sd">        :param helix: ratio of amphipathic helical sequences in the library</span>
<span class="sd">        :param kinked: ratio of kinked amphipathic helical sequences in the library</span>
<span class="sd">        :param oblique: ratio of oblique oriented amphipathic helical sequences in the library</span>
<span class="sd">        :param rand: ratio of random sequneces in the library</span>
<span class="sd">        :param randAMP: ratio of random sequences with APD2 amino acid distribution in the library</span>
<span class="sd">        :param randAMPnoCM: ratio of random sequences with APD2 amino acid distribution without Cys and Met in the library</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If duplicate sequences are created, these are removed during the creation process. It is therefore quite</span>
<span class="sd">            probable that you will not get the exact size of library that you entered as the parameter **number**. If you</span>
<span class="sd">            generate a small library, it can also happen that the size is bigger than expected, because ratios are rounded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MixedLibrary</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>  <span class="c1"># inherit methods and some attributes from BaseSequence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">centrosymmetric</span><span class="p">,</span> <span class="n">centroasymmetric</span><span class="p">,</span> <span class="n">helix</span><span class="p">,</span> <span class="n">kinked</span><span class="p">,</span> <span class="n">oblique</span><span class="p">,</span> <span class="n">rand</span><span class="p">,</span> <span class="n">randAMP</span><span class="p">,</span> <span class="n">randAMPnoCM</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">centrosymmetric</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;asy&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">centroasymmetric</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span>
                       <span class="s1">&#39;hel&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">helix</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;knk&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">kinked</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;obl&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">oblique</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span>
                       <span class="s1">&#39;ran&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;AMP&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">randAMP</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;nCM&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">randAMPnoCM</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;asy&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;hel&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;knk&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;obl&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;ran&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;AMP&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;nCM&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">))}</span></div>
    
<div class="viewcode-block" id="MixedLibrary.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method generates a virtual sequence library with the subtype ratios initialized in class :class:`MixedLibrary()`.</span>
<span class="sd">        All sequences are between 7 and 28 amino acids in length.</span>

<span class="sd">        :return: a virtual library of sequences in the attribute :py:attr:`sequences`, the sub-library class names in</span>
<span class="sd">            :py:attr:`names`, the number of sequences generated for each class in :py:attr:`nums` and the library size in</span>
<span class="sd">            :py:attr:`libsize`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; lib = MixedLibrary(10000, centrosymmetric=5, centroasymmetric=5, helix=3, kinked=3, oblique=2, rand=10,</span>
<span class="sd">        randAMP=10,randAMPnoCM=5)</span>
<span class="sd">        &gt;&gt;&gt; lib.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; lib.libsize  # as duplicates were present, the library does not have the size that was sepecified</span>
<span class="sd">        9126</span>
<span class="sd">        &gt;&gt;&gt; lib.sequences</span>
<span class="sd">        [&#39;RHTHVAGSWYGKMPPSPQTL&#39;,&#39;MRIKLRKIPCILAC&#39;,&#39;DGINKEVKDSYGVFLK&#39;,&#39;LRLYLRLGRVWVRG&#39;,&#39;GKLFLKGGKLFLKGGKLFLKG&#39;,...]</span>
<span class="sd">        &gt;&gt;&gt; lib.nums</span>
<span class="sd">        {&#39;AMP&#39;: 2326,</span>
<span class="sd">        &#39;asy&#39;: 1163,</span>
<span class="sd">        &#39;hel&#39;: 698,</span>
<span class="sd">        &#39;knk&#39;: 698,</span>
<span class="sd">        &#39;nCM&#39;: 1163,</span>
<span class="sd">        &#39;obl&#39;: 465,</span>
<span class="sd">        &#39;ran&#39;: 2326,</span>
<span class="sd">        &#39;sym&#39;: 1163}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Cs</span> <span class="o">=</span> <span class="n">Centrosymmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">])</span>
        <span class="n">Cs</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="n">symmetry</span><span class="o">=</span><span class="s1">&#39;symmetric&#39;</span><span class="p">)</span>
        <span class="n">Ca</span> <span class="o">=</span> <span class="n">Centrosymmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">])</span>
        <span class="n">Ca</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="n">symmetry</span><span class="o">=</span><span class="s1">&#39;asymmetric&#39;</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">Helices</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">])</span>
        <span class="n">H</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">()</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">Kinked</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">])</span>
        <span class="n">K</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">()</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">Oblique</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">])</span>
        <span class="n">O</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">()</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">])</span>
        <span class="n">R</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;rand&#39;</span><span class="p">)</span>
        <span class="n">Ra</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">])</span>
        <span class="n">Ra</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;AMP&#39;</span><span class="p">)</span>
        <span class="n">Rc</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">])</span>
        <span class="n">Rc</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;AMPnoCM&#39;</span><span class="p">)</span>
        
        <span class="c1"># TODO: update libnums according to real numbers</span>
        
        <span class="n">sequences</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">Ca</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">H</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">K</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">O</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">sequences</span> \
                    <span class="o">+</span> <span class="n">Ra</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">Rc</span><span class="o">.</span><span class="n">sequences</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">]</span>
        <span class="c1"># combining sequence and name to remove duplicates</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequences</span><span class="p">):</span>
            <span class="n">comb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">comb</span><span class="p">)</span>
        <span class="c1"># remove duplicates</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># update libsize and nums</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>  <span class="c1"># update the number of sequences for every class</span></div>
    
<div class="viewcode-block" id="MixedLibrary.prune_library"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.prune_library">[docs]</a>    <span class="k">def</span> <span class="nf">prune_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newsize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to cut down a library to the given new size.</span>

<span class="sd">        :param newsize: new desired size of the mixed library</span>
<span class="sd">        :return: adapted library with corresponding attributes (sequences, names, libsize, nums)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="n">newsize</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:</span><span class="n">newsize</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>  <span class="c1"># update the number of sequences for every class</span></div></div>


<div class="viewcode-block" id="Hepahelices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices">[docs]</a><span class="k">class</span> <span class="nc">Hepahelices</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for peptide sequences probable to form helices and include a heparin-binding-domain.</span>

<span class="sd">    This class is used to construct presumed amphipathic helices that include a heparin-binding-domain (HBD)</span>
<span class="sd">    probable to bind heparin. The HBD sequence for alpha-helices usually has the following form: **XBBBXXBX**</span>
<span class="sd">    (B: basic AA; X: hydrophobic, uncharged AA, with mainly Ser &amp; Gly).</span>

<span class="sd">    :Reference: Munoz, E. M. &amp; Linhardt, R. J. Heparin-Binding Domains in Vascular Biology. *Arterioscler. Thromb.</span>
<span class="sd">        Vasc. Biol.* **24**, 1549â1557 (2004).</span>

<span class="sd">    .. versionadded:: v2.3.1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Hepahelices.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate helical sequences with class features defined in :class:`Hepahelices()`</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: a list of sequences including a heparin-binding-domain.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h = Hepahelices(10, 8,21)  # minimal length: 8, maximal length: 50</span>
<span class="sd">        &gt;&gt;&gt; h.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;GRLARSLKRKLNRLVRGGGRLVRGGG&#39;, &#39;IRSIRRRLSKLARSLGRGARSLGRG&#39;, &#39;RAVKRKVNKLLKGAAKVLKGAAKVLKGAAK&#39;, ... ]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="c1"># generate heparin binding domain with the from HBBBHPBH (H: hydrophobic, B: basic, P: polar)</span>
            <span class="n">hbd</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_polar</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span>
            <span class="c1"># generate amphipathic block to add in front of HBD</span>
            <span class="n">bef</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])]</span>
            <span class="c1"># generate amphipathic block to add after HBD</span>
            <span class="n">aft</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># total sequence length</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">8</span>  <span class="c1"># remaining empty positions in sequence</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>  <span class="c1"># positions before HBD</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">b</span>  <span class="c1"># positions after HBD</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">bef</span> <span class="o">+</span> <span class="n">hbd</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">aft</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">21</span> <span class="o">-</span> <span class="n">b</span><span class="p">:</span> <span class="mi">29</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># if sequence length is 8, take HBD as whole sequence</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="n">hbd</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="AMPngrams"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams">[docs]</a><span class="k">class</span> <span class="nc">AMPngrams</span><span class="p">(</span><span class="n">BaseSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for sequence generation from the most prominent ngrams (2, 3, 4grams) found in all natural AMP</span>
<span class="sd">    sequences extracted from the `APD3 &lt;http://aps.unmc.edu/AP/&gt;`_ (version August 2016 with 2727 sequences).</span>
<span class="sd">    For all 2, 3 and 4grams, all possible ngrams were generated from all sequences and the top 50 most frequent</span>
<span class="sd">    assembled into a list. Finally, leading and tailing spaces were striped and duplicates as well as ngrams containing</span>
<span class="sd">    spaces were removed.</span>
<span class="sd">    </span>
<span class="sd">    .. versionadded:: v2.4.1</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :py:func:`modlamp.core.ngrams_apd()`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="AMPngrams.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">,</span> <span class="n">n_min</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">11</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param seqnum: {int} number of sequences to be generated</span>
<span class="sd">        :param n_min: {int} minimum number of ngrams to take for sequence assembly</span>
<span class="sd">        :param n_max: {int} maximum number of ngrams to take for sequence assembly</span>
<span class="sd">        :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; s = AMPngrams(10)</span>
<span class="sd">        &gt;&gt;&gt; s.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; s.sequences</span>
<span class="sd">        [&#39;LAKSLGAGKYGGGKA&#39;, &#39;KAALESCVGGGGC&#39;, &#39;GCSGKAAAAAVG&#39;, &#39;GAASCKPCGEAKGLKVCY&#39;, &#39;IGGGCKITGESCVAGLWCGESTCGCSG&#39;, ...]</span>
<span class="sd">        &gt;&gt;&gt; s.ngrams</span>
<span class="sd">        array([&#39;AGK&#39;, &#39;CKI&#39;, &#39;RR&#39;, &#39;YGGG&#39;, &#39;LSGL&#39;, &#39;RG&#39;, &#39;YGGY&#39;, &#39;PRP&#39;, &#39;LGGG&#39;, ...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AMPngrams</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>  <span class="c1"># inherit from BaseSequences and combine with n_min &amp; n_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span> <span class="o">=</span> <span class="n">ngrams_apd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_min</span> <span class="o">=</span> <span class="n">n_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_max</span> <span class="o">=</span> <span class="n">n_max</span></div>
    
<div class="viewcode-block" id="AMPngrams.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate sequences out of APD3 ngrams stored in :py:attr:`ngrams`.</span>
<span class="sd">        </span>
<span class="sd">        :return: list of sequences in :py:attr:`sequences`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max</span><span class="p">)</span>  <span class="c1"># number of ngrams to choose from list to build sequence</span>
            <span class="c1"># build sequence from a random selection of ngrams</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/modlab.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">modlAMP v4.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016 - 2021 ETH Zurich, Switzerland; Alex MÃ¼ller, Gisela Gabernet, Gisbert Schneider..
      Last updated on Feb 25esc, 2021.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>