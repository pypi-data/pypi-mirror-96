
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>spike.Algo package &#8212; spike 0.99.21-490 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="spike.Display package" href="spike.Display.html" />
    <link rel="prev" title="spike package" href="spike.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="spike-algo-package">
<h1>spike.Algo package<a class="headerlink" href="#spike-algo-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spike.Algo.BC">
<span id="spike-algo-bc-module"></span><h2>spike.Algo.BC module<a class="headerlink" href="#module-spike.Algo.BC" title="Permalink to this headline">¶</a></h2>
<p>This module contains several utilities for baseline correction of spectra</p>
<p>Created by Marc-Andre on 2015-03-26.</p>
<p>Modification by Lionel 2015-07-10</p>
<dl class="class">
<dt id="spike.Algo.BC.BC_Tests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">BC_Tests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#BC_Tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.BC_Tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.Algo.BC.BC_Tests.test_baseline0">
<code class="sig-name descname">test_baseline0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#BC_Tests.test_baseline0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.BC_Tests.test_baseline0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.BC.BC_Tests.test_baseline1">
<code class="sig-name descname">test_baseline1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#BC_Tests.test_baseline1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.BC_Tests.test_baseline1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.BC.BC_Tests.test_poly">
<code class="sig-name descname">test_poly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#BC_Tests.test_poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.BC_Tests.test_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>tests the poly function</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.baseline0">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">baseline0</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">degree=2</em>, <em class="sig-param">power=1</em>, <em class="sig-param">method='Powell'</em>, <em class="sig-param">chunksize=2000</em>, <em class="sig-param">nbcores=None</em>, <em class="sig-param">ratiocov=0.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#baseline0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.baseline0" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a piece-wise baseline on y using fitpolyL1
degree :  is the degree of the underlying polynome
power : norm for the approximation
chunksize :  defines the size of the pieces. 
nbcores : number of cores used for parallelization of the calculations.
ratiocov : covering ratio of the chunks
y - baseline(y) produces a baseline corrected spectrum</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.baseline1">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">baseline1</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">degree=2</em>, <em class="sig-param">chunksize=2000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#baseline1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.baseline1" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a piece-wise baseline on y using fitpolyL1
degree is the degree of the underlying polynome
chunksize defines the size of the pieces
a cosine roll-off is used to smooth out chunks junctions</p>
<p>y - baseline(y) produces a baseline corrected spectrum</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.bcL1">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">bcL1</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">degree=2</em>, <em class="sig-param">power=1</em>, <em class="sig-param">method='Powell'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#bcL1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.bcL1" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a baseline on y using fitpolyL1</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.bcL1_paral">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">bcL1_paral</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#bcL1_paral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.bcL1_paral" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a baseline on y using fitpolyL1 for the parallel case.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.correctbaseline">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">correctbaseline</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">nbchunks=100</em>, <em class="sig-param">firstpower=0.3</em>, <em class="sig-param">secondpower=7</em>, <em class="sig-param">degree=1</em>, <em class="sig-param">chunkratio=1.0</em>, <em class="sig-param">interv_ignore=None</em>, <em class="sig-param">method='Powell'</em>, <em class="sig-param">nbcores=None</em>, <em class="sig-param">debug=False</em>, <em class="sig-param">choiceBL=0</em>, <em class="sig-param">ratiocov=0.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#correctbaseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.correctbaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Find baseline by using low norm value and then high norm value to attract the baseline on the small values.
Parameters : 
iterations : number of iterations for convergence toward the small values. 
nbchunks : number of chunks on which is done the minimization. Typically, each chunk must be larger than the peaks. 
firstpower : norm used for the first iterate
secondpower : norm used for attracting the curve toward the lowest values. 
firstdeg : degree used for the first minimization 
degree : degree of the polynome used for approaching each signal chunk. 
chunkratio : ratio for changing the chunksize inside main loop
interv_ignore : ignore a given intervall in the spectrum (eg : avoids issues with water pick)
method : Algorithm used for minimization on each chunk
nbcores : number of cores used for minimizing in parallel on many chunks (if not None)
debug : if debug is set to True, the dictionary bls is built
ratiocov : covering ratio of the chunks. High recovering ratios seem to give better results. By default ratiocov = 0.7</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.fitpolyL1">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">fitpolyL1</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">degree=2</em>, <em class="sig-param">power=1</em>, <em class="sig-param">method='Powell'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#fitpolyL1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.fitpolyL1" title="Permalink to this definition">¶</a></dt>
<dd><p>fit with L1 norm a polynome to a function y over x, returns coefficients</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.BC.poly">
<code class="sig-prename descclassname">spike.Algo.BC.</code><code class="sig-name descname">poly</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">coeff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/BC.html#poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.BC.poly" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the polynomial over x with coeff</p>
</dd></dl>

</div>
<div class="section" id="module-spike.Algo.CS_transformations">
<span id="spike-algo-cs-transformations-module"></span><h2>spike.Algo.CS_transformations module<a class="headerlink" href="#module-spike.Algo.CS_transformations" title="Permalink to this headline">¶</a></h2>
<p>Authors: Marc-André
Last modified: 2011/11/18.</p>
<p>adapted by Lionel on 2013-3-6.
Copyright (c) 2011 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.Algo.CS_transformations.read_data">
<code class="sig-prename descclassname">spike.Algo.CS_transformations.</code><code class="sig-name descname">read_data</code><span class="sig-paren">(</span><em class="sig-param">F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#read_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.read_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads data from the sampling file, used by sampling_load()</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.CS_transformations.read_param">
<code class="sig-prename descclassname">spike.Algo.CS_transformations.</code><code class="sig-name descname">read_param</code><span class="sig-paren">(</span><em class="sig-param">F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#read_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.read_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the sampling parameters. used by sampling_load()</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.CS_transformations.sampling_load">
<code class="sig-prename descclassname">spike.Algo.CS_transformations.</code><code class="sig-name descname">sampling_load</code><span class="sig-paren">(</span><em class="sig-param">addr_sampling_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#sampling_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.sampling_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a sampling protocole from a list of indices stored in a file named addr_sampling_file
returns an nparray with the sampling scheme.</p>
<p>i.e. if b is a full dataset, b[sampling] is the sampled one</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.CS_transformations.transformations">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.CS_transformations.</code><code class="sig-name descname">transformations</code><span class="sig-paren">(</span><em class="sig-param">size_image</em>, <em class="sig-param">size_mesure</em>, <em class="sig-param">sampling=None</em>, <em class="sig-param">debug=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>this class contains methods which are tools to generate transform and ttransform.
ttrans form data to image
trans from image to data.</p>
<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.Id">
<code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.Id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.Id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.check">
<code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.report" title="Permalink to this definition">¶</a></dt>
<dd><p>dumps content</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a sampling function - using self.sampling</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform to data.
Passing from s (image) to x (data)
pre_ft() : s-&gt;s
ft()     : s-&gt;x - fft.ifft by default - should not change size
post_ft() : x-&gt;x - typically : broadening, sampling, truncating, etc…</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.tsample">
<code class="sig-name descname">tsample</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.tsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.tsample" title="Permalink to this definition">¶</a></dt>
<dd><p>transpose of the sampling function</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.ttransform">
<code class="sig-name descname">ttransform</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.ttransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.ttransform" title="Permalink to this definition">¶</a></dt>
<dd><p>the transpose of transform
Passing from x to s (data to image)</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.CS_transformations.transformations.zerofilling">
<code class="sig-name descname">zerofilling</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/CS_transformations.html#transformations.zerofilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.CS_transformations.transformations.zerofilling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-spike.Algo.Cadzow">
<span id="spike-algo-cadzow-module"></span><h2>spike.Algo.Cadzow module<a class="headerlink" href="#module-spike.Algo.Cadzow" title="Permalink to this headline">¶</a></h2>
<p>cadzow.py</p>
<p>Created by Marc-André on 2010-03-18.
Copyright (c) 2010 IGBMC. All rights reserved.</p>
<dl class="class">
<dt id="spike.Algo.Cadzow.CadzowTest">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">CadzowTest</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#CadzowTest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.CadzowTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<ul class="simple">
<li><p>Testing Cadzow mathematics -</p></li>
</ul>
<dl class="method">
<dt id="spike.Algo.Cadzow.CadzowTest.assertAlmostList">
<code class="sig-name descname">assertAlmostList</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">places=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#CadzowTest.assertAlmostList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.CadzowTest.assertAlmostList" title="Permalink to this definition">¶</a></dt>
<dd><p>apply asserAlmostEqual on two list of numbers</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.Cadzow.CadzowTest.mfft">
<code class="sig-name descname">mfft</code><span class="sig-paren">(</span><em class="sig-param">v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#CadzowTest.mfft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.CadzowTest.mfft" title="Permalink to this definition">¶</a></dt>
<dd><p>utility that returns the modulus of the fft of v</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.Cadzow.CadzowTest.test1D">
<code class="sig-name descname">test1D</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#CadzowTest.test1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.CadzowTest.test1D" title="Permalink to this definition">¶</a></dt>
<dd><p>============= a  demo / test of cadzow noise cleaning technique ==============
applied on an additive noise</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.as_cpx">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">as_cpx</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#as_cpx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.as_cpx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.as_float">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">as_float</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#as_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.as_float" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.cadfun">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">cadfun</code><span class="sig-paren">(</span><em class="sig-param">iterelem</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#cadfun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.cadfun" title="Permalink to this definition">¶</a></dt>
<dd><p>utility for cadzow2d - has to be at top level</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.cadzow">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">cadzow</code><span class="sig-paren">(</span><em class="sig-param">data_arg</em>, <em class="sig-param">n_of_line=5</em>, <em class="sig-param">n_of_iter=5</em>, <em class="sig-param">orda=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#cadzow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.cadzow" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the cadzow procedure to remove noise from the current FID.
should be followed with an FT or an LP-SVD analysis</p>
<p>will return a dataset of the same type (float or cpx) as the input</p>
<p>will do nothing if the data is null</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.cadzow1d">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">cadzow1d</code><span class="sig-paren">(</span><em class="sig-param">d1D</em>, <em class="sig-param">n_of_line=5</em>, <em class="sig-param">n_of_iter=5</em>, <em class="sig-param">orda=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#cadzow1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.cadzow1d" title="Permalink to this definition">¶</a></dt>
<dd><p>applies the cadzow procedure to a 1D dataset</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.cadzow2d">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">cadzow2d</code><span class="sig-paren">(</span><em class="sig-param">d2D</em>, <em class="sig-param">n_of_line=5</em>, <em class="sig-param">n_of_iter=5</em>, <em class="sig-param">orda=100</em>, <em class="sig-param">mp=True</em>, <em class="sig-param">N_proc=None</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#cadzow2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.cadzow2d" title="Permalink to this definition">¶</a></dt>
<dd><p>applies the cadzow procedure to all columns of the 2D</p>
<p>if mp,  does it in a multiprocessing fashion using multiprocessing.Pool()
if N_proc is None, finds the optimum numer itself.
verbose = 1 is minimum output, verbose 0 is no output</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.cadzow2dmp">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">cadzow2dmp</code><span class="sig-paren">(</span><em class="sig-param">d2D</em>, <em class="sig-param">n_of_line=5</em>, <em class="sig-param">n_of_iter=5</em>, <em class="sig-param">orda=100</em>, <em class="sig-param">mp=True</em>, <em class="sig-param">N_proc=None</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#spike.Algo.Cadzow.cadzow2dmp" title="Permalink to this definition">¶</a></dt>
<dd><p>applies the cadzow procedure to all columns of the 2D</p>
<p>if mp,  does it in a multiprocessing fashion using multiprocessing.Pool()
if N_proc is None, finds the optimum numer itself.
verbose = 1 is minimum output, verbose 0 is no output</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.dt2svd">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">dt2svd</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">orda=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#dt2svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.dt2svd" title="Permalink to this definition">¶</a></dt>
<dd><p>computes SVD at order ‘orda’ from current 1D data (FID)
data should be a numpy complex 1D array</p>
<p>Calculates the rectangular matrix X(size-order,order) from the data and perform its singular value decomposition.
This is the first step of the LP-SVD spectral analysis method.
The same singular value decomposition can be used to perform forward and backward analysis.</p>
<p>data is untouched</p>
<p>returns (U, S, Vh)</p>
<p>see also : svd2dt svdlist svdclean1 svd2ar</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.svd2dt">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">svd2dt</code><span class="sig-paren">(</span><em class="sig-param">U</em>, <em class="sig-param">S</em>, <em class="sig-param">V</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#svd2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.svd2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Recalculate the data which would produce the SVD decomposition U S V,
Does this by approximating the Hankel data matrix x from the svd and u,v</p>
<p>U S V are untouched,</p>
<p>return data</p>
<p>see also : dt2svd svdclean svd2ar</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Cadzow.svdclean">
<code class="sig-prename descclassname">spike.Algo.Cadzow.</code><code class="sig-name descname">svdclean</code><span class="sig-paren">(</span><em class="sig-param">svd</em>, <em class="sig-param">keep=0</em>, <em class="sig-param">threshold=0</em>, <em class="sig-param">remove=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Cadzow.html#svdclean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Cadzow.svdclean" title="Permalink to this definition">¶</a></dt>
<dd><p>removes noise related features from a svd spectrum
two methods available (uses whichever is available (eventually both)):
keep != 0 : the number of svd to keep
threshold != 0 : the minimum value to keep
when remove == 1, the mean power of the removed SVD is removed from the remaining ones</p>
<p>svd is untouched</p>
</dd></dl>

</div>
<div class="section" id="spike-algo-cadzow-mpi-module">
<h2>spike.Algo.Cadzow_mpi module<a class="headerlink" href="#spike-algo-cadzow-mpi-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="spike-algo-cadzow-mpi2-module">
<h2>spike.Algo.Cadzow_mpi2 module<a class="headerlink" href="#spike-algo-cadzow-mpi2-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="spike-algo-laplace-module">
<h2>spike.Algo.Laplace module<a class="headerlink" href="#spike-algo-laplace-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spike.Algo.Linpredic">
<span id="spike-algo-linpredic-module"></span><h2>spike.Algo.Linpredic module<a class="headerlink" href="#module-spike.Algo.Linpredic" title="Permalink to this headline">¶</a></h2>
<p>Adaptation of code from :</p>
<p>file              CollombBurg.py
author/translator Ernesto P. Adorio</p>
<blockquote>
<div><p>UPDEPP (UP Clark)
<a class="reference external" href="mailto:ernesto&#46;adorio&#37;&#52;&#48;gmail&#46;com">ernesto<span>&#46;</span>adorio<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
</div></blockquote>
<p>Version           0.0.1 jun 11, 2010 # first release.
References        Burg’s Method, Algorithm and Recursion, pp. 9-11</p>
<p>Created by Lionel on 2011-09-18.
Removed the “for loops” so as to speed up using numpy capabilities.
Copyright (c) 2010 IGBMC. All rights reserved.</p>
<dl class="class">
<dt id="spike.Algo.Linpredic.LinpredTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">LinpredTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#LinpredTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.LinpredTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<ul class="simple">
<li><p>Testing linear prediction , Burg algorithm-</p></li>
</ul>
<dl class="method">
<dt id="spike.Algo.Linpredic.LinpredTests.announce">
<code class="sig-name descname">announce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#LinpredTests.announce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.LinpredTests.announce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.Linpredic.LinpredTests.curvetest">
<code class="sig-name descname">curvetest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#LinpredTests.curvetest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.LinpredTests.curvetest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.Linpredic.LinpredTests.setUp">
<code class="sig-name descname">setUp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#LinpredTests.setUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.LinpredTests.setUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.Linpredic.LinpredTests.test_burg">
<code class="sig-name descname">test_burg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#LinpredTests.test_burg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.LinpredTests.test_burg" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>testing burg algo -</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.Linpredic.burgc">
<code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">burgc</code><span class="sig-paren">(</span><em class="sig-param">lprank</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#burgc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.burgc" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on Gifa code
Burgs Method, algorithm and recursion</p>
<blockquote>
<div><p>lprank - number of lags in autoregressive model.
data  - complex data vector to approximate.</p>
</div></blockquote>
<p>returns ar, pow1, error</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Linpredic.burgr">
<code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">burgr</code><span class="sig-paren">(</span><em class="sig-param">m</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#burgr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.burgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on Collomb’s C++ code, pp. 10-11
Burgs Method, algorithm and recursion</p>
<blockquote>
<div><p>m - number of lags in autoregressive model.
x  - real data vector to approximate.</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Linpredic.denoise">
<code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">denoise</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">ar</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#denoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.denoise" title="Permalink to this definition">¶</a></dt>
<dd><p>returned a denoised version of “data”, using “ar” polynomial
first len(ar) points are untouched.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Linpredic.norme">
<code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">norme</code><span class="sig-paren">(</span><em class="sig-param">v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#norme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.norme" title="Permalink to this definition">¶</a></dt>
<dd><p>simple norme definition</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.Linpredic.predict">
<code class="sig-prename descclassname">spike.Algo.Linpredic.</code><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">ar</em>, <em class="sig-param">length</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/Linpredic.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.Linpredic.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a vector with additional points, predicted at the end of “data” up to total size “length”, using “ar” polynomial</p>
</dd></dl>

</div>
<div class="section" id="module-spike.Algo.SL0">
<span id="spike-algo-sl0-module"></span><h2>spike.Algo.SL0 module<a class="headerlink" href="#module-spike.Algo.SL0" title="Permalink to this headline">¶</a></h2>
<p>SL0 from <a class="reference external" href="http://ee.sharif.ir/~SLzero/">http://ee.sharif.ir/~SLzero/</a></p>
<p>Authors: Massoud Babaie-Zadeh and Hossein Mohimani
Version: 1.3
Last modified: 4 August 2008.</p>
<p>adapted to numpy by Marc-André on 2011-11-18.
Copyright (c) 2011 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.Algo.SL0.OurDelta">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">OurDelta</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#OurDelta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.OurDelta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.SL0.SL0">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">SL0</code><span class="sig-paren">(</span><em class="sig-param">A</em>, <em class="sig-param">x</em>, <em class="sig-param">sigma_min</em>, <em class="sig-param">sigma_decrease_factor=0.5</em>, <em class="sig-param">mu_0=2</em>, <em class="sig-param">L=3</em>, <em class="sig-param">A_pinv=None</em>, <em class="sig-param">true_s=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#SL0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.SL0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>SL0(A, x, sigma_min, sigma_decrease_factor, mu_0, L, A_pinv, true_s)</p>
<blockquote>
<div><p>Returns the sparsest vector s which satisfies underdetermined system of
linear equations  A*s=x, using  Smoothed L0  (SL0) algorithm. Note that 
the matrix  A should  be a ‘wide’ matrix  (more columns than rows). The 
number of the rows of  matrix A  should  be  equal to the length of the 
column vector x.</p>
<blockquote>
<div><p>The first 3 arguments should necessarily be provided by the user. The</p>
</div></blockquote>
<p>other parameters have defult values  calculated within the function, or
may be provided by the user.</p>
<dl>
<dt>Sequence of Sigma (sigma_min and sigma_decrease_factor):</dt><dd><dl class="simple">
<dt>This is a decreasing geometric sequence of positive numbers:</dt><dd><ul class="simple">
<li><p>The  first  element   of  the  sequence  of  sigma is  calculated</p></li>
</ul>
</dd>
</dl>
<p>automatically. The last  element  is  given  by  ‘sigma_min’, and the 
change factor for decreasing sigma is given by ‘sigma_decrease_factor’.</p>
<blockquote>
<div><ul class="simple">
<li><p>The default value of ‘sigma_decrease_factor’ is 0.5. Larger value</p></li>
</ul>
</div></blockquote>
<p>gives better results  for less sparse sources, but it uses more steps 
on   sigma   to  reach  sigma_min,  and  hence  it  requires   higher 
computational cost.</p>
<blockquote>
<div><ul class="simple">
<li><p>There is no default  value for  ‘sigma_min’,  and  it  should  be</p></li>
</ul>
</div></blockquote>
<p>provided  by  the  user (depending  on his/her estimated source noise 
level,  or  his/her  desired  accuracy).  By <a href="#id1"><span class="problematic" id="id2">`</span></a>noise’ we mean here the
noise in the sources, that is, the energy of the inactive elements of
‘s’.   For example,  by  the  noiseless  case,  we  mean the inactive
elements of ‘s’ are exactly equal to zero. As a rule of tumb, for the
noisy case,  sigma_min should be about 2 to 4  times  of the standard
deviation of this noise.  For the noiseless case, smaller ‘sigma_min’
results in  better estimation of the sparsest solution, and hence its
value is determined by the desired accuracy.</p>
</dd>
<dt>mu_0: </dt><dd><blockquote>
<div><p>The  value  of  mu_0  scales  the sequence of mu. For each vlue of</p>
</div></blockquote>
<p>sigma, the value of  mu is chosen via mu=mu_0*sigma^2. Note that this 
value effects Convergence.</p>
<blockquote>
<div><p>The default value is mu_0=2 (see the paper).</p>
</div></blockquote>
</dd>
<dt>L: </dt><dd><blockquote>
<div><p>number  of  iterations of the internal (steepest ascent) loop. The</p>
</div></blockquote>
<p>default value is L=3.</p>
</dd>
<dt>A_pinv: </dt><dd><blockquote>
<div><p>is the  pseudo-inverse of matrix A defined by A_pinv=A’<a href="#id3"><span class="problematic" id="id4">*</span></a>inv(A*A’).</p>
</div></blockquote>
<p>If it is not provided, it will be calculated within the function.  If
you use this function for solving x(t)=A s(t) for different values of
‘t’, it would be a good idea to calculate A_pinv outside the function
to prevent its re-calculation for each ‘t’.</p>
</dd>
<dt>true_s: </dt><dd><blockquote>
<div><p>is the  true value of the  sparse  solution.  This argument is for</p>
</div></blockquote>
<p>simulation purposes. If it is provided by the user, then the function
will  calculate the SNR of the estimation for each value of sigma and
it provides a progress report.</p>
</dd>
</dl>
</div></blockquote>
<p>Authors: Massoud Babaie-Zadeh and Hossein Mohimani
Version: 1.4
Last modified: 4 April 2010.
Web-page:
——————</p>
<blockquote>
<div><p><a class="reference external" href="http://ee.sharif.ir/~SLzero">http://ee.sharif.ir/~SLzero</a></p>
</div></blockquote>
<p>Code History:</p>
</div></blockquote>
<p>MODIF MAD : FT if true, spacity is evaluated in Fourier space
Version 2.0: 4 April 2010</p>
<blockquote>
<div><p>Doing a few small modifications that enable the code to work also
for complex numbers (not only for real numbers).</p>
</div></blockquote>
<dl class="simple">
<dt>Version 1.3: 13 Sep 2008</dt><dd><p>Just a few modifications in the comments</p>
</dd>
</dl>
<p>Version 1.2: Adding some more comments in the help section</p>
<blockquote>
<div><dl class="simple">
<dt>Version 1.1: 4 August 2008</dt><dd><ul class="simple">
<li><p>Using MATLAB’s pseudo inverse function to generalize for the case
the matrix A is not full-rank.</p></li>
</ul>
</dd>
</dl>
<p>Version 1.0 (first official version): 4 July 2008.</p>
<p>First non-official version and algorithm development: Summer 2006</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.SL0.SL0FT">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">SL0FT</code><span class="sig-paren">(</span><em class="sig-param">A</em>, <em class="sig-param">x</em>, <em class="sig-param">sigma_min</em>, <em class="sig-param">sigma_decrease_factor=0.5</em>, <em class="sig-param">mu_0=2</em>, <em class="sig-param">L=3</em>, <em class="sig-param">A_pinv=None</em>, <em class="sig-param">true_s=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#SL0FT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.SL0FT" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplistic implementation of FT in SL0
same argument as SL0,</p>
<p>A is a sampling/scrambling matrix
if A is identity, trunctation or random sampling, then  A_pinv should be provided as A.T</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.SL0.SL0_Tests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">SL0_Tests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#SL0_Tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.SL0_Tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.Algo.SL0.SL0_Tests.test_igor1">
<code class="sig-name descname">test_igor1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#SL0_Tests.test_igor1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.SL0_Tests.test_igor1" title="Permalink to this definition">¶</a></dt>
<dd><p>from <a class="reference external" href="http://nuit-blanche.blogspot.com/2011/11/how-to-wow-your-friends-in-high-places.html">http://nuit-blanche.blogspot.com/2011/11/how-to-wow-your-friends-in-high-places.html</a>
code from Igor Carron</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.SL0.SL0gene">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">SL0gene</code><span class="sig-paren">(</span><em class="sig-param">transf</em>, <em class="sig-param">ttransf</em>, <em class="sig-param">x</em>, <em class="sig-param">sigma_min</em>, <em class="sig-param">sigma_decrease_factor=0.5</em>, <em class="sig-param">mu_0=2</em>, <em class="sig-param">L=3</em>, <em class="sig-param">true_s=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#SL0gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.SL0gene" title="Permalink to this definition">¶</a></dt>
<dd><p>general implementation of SL0
most arguments as SL0</p>
<p>transform and ttransform are generalized linear operation
simplistic implementation could be :
def trans(s):</p>
<blockquote>
<div><p>“transform s to x”
return np.dot(A, fft.ifft(s) )</p>
</div></blockquote>
<dl class="simple">
<dt>def ttrans(x):</dt><dd><p>“ttransform x to s”
return fft.fft(np.dot(A_pinv, x))</p>
</dd>
</dl>
<p>just write your own (eventually algorithmic) or used provided ones</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.SL0.estimate_SNR">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">estimate_SNR</code><span class="sig-paren">(</span><em class="sig-param">estim_s</em>, <em class="sig-param">true_s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#estimate_SNR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.estimate_SNR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.SL0.norm">
<code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">norm</code><span class="sig-paren">(</span><em class="sig-param">v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="spike.Algo.SL0.transformations">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.SL0.</code><code class="sig-name descname">transformations</code><span class="sig-paren">(</span><em class="sig-param">size_image</em>, <em class="sig-param">size_mesure</em>, <em class="sig-param">debug=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>this class contains methods which are tools to generate transform and ttransform functions needed by
convergence algorithms</p>
<dl class="method">
<dt id="spike.Algo.SL0.transformations.Id">
<code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.Id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.Id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.SL0.transformations.check">
<code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.Algo.SL0.transformations.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a sampling function - using self.sampling</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.SL0.transformations.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform s (image) to x (data)
pre_ft() : s-&gt;s
ft()     : s-&gt;x - fft.ifft by default - should not change size
post_ft() : x-&gt;x - typically : broadening, sampling, truncating, etc…</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.SL0.transformations.tsample">
<code class="sig-name descname">tsample</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.tsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.tsample" title="Permalink to this definition">¶</a></dt>
<dd><p>transpose of the sampling function</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.SL0.transformations.ttransform">
<code class="sig-name descname">ttransform</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/SL0.html#transformations.ttransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.SL0.transformations.ttransform" title="Permalink to this definition">¶</a></dt>
<dd><p>the transpose of transform
transform x to s</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="spike-algo-sl0-test-module">
<h2>spike.Algo.SL0_test module<a class="headerlink" href="#spike-algo-sl0-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spike.Algo.maxent">
<span id="spike-algo-maxent-module"></span><h2>spike.Algo.maxent module<a class="headerlink" href="#module-spike.Algo.maxent" title="Permalink to this headline">¶</a></h2>
<p>maxent.py</p>
<p>Created by Marc-André on 2012-03-06.
Copyright (c) 2012 IGBMC. All rights reserved.</p>
<dl class="class">
<dt id="spike.Algo.maxent.ExpData">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">ExpData</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#ExpData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.ExpData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implement an experimental data to be analysed
Combined with the definition of the transform ( TransferFunction ), defines the scene for the MaxEnt solver</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.maxent.MaxEnt">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">MaxEnt</code><span class="sig-paren">(</span><em class="sig-param">transferfunction</em>, <em class="sig-param">expdata</em>, <em class="sig-param">iterations=10</em>, <em class="sig-param">debug=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>implements the Maximum Entropy solver</p>
<p>given M 
finds the minimum of Q = S(M) - lamb*Chi2(M)
with lamb such that Chi2(M) is normalized</p>
<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.Q">
<code class="sig-name descname">Q</code><span class="sig-paren">(</span><em class="sig-param">im</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.Q"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>the Q function returns the value of -Q for a given image
-Q so that it can be minimized</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.concentring">
<code class="sig-name descname">concentring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.concentring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.concentring" title="Permalink to this definition">¶</a></dt>
<dd><p>used when no valid step is found</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.do_chisquare">
<code class="sig-name descname">do_chisquare</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode='derivative'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.do_chisquare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.do_chisquare" title="Permalink to this definition">¶</a></dt>
<dd><p>computes chi2 (scalar) and its derivative (array),
computed between     the current image</p>
<blockquote>
<div><p>and     self.expdata which is the experimental data</p>
</div></blockquote>
<p>returned as (chi2, dchi2)
if mode != ‘derivative’  then only chi2 is computed, and returned</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.do_entropy">
<code class="sig-name descname">do_entropy</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode='derivative'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.do_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.do_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the entropy S (scalar) and its derivative (array),
computed on image
returned as (S, dS)
if mode != ‘derivative’  then only S is computed, and returned</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.drive_conv">
<code class="sig-name descname">drive_conv</code><span class="sig-paren">(</span><em class="sig-param">dchi</em>, <em class="sig-param">dS</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.drive_conv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.drive_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>returns (conv, lambda_optim)
given the derivative dchi and dS, and the current settings</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.report" title="Permalink to this definition">¶</a></dt>
<dd><p>report internal state values</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.report_convergence">
<code class="sig-name descname">report_convergence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.report_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.report_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a set of array, which describe the way convergence was handled
returns
self.iter   The number of iteration performed so far
self.image  The final image obtained on the last iteration
self.chi2   The chi2 obtained on the last iteration
self.S      The entropy obtained on the last iteration
self.sum    The integral of self.image
self.lamb   The lambda obtained on the last iteration
self.dchi2      The derivative of chi2 obtained on the last iteration
self.dS         The derivative of S obtained on the last iteration
(following are [] if self.debug==0 )
self.lchi2      The list of chi2 values since the beginning
self.lentropy   The list of S values since the beginning
self.llamb      The list of lambda values since the beginning</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param">mode='default'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set-up internal MaxEnt parameters so that a kind of optimal state is given</p>
<dl class="simple">
<dt>mode can be (case insensitive)</dt><dd><p>“Descent”
“Newton”
“Gifa”
“default”   : currently sets to Descent</p>
</dd>
<dt>modifies (M the MaxEnt instance):</dt><dd><p>M.algo M.exptang M.lambdacont M.lambdamax M.lambdasp M.miniter M.stepmax</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.sexp">
<code class="sig-name descname">sexp</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.sexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.sexp" title="Permalink to this definition">¶</a></dt>
<dd><p>a local and linearized version of the exponential
exptang is the tangent point</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point for MaxEnt
after having been initialised, and all attributes set,
calling solve will realize the MaxEnt convergence.</p>
<p>after having called solve(), the following fields are updated : (see self.report_convergence())
self.iter   The number of iteration performed so far
self.image  The final image obtained on the last iteration
self.chi2   The chi2 obtained on the last iteration
self.S      The entropy obtained on the last iteration
self.sum    The integral of self.image
self.lamb   The lambda obtained on the last iteration
self.dchi2      The derivative of chi2 obtained on the last iteration
self.dS         The derivative of S obtained on the last iteration
the following will be populated only if self.debug&gt;0 :
self.lchi2      The list of chi2 values since the beginning
self.lentropy   The list of S values since the beginning
self.llamb      The list of lambda values since the beginning</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.MaxEnt.update_lambda">
<code class="sig-name descname">update_lambda</code><span class="sig-paren">(</span><em class="sig-param">newlambda</em>, <em class="sig-param">inc=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#MaxEnt.update_lambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.MaxEnt.update_lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>moves self.lamb to new value, using new value newlambda as internal control
typically : l = l (1-inc) * l inc
restricted to +/- lambdamax</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.Algo.maxent.TransferFunction">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">TransferFunction</code><a class="reference internal" href="_modules/spike/Algo/maxent.html#TransferFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.TransferFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>defines the transfert functions for a given problem to be solved by MaxEnt
data    &lt;– transform –  image         The experimental transfer function
data     – t_transform –&gt;  image      The transpose of <a href="#id5"><span class="problematic" id="id6">`</span></a>transform’</p>
<dl class="simple">
<dt>must implement</dt><dd><p>transform()         // defined above
t_transform()
init_transform()
norm                // the norm of the transform operator, defined as ||tr(x)|| / ||x||</p>
</dd>
</dl>
<dl class="method">
<dt id="spike.Algo.maxent.TransferFunction.init_transform">
<code class="sig-name descname">init_transform</code><span class="sig-paren">(</span><em class="sig-param">size=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#TransferFunction.init_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.TransferFunction.init_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>each transform/ttransform pair should have its initialisation code</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.TransferFunction.t_transform">
<code class="sig-name descname">t_transform</code><span class="sig-paren">(</span><em class="sig-param">datain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#TransferFunction.t_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.TransferFunction.t_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>default method for transform
here, simple convolution by a 5 pixel rectangle</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.TransferFunction.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">datain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#TransferFunction.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.TransferFunction.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>default method for transform
here, simple convolution by a 5 pixel rectangle</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.br">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">br</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#br"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.br" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.d_entropy_Gifa">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">d_entropy_Gifa</code><span class="sig-paren">(</span><em class="sig-param">F</em>, <em class="sig-param">S</em>, <em class="sig-param">sc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#d_entropy_Gifa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.d_entropy_Gifa" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the derivative of entropy of the ndarray a, given entropy S and scaling value sc
Gifa  : dS/dFi = -1/sc (S+log(Fi/A))</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.d_entropy_Skilling">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">d_entropy_Skilling</code><span class="sig-paren">(</span><em class="sig-param">F</em>, <em class="sig-param">sc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#d_entropy_Skilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.d_entropy_Skilling" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the derivative of entropy of the ndarray a, given entropy S and scaling value sc
Skilling  : dS/dFi = -1/sc (1+log(Fi/A))</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.d_entropy_prior">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">d_entropy_prior</code><span class="sig-paren">(</span><em class="sig-param">F</em>, <em class="sig-param">A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#d_entropy_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.d_entropy_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the derivative of entropy of the ndarray F, given a prior knowledge in ndarray A</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.entropy">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">entropy</code><span class="sig-paren">(</span><em class="sig-param">F</em>, <em class="sig-param">sc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the entropy of the ndarray a, given scaling value sc
S =  sum of -Z(i)*LOG(Z(i)), where  Z(i) = a(i)/sc )</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.entropy_prior">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">entropy_prior</code><span class="sig-paren">(</span><em class="sig-param">F</em>, <em class="sig-param">A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#entropy_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.entropy_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the entropy of the ndarray F, given a prior knowledge in ndarray A
S =  - sum  [F(i) - A(i) + F(i)*LOG(F(i)/A(i)) ]</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.estimate_SNR">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">estimate_SNR</code><span class="sig-paren">(</span><em class="sig-param">estim_s</em>, <em class="sig-param">true_s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#estimate_SNR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.estimate_SNR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.initial_scene">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">initial_scene</code><span class="sig-paren">(</span><em class="sig-param">size=100</em>, <em class="sig-param">sc=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#initial_scene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.initial_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>draw test scene</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.initial_scene_2delta">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">initial_scene_2delta</code><span class="sig-paren">(</span><em class="sig-param">size=100</em>, <em class="sig-param">sc=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#initial_scene_2delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.initial_scene_2delta" title="Permalink to this definition">¶</a></dt>
<dd><p>draw test scene</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.initial_scene_delta">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">initial_scene_delta</code><span class="sig-paren">(</span><em class="sig-param">size=100</em>, <em class="sig-param">sc=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#initial_scene_delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.initial_scene_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>draw test scene</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.maxent.maxent_Tests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">maxent_Tests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#maxent_Tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.maxent_Tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.Algo.maxent.maxent_Tests.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param">size=100</em>, <em class="sig-param">noise=0.1</em>, <em class="sig-param">sc=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#maxent_Tests.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.maxent_Tests.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>set-up scene</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.maxent_Tests.setup_test">
<code class="sig-name descname">setup_test</code><span class="sig-paren">(</span><em class="sig-param">M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#maxent_Tests.setup_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.maxent_Tests.setup_test" title="Permalink to this definition">¶</a></dt>
<dd><p>set-up M fr tests</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.maxent_Tests.test_MaxEnt">
<code class="sig-name descname">test_MaxEnt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#maxent_Tests.test_MaxEnt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.maxent_Tests.test_MaxEnt" title="Permalink to this definition">¶</a></dt>
<dd><p>run MaxEnt test</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.maxent.maxent_Tests.test_sexp">
<code class="sig-name descname">test_sexp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#maxent_Tests.test_sexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.maxent_Tests.test_sexp" title="Permalink to this definition">¶</a></dt>
<dd><p>draw sexp()</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.maxent.plot">
<code class="sig-prename descclassname">spike.Algo.maxent.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">buf</em>, <em class="sig-param">text=None</em>, <em class="sig-param">fig=0</em>, <em class="sig-param">logy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/maxent.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.maxent.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot with a text and return the figure number</p>
</dd></dl>

</div>
<div class="section" id="module-spike.Algo.rQRd">
<span id="spike-algo-rqrd-module"></span><h2>spike.Algo.rQRd module<a class="headerlink" href="#module-spike.Algo.rQRd" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rqrd-py">
<h3>rQRd.py<a class="headerlink" href="#rqrd-py" title="Permalink to this headline">¶</a></h3>
<p>Algorithm for denoising time series, named rQRd (standing for random QR denoising)</p>
<p>main function is 
rQRd(data, rank)
data : the series to be denoised
rank : the rank of the analysis</p>
<p>Copyright (c) 2013 IGBMC and CNRS. All rights reserved.</p>
<p>Marc-Andr’e Delsuc &lt;<a class="reference external" href="mailto:madelsuc&#37;&#52;&#48;unistra&#46;fr">madelsuc<span>&#64;</span>unistra<span>&#46;</span>fr</a>&gt;
Lionel Chiron &lt;<a class="reference external" href="mailto:lionel&#46;chiron&#37;&#52;&#48;gmail&#46;com">lionel<span>&#46;</span>chiron<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This software is a computer program whose purpose is to compute rQRd denoising.</p>
<p>This software is governed by the CeCILL  license under French law and
abiding by the rules of distribution of free software.  You can  use, 
modify and/ or redistribute the software under the terms of the CeCILL
license as circulated by CEA, CNRS and INRIA at the following URL
“<a class="reference external" href="http://www.cecill.info">http://www.cecill.info</a>”.</p>
<p>As a counterpart to the access to the source code and  rights to copy,
modify and redistribute granted by the license, users are provided only
with a limited warranty  and the software’s author,  the holder of the
economic rights,  and the successive licensors  have only  limited
liability.</p>
<p>In this respect, the user’s attention is drawn to the risks associated
with loading,  using,  modifying and/or developing or reproducing the
software by the user in light of its specific status of free software,
that may mean  that it is complicated to manipulate,  and  that  also
therefore means  that it is reserved for developers  and  experienced
professionals having in-depth computer knowledge. Users are therefore
encouraged to load and test the software’s suitability as regards their
requirements in conditions enabling the security of their systems and/or 
data to be ensured and,  more generally, to use and operate it in the 
same conditions as regards security.</p>
<p>The fact that you are presently reading this means that you have had
knowledge of the CeCILL license and that you accept its terms.</p>
<p>Created by Lionel Chiron and Marc-Andr’e on 2012-04-04.
version 1.0</p>
<dl class="function">
<dt id="spike.Algo.rQRd.Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.rQRd.</code><code class="sig-name descname">Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">QQH</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/rQRd.html#Hankel2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.rQRd.Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Goes from QQH to the datadenoised</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.rQRd.dt2Hankel">
<code class="sig-prename descclassname">spike.Algo.rQRd.</code><code class="sig-name descname">dt2Hankel</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">orda</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/rQRd.html#dt2Hankel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.rQRd.dt2Hankel" title="Permalink to this definition">¶</a></dt>
<dd><p>constructs the Hankel H matrix from the data
Build the matrix by sticking shifted column vectors.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.rQRd.rQRd">
<code class="sig-prename descclassname">spike.Algo.rQRd.</code><code class="sig-name descname">rQRd</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">k</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/rQRd.html#rQRd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.rQRd.rQRd" title="Permalink to this definition">¶</a></dt>
<dd><p>rQRd algorithm. Name stands for random QR denoising.
From a data series return a denoised series denoised
data : the series to be denoised - a (normally complex) numpy buffer
k : the rank of the analysis
orda : is the order of the analysis</p>
<blockquote>
<div><p>internally, a Hankel matrix (M,N) is constructed, with M = orda and N = len(data)-orda+1
if None (default) orda = (len(data)+1)/2</p>
</div></blockquote>
<p>iterations : the number of time the operation should be repeated</p>
<p>values are such that
orda &lt;= (len(data)+1)/2
k &lt; orda
N = len(data)-orda+1
Omega is (N x k)</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.rQRd.rQRdCore">
<code class="sig-prename descclassname">spike.Algo.rQRd.</code><code class="sig-name descname">rQRdCore</code><span class="sig-paren">(</span><em class="sig-param">H</em>, <em class="sig-param">k</em>, <em class="sig-param">Omega</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/rQRd.html#rQRdCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.rQRd.rQRdCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Core of rQRd algorithm</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.rQRd.test_rQRd">
<code class="sig-prename descclassname">spike.Algo.rQRd.</code><code class="sig-name descname">test_rQRd</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">noise=200.0</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">noisetype='additive'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/rQRd.html#test_rQRd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.rQRd.test_rQRd" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of rQRd on a synthetic data-set ===============</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-spike.Algo.sane">
<span id="spike-algo-sane-module"></span><h2>spike.Algo.sane module<a class="headerlink" href="#module-spike.Algo.sane" title="Permalink to this headline">¶</a></h2>
<p>sane.py</p>
<p>This version is GPU accelerated, using the cuda library.
Speed-up ranges from 2 to 10 depending on board and system.
Depending on the size of your inboard GPU memory, the size of the data-set may be limited</p>
<p>main function is 
sane(data, rank)
data : the series to be denoised
rank : the rank of the analysis</p>
<p>Copyright (c) 2015 IGBMC. All rights reserved.
Marc-Andr’e Delsuc &lt;<a class="reference external" href="mailto:madelsuc&#37;&#52;&#48;unistra&#46;fr">madelsuc<span>&#64;</span>unistra<span>&#46;</span>fr</a>&gt;
Lionel Chiron &lt;<a class="reference external" href="mailto:lionel&#46;chiron&#37;&#52;&#48;gmail&#46;com">lionel<span>&#46;</span>chiron<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This software is a computer program whose purpose is to compute sane denoising.</p>
<p>This software is governed by the CeCILL  license under French law and
abiding by the rules of distribution of free software.  You can  use, 
modify and/ or redistribute the software under the terms of the CeCILL
license as circulated by CEA, CNRS and INRIA at the following URL
“<a class="reference external" href="http://www.cecill.info">http://www.cecill.info</a>”.</p>
<p>As a counterpart to the access to the source code and  rights to copy,
modify and redistribute granted by the license, users are provided only
with a limited warranty  and the software’s author,  the holder of the
economic rights,  and the successive licensors  have only  limited
liability.</p>
<p>In this respect, the user’s attention is drawn to the risks associated
with loading,  using,  modifying and/or developing or reproducing the
software by the user in light of its specific status of free software,
that may mean  that it is complicated to manipulate,  and  that  also
therefore means  that it is reserved for developers  and  experienced
professionals having in-depth computer knowledge. Users are therefore
encouraged to load and test the software’s suitability as regards their
requirements in conditions enabling the security of their systems and/or 
data to be ensured and,  more generally, to use and operate it in the 
same conditions as regards security.</p>
<p>The fact that you are presently reading this means that you have had
knowledge of the CeCILL license and that you accept its terms.</p>
<p>First Created by Lionel Chiron and Marc-Andr’e on september 2015.
CUDA implementation by Laura Duciel on March 2019</p>
<p>associated publications
- Bray, F., Bouclon, J., Chiron, L., Witt, M., Delsuc, M.-A., &amp; Rolando, C. (2017).</p>
<blockquote>
<div><p>Nonuniform Sampling Acquisition of Two-Dimensional Fourier Transform Ion Cyclotron Resonance Mass Spectrometry for Increased Mass Resolution of Tandem Mass Spectrometry Precursor Ions.
Analytical Chemistry, acs.analchem.7b01850. <a class="reference external" href="http://doi.org/10.1021/acs.analchem.7b01850">http://doi.org/10.1021/acs.analchem.7b01850</a></p>
</div></blockquote>
<dl class="function">
<dt id="spike.Algo.sane.Cu_FastHankel_prod_mat_vec">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">Cu_FastHankel_prod_mat_vec</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">prod_vect</em>, <em class="sig-param">k=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#Cu_FastHankel_prod_mat_vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.Cu_FastHankel_prod_mat_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result
k =0 initializes cuda for gene_vect</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.Cu_FastHankel_prod_mat_vec_2dt">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">Cu_FastHankel_prod_mat_vec_2dt</code><span class="sig-paren">(</span><em class="sig-param">prod_vect</em>, <em class="sig-param">k</em>, <em class="sig-param">Q</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#Cu_FastHankel_prod_mat_vec_2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.Cu_FastHankel_prod_mat_vec_2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result
k =0 initializes cuda for gene_vect</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.Cu_Fast_Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">Cu_Fast_Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">Q</em>, <em class="sig-param">QH</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#Cu_Fast_Hankel2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.Cu_Fast_Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>returning to data from Q and QstarH
Based on FastHankel_prod_mat_vec.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.Cu_vec_mean">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">Cu_vec_mean</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#Cu_vec_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.Cu_vec_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector for calculating the mean from the sum on the antidiagonal.
data = vec_sum*vec_mean</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.FastHankel_prod_mat_mat">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">FastHankel_prod_mat_mat</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#FastHankel_prod_mat_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.FastHankel_prod_mat_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast Hankel structured matrix matrix product based on FastHankel_prod_mat_vec</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.FastHankel_prod_mat_vec">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">FastHankel_prod_mat_vec</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">prod_vect</em>, <em class="sig-param">k=0</em><span class="sig-paren">)</span><a class="headerlink" href="#spike.Algo.sane.FastHankel_prod_mat_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.Fast_Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">Fast_Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">Q</em>, <em class="sig-param">QH</em><span class="sig-paren">)</span><a class="headerlink" href="#spike.Algo.sane.Fast_Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>returning to data from Q and QstarH
Based on FastHankel_prod_mat_vec.</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.sane.OPTK">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">OPTK</code><span class="sig-paren">(</span><em class="sig-param">fid</em>, <em class="sig-param">orda</em>, <em class="sig-param">prec=0.9</em>, <em class="sig-param">debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#OPTK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.OPTK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for finding the best rank for classical sane.
The rank is calculated so as to permit the retrieving of the signal power at high enough level.
Passed parameters are the Fid “fid”, the estimated number of lines “estim_nbpeaks” and the order “orda”</p>
<dl class="method">
<dt id="spike.Algo.sane.OPTK.find_best_rank">
<code class="sig-name descname">find_best_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#OPTK.find_best_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.OPTK.find_best_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the optimal rank
optk : optimal rank</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane.OPTK.peaks1d">
<code class="sig-name descname">peaks1d</code><span class="sig-paren">(</span><em class="sig-param">fid</em>, <em class="sig-param">threshold=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#OPTK.peaks1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.OPTK.peaks1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts peaks from 1d from FID
Returns listpk[0]</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane.OPTK.separate_signal_from_noise">
<code class="sig-name descname">separate_signal_from_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#OPTK.separate_signal_from_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.OPTK.separate_signal_from_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal is separated from Noise and kept in self.spec
self.noiselev : level of the noise
self.estim_nbpeaks : estimation of the number of peaks in the spectrum</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane.OPTK.subspace_filling_with_rank">
<code class="sig-name descname">subspace_filling_with_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#OPTK.subspace_filling_with_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.OPTK.subspace_filling_with_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimation of the signal and noise subspace filling in function of the rank.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.SFastHankel_prod_mat_vec">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">SFastHankel_prod_mat_vec</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">prod_vect</em>, <em class="sig-param">k=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#SFastHankel_prod_mat_vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.SFastHankel_prod_mat_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.SFast_Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">SFast_Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">Q</em>, <em class="sig-param">QH</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#SFast_Hankel2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.SFast_Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>returning to data from Q and QstarH
Based on FastHankel_prod_mat_vec.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.cu_select">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">cu_select</code><span class="sig-paren">(</span><em class="sig-param">cuda_select</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#cu_select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.cu_select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.sane">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">sane</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">k</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">trick=True</em>, <em class="sig-param">optk=False</em>, <em class="sig-param">ktrick=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.sane" title="Permalink to this definition">¶</a></dt>
<dd><p>sane algorithm. Name stands for Support Selection for Noise Elimination.
From a data series return a denoised series denoised
data : the series to be denoised - a (normally complex) numpy buffer
k : the rank of the analysis
orda : is the order of the analysis</p>
<blockquote>
<div><p>internally, a Hankel matrix (M,N) is constructed, with M = orda and N = len(data)-orda+1
if None (default) orda = (len(data)+1)/2</p>
</div></blockquote>
<p>iterations : the number of time the operation should be repeated
optk : if set to True will calculate the rank giving the best recovery for an automatic estimated noise level. 
trick : permits to enhanced the denoising by using a cleaned signal as the projective space. “Support Selection”
ktrick : if a value is given, it permits to change the rank on the second pass.</p>
<blockquote>
<div><p>The idea is that for the first pass a rank large enough as to be used to compensate for the noise while
for the second pass a lower rank can be used.</p>
</div></blockquote>
<p>values are such that
orda &lt;= (len(data)+1)//2
k &lt; orda
N = len(data)-orda+1
Omega is (N x k)</p>
<p>Sane is based on the same idea than urQRd, however, there is a much clever selection of the basis on which the random projection is performed.
This allows a much better recovery of small signals buried into the noise, compared to urQRd.</p>
<p>the flags trick, optk, ktrick control the program
when all are false, sane folds back to urQRd algorithm.
Optimal is certainly trick = True, optk = True, ktrick = True  but not fully tested yet.</p>
<p>sane uses a new trick for performing a better denoising.
A rank a little above the number of peaks as to be given. 
this permit to make a filtering matrix containing the signal quasi only after a first pass.
On a second pass the full signal is projected on a new filtering subspace done from preceding denoising.
A higher number of iterations will decrease even more the smallest amplitudes. 
##########</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.saneCore">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">saneCore</code><span class="sig-paren">(</span><em class="sig-param">dd</em>, <em class="sig-param">data</em>, <em class="sig-param">Omega</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#saneCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.saneCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Core of sane algorithm</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.sane.sane_Tests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">sane_Tests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#sane_Tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.sane_Tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.Algo.sane.sane_Tests.test_sane">
<code class="sig-name descname">test_sane</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#sane_Tests.test_sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.sane_Tests.test_sane" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sane without trick and 1 iteration.</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane.sane_Tests.test_sane_iter_trick">
<code class="sig-name descname">test_sane_iter_trick</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#sane_Tests.test_sane_iter_trick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.sane_Tests.test_sane_iter_trick" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sane with trick and varying the number of iterations.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.test_sane">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">test_sane</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">noise=200.0</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">noisetype='additive'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#test_sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.test_sane" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of Sane on a synthetic data-set ===============</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.test_sane_gene">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">test_sane_gene</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">nbpeaks=2</em>, <em class="sig-param">noise=50.0</em>, <em class="sig-param">noisetype='additive'</em>, <em class="sig-param">nb_iterat=1</em>, <em class="sig-param">trick=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#test_sane_gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.test_sane_gene" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of sane on a synthetic data-set ===============</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane.vec_mean">
<code class="sig-prename descclassname">spike.Algo.sane.</code><code class="sig-name descname">vec_mean</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane.html#vec_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane.vec_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector for calculating the mean from the sum on the antidiagonal.
data = vec_sum*vec_mean</p>
</dd></dl>

</div>
<div class="section" id="module-spike.Algo.sane_old">
<span id="spike-algo-sane-old-module"></span><h2>spike.Algo.sane_old module<a class="headerlink" href="#module-spike.Algo.sane_old" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sane-py">
<h3>sane.py<a class="headerlink" href="#sane-py" title="Permalink to this headline">¶</a></h3>
<p>Algorithm for denoising time series, named sane (standing for “Support Selection for Noise Elimination”)</p>
<p>main function is 
sane(data, rank)
data : the series to be denoised
rank : the rank of the analysis</p>
<p>Copyright (c) 2015 IGBMC. All rights reserved.
Marc-Andr’e Delsuc &lt;<a class="reference external" href="mailto:madelsuc&#37;&#52;&#48;unistra&#46;fr">madelsuc<span>&#64;</span>unistra<span>&#46;</span>fr</a>&gt;
Lionel Chiron &lt;<a class="reference external" href="mailto:lionel&#46;chiron&#37;&#52;&#48;gmail&#46;com">lionel<span>&#46;</span>chiron<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This software is a computer program whose purpose is to compute sane denoising.</p>
<p>This software is governed by the CeCILL  license under French law and
abiding by the rules of distribution of free software.  You can  use, 
modify and/ or redistribute the software under the terms of the CeCILL
license as circulated by CEA, CNRS and INRIA at the following URL
“<a class="reference external" href="http://www.cecill.info">http://www.cecill.info</a>”.</p>
<p>As a counterpart to the access to the source code and  rights to copy,
modify and redistribute granted by the license, users are provided only
with a limited warranty  and the software’s author,  the holder of the
economic rights,  and the successive licensors  have only  limited
liability.</p>
<p>In this respect, the user’s attention is drawn to the risks associated
with loading,  using,  modifying and/or developing or reproducing the
software by the user in light of its specific status of free software,
that may mean  that it is complicated to manipulate,  and  that  also
therefore means  that it is reserved for developers  and  experienced
professionals having in-depth computer knowledge. Users are therefore
encouraged to load and test the software’s suitability as regards their
requirements in conditions enabling the security of their systems and/or 
data to be ensured and,  more generally, to use and operate it in the 
same conditions as regards security.</p>
<p>The fact that you are presently reading this means that you have had
knowledge of the CeCILL license and that you accept its terms.</p>
<p>First Created by Lionel Chiron and Marc-Andr’e on september 2015.</p>
<p>associated publications
- Bray, F., Bouclon, J., Chiron, L., Witt, M., Delsuc, M.-A., &amp; Rolando, C. (2017).</p>
<blockquote>
<div><p>Nonuniform Sampling Acquisition of Two-Dimensional Fourier Transform Ion Cyclotron Resonance Mass Spectrometry for Increased Mass Resolution of Tandem Mass Spectrometry Precursor Ions.
Analytical Chemistry, acs.analchem.7b01850. <a class="reference external" href="http://doi.org/10.1021/acs.analchem.7b01850">http://doi.org/10.1021/acs.analchem.7b01850</a></p>
</div></blockquote>
<dl class="function">
<dt id="spike.Algo.sane_old.FastHankel_prod_mat_mat">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">FastHankel_prod_mat_mat</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#FastHankel_prod_mat_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.FastHankel_prod_mat_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast Hankel structured matrix matrix product based on FastHankel_prod_mat_vec</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.FastHankel_prod_mat_vec">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">FastHankel_prod_mat_vec</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">prod_vect</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#FastHankel_prod_mat_vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.FastHankel_prod_mat_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.Fast_Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">Fast_Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">Q</em>, <em class="sig-param">QH</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#Fast_Hankel2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.Fast_Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>returning to data from Q and QstarH
Based on FastHankel_prod_mat_vec.</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.sane_old.OPTK">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">OPTK</code><span class="sig-paren">(</span><em class="sig-param">fid</em>, <em class="sig-param">orda</em>, <em class="sig-param">prec=0.9</em>, <em class="sig-param">debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#OPTK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.OPTK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for finding the best rank for classical sane.
The rank is calculated so as to permit the retrieving of the signal power at high enough level.
Passed parameters are the Fid “fid”, the estimated number of lines “estim_nbpeaks” and the order “orda”</p>
<dl class="method">
<dt id="spike.Algo.sane_old.OPTK.find_best_rank">
<code class="sig-name descname">find_best_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#OPTK.find_best_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.OPTK.find_best_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the optimal rank
optk : optimal rank</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane_old.OPTK.peaks1d">
<code class="sig-name descname">peaks1d</code><span class="sig-paren">(</span><em class="sig-param">fid</em>, <em class="sig-param">threshold=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#OPTK.peaks1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.OPTK.peaks1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts peaks from 1d from FID
Returns listpk[0]</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane_old.OPTK.separate_signal_from_noise">
<code class="sig-name descname">separate_signal_from_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#OPTK.separate_signal_from_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.OPTK.separate_signal_from_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal is separated from Noise and kept in self.spec
self.noiselev : level of the noise
self.estim_nbpeaks : estimation of the number of peaks in the spectrum</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane_old.OPTK.subspace_filling_with_rank">
<code class="sig-name descname">subspace_filling_with_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#OPTK.subspace_filling_with_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.OPTK.subspace_filling_with_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimation of the signal and noise subspace filling in function of the rank.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.sane">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">sane</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">k</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">trick=True</em>, <em class="sig-param">optk=False</em>, <em class="sig-param">ktrick=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.sane" title="Permalink to this definition">¶</a></dt>
<dd><p>sane algorithm. Name stands for Support Selection for Noise Elimination.
From a data series return a denoised series denoised
data : the series to be denoised - a (normally complex) numpy buffer
k : the rank of the analysis
orda : is the order of the analysis</p>
<blockquote>
<div><p>internally, a Hankel matrix (M,N) is constructed, with M = orda and N = len(data)-orda+1
if None (default) orda = (len(data)+1)/2</p>
</div></blockquote>
<p>iterations : the number of time the operation should be repeated
optk : if set to True will calculate the rank giving the best recovery for an automatic estimated noise level. 
trick : permits to enhanced the denoising by using a cleaned signal as the projective space. “Support Selection”
ktrick : if a value is given, it permits to change the rank on the second pass.</p>
<blockquote>
<div><p>The idea is that for the first pass a rank large enough as to be used to compensate for the noise while
for the second pass a lower rank can be used.</p>
</div></blockquote>
<p>values are such that
orda &lt;= (len(data)+1)//2
k &lt; orda
N = len(data)-orda+1
Omega is (N x k)</p>
<p>Sane is based on the same idea than urQRd, however, there is a much clever selection of the basis on which the random projection is performed.
This allows a much better recovery of small signals buried into the noise, compared to urQRd.</p>
<p>the flags trick, optk, ktrick control the program
when all are false, sane folds back to urQRd algorithm.
Optimal is certainly trick = True, optk = True, ktrick = True  but not fully tested yet.</p>
<p>sane uses a new trick for performing a better denoising.
A rank a little above the number of peaks as to be given. 
this permit to make a filtering matrix containing the signal quasi only after a first pass.
On a second pass the full signal is projected on a new filtering subspace done from preceding denoising.
A higher number of iterations will decrease even more the smallest amplitudes. 
##########</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.saneCore">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">saneCore</code><span class="sig-paren">(</span><em class="sig-param">dd</em>, <em class="sig-param">data</em>, <em class="sig-param">Omega</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#saneCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.saneCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Core of sane algorithm</p>
</dd></dl>

<dl class="class">
<dt id="spike.Algo.sane_old.sane_Tests">
<em class="property">class </em><code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">sane_Tests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#sane_Tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.sane_Tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.Algo.sane_old.sane_Tests.test_sane">
<code class="sig-name descname">test_sane</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#sane_Tests.test_sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.sane_Tests.test_sane" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sane without trick and 1 iteration.</p>
</dd></dl>

<dl class="method">
<dt id="spike.Algo.sane_old.sane_Tests.test_sane_iter_trick">
<code class="sig-name descname">test_sane_iter_trick</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#sane_Tests.test_sane_iter_trick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.sane_Tests.test_sane_iter_trick" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sane with trick and varying the number of iterations.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.test_sane">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">test_sane</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">noise=200.0</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">noisetype='additive'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#test_sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.test_sane" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of Sane on a synthetic data-set ===============</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.test_sane_gene">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">test_sane_gene</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">nbpeaks=2</em>, <em class="sig-param">noise=50.0</em>, <em class="sig-param">noisetype='additive'</em>, <em class="sig-param">nb_iterat=1</em>, <em class="sig-param">trick=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#test_sane_gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.test_sane_gene" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of sane on a synthetic data-set ===============</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.sane_old.vec_mean">
<code class="sig-prename descclassname">spike.Algo.sane_old.</code><code class="sig-name descname">vec_mean</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/sane_old.html#vec_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.sane_old.vec_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector for calculating the mean from the sum on the antidiagonal.
data = vec_sum*vec_mean</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-spike.Algo.savitzky_golay">
<span id="spike-algo-savitzky-golay-module"></span><h2>spike.Algo.savitzky_golay module<a class="headerlink" href="#module-spike.Algo.savitzky_golay" title="Permalink to this headline">¶</a></h2>
<p>Smooth (and optionally differentiate) data with a Savitzky-Golay filter.</p>
<dl class="simple">
<dt>CODE from <a class="reference external" href="http://www.scipy.org/Cookbook/SavitzkyGolay">http://www.scipy.org/Cookbook/SavitzkyGolay</a></dt><dd><p>adapted by M-A Delsuc, august 2011</p>
</dd>
</dl>
<dl class="function">
<dt id="spike.Algo.savitzky_golay.savitzky_golay">
<code class="sig-prename descclassname">spike.Algo.savitzky_golay.</code><code class="sig-name descname">savitzky_golay</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">window_size</em>, <em class="sig-param">order</em>, <em class="sig-param">deriv=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/savitzky_golay.html#savitzky_golay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.savitzky_golay.savitzky_golay" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth (and optionally differentiate) data with a Savitzky-Golay filter.
The Savitzky-Golay filter removes high frequency noise from data.
It has the advantage of preserving the original shape and
features of the signal better than other types of filtering
approaches, such as moving averages techniques.
Parameters
———-
y : array_like, shape (N,)</p>
<blockquote>
<div><p>the values of the time history of the signal.</p>
</div></blockquote>
<dl class="simple">
<dt>window_size<span class="classifier">int</span></dt><dd><p>the length of the window. Must be an odd integer number.</p>
</dd>
<dt>order<span class="classifier">int</span></dt><dd><p>the order of the polynomial used in the filtering.
Must be less than <cite>window_size</cite> - 1.</p>
</dd>
<dt>deriv: int</dt><dd><p>the order of the derivative to compute (default = 0 means only smoothing)</p>
</dd>
</dl>
<dl class="simple">
<dt>ys<span class="classifier">ndarray, shape (N)</span></dt><dd><p>the smoothed signal (or it’s n-th derivative).</p>
</dd>
</dl>
<p>The Savitzky-Golay is a type of low-pass filter, particularly
suited for smoothing noisy data. The main idea behind this
approach is to make for each point a least-square fit with a
polynomial of high order over a odd-sized window centered at
the point.
Examples
——–
t = np.linspace(-4, 4, 500)
y = np.exp( -t**2 ) + np.random.normal(0, 0.05, t.shape)
ysg = savitzky_golay(y, window_size=31, order=4)
import matplotlib.pyplot as plt
plt.plot(t, y, label=’Noisy signal’)
plt.plot(t, np.exp(-t**2), ‘k’, lw=1.5, label=’Original signal’)
plt.plot(t, ysg, ‘r’, label=’Filtered signal’)
plt.legend()
plt.show()
References
———-
.. [1] A. Savitzky, M. J. E. Golay, Smoothing and Differentiation of</p>
<blockquote>
<div><p>Data by Simplified Least Squares Procedures. Analytical
Chemistry, 1964, 36 (8), pp 1627-1639.</p>
</div></blockquote>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets">2</span></dt>
<dd><p>Numerical Recipes 3rd Edition: The Art of Scientific Computing
W.H. Press, S.A. Teukolsky, W.T. Vetterling, B.P. Flannery
Cambridge University Press ISBN-13: 9780521880688</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.savitzky_golay.savitzky_golay2D">
<code class="sig-prename descclassname">spike.Algo.savitzky_golay.</code><code class="sig-name descname">savitzky_golay2D</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">window_size</em>, <em class="sig-param">order</em>, <em class="sig-param">derivative=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/savitzky_golay.html#savitzky_golay2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.savitzky_golay.savitzky_golay2D" title="Permalink to this definition">¶</a></dt>
<dd><p>realises Savitzky-Golay smoothing in 2D.
see savitzky_golay() for more information</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.savitzky_golay.sgolay_coef">
<code class="sig-prename descclassname">spike.Algo.savitzky_golay.</code><code class="sig-name descname">sgolay_coef</code><span class="sig-paren">(</span><em class="sig-param">window_size</em>, <em class="sig-param">order</em>, <em class="sig-param">deriv=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/savitzky_golay.html#sgolay_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.savitzky_golay.sgolay_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>compute savistki-golay coefficients</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.savitzky_golay.sgolay_comp">
<code class="sig-prename descclassname">spike.Algo.savitzky_golay.</code><code class="sig-name descname">sgolay_comp</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">m</em>, <em class="sig-param">window_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/savitzky_golay.html#sgolay_comp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.savitzky_golay.sgolay_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>apply savistki-golay filter on y from previously computed savistki-golay coefficients : m</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.savitzky_golay.test_sg">
<code class="sig-prename descclassname">spike.Algo.savitzky_golay.</code><code class="sig-name descname">test_sg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/savitzky_golay.html#test_sg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.savitzky_golay.test_sg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-spike.Algo.urQRd">
<span id="spike-algo-urqrd-module"></span><h2>spike.Algo.urQRd module<a class="headerlink" href="#module-spike.Algo.urQRd" title="Permalink to this headline">¶</a></h2>
<div class="section" id="urqrd-py">
<h3>urQRd.py<a class="headerlink" href="#urqrd-py" title="Permalink to this headline">¶</a></h3>
<p>Algorithm for denoising time series, named urQRd (standing for “uncoiled random QR denoising”)
main function is 
urQRd(data, rank)
data : the series to be denoised
rank : the rank of the analysis</p>
<p>Copyright (c) 2013 IGBMC. All rights reserved.</p>
<p>Marc-Andr’e Delsuc &lt;<a class="reference external" href="mailto:madelsuc&#37;&#52;&#48;unistra&#46;fr">madelsuc<span>&#64;</span>unistra<span>&#46;</span>fr</a>&gt;
Lionel Chiron &lt;<a class="reference external" href="mailto:lionel&#46;chiron&#37;&#52;&#48;gmail&#46;com">lionel<span>&#46;</span>chiron<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This software is a computer program whose purpose is to compute urQRd denoising.</p>
<p>This software is governed by the CeCILL  license under French law and
abiding by the rules of distribution of free software.  You can  use, 
modify and/ or redistribute the software under the terms of the CeCILL
license as circulated by CEA, CNRS and INRIA at the following URL
“<a class="reference external" href="http://www.cecill.info">http://www.cecill.info</a>”.</p>
<p>As a counterpart to the access to the source code and  rights to copy,
modify and redistribute granted by the license, users are provided only
with a limited warranty  and the software’s author,  the holder of the
economic rights,  and the successive licensors  have only  limited
liability.</p>
<p>In this respect, the user’s attention is drawn to the risks associated
with loading,  using,  modifying and/or developing or reproducing the
software by the user in light of its specific status of free software,
that may mean  that it is complicated to manipulate,  and  that  also
therefore means  that it is reserved for developers  and  experienced
professionals having in-depth computer knowledge. Users are therefore
encouraged to load and test the software’s suitability as regards their
requirements in conditions enabling the security of their systems and/or 
data to be ensured and,  more generally, to use and operate it in the 
same conditions as regards security.</p>
<p>The fact that you are presently reading this means that you have had
knowledge of the CeCILL license and that you accept its terms.</p>
<p>Created by Lionel Chiron and Marc-Andr’e on 2013-10-13.</p>
<p>version 2.0 
28/oct/2013</p>
<dl class="function">
<dt id="spike.Algo.urQRd.FastHankel_prod_mat_mat">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">FastHankel_prod_mat_mat</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#FastHankel_prod_mat_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.FastHankel_prod_mat_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast Hankel structured matrix matrix product based on FastHankel_prod_mat_vec</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.FastHankel_prod_mat_vec">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">FastHankel_prod_mat_vec</code><span class="sig-paren">(</span><em class="sig-param">gene_vect</em>, <em class="sig-param">prod_vect</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#FastHankel_prod_mat_vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.FastHankel_prod_mat_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute product of Hankel matrix (gene_vect)  by vector prod_vect.
H is not computed
M is the length of the result</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.Fast_Hankel2dt">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">Fast_Hankel2dt</code><span class="sig-paren">(</span><em class="sig-param">Q</em>, <em class="sig-param">QH</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#Fast_Hankel2dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.Fast_Hankel2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>returning to data from Q and QstarH
Based on FastHankel_prod_mat_vec.</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.test_urQRd">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">test_urQRd</code><span class="sig-paren">(</span><em class="sig-param">lendata=10000</em>, <em class="sig-param">rank=100</em>, <em class="sig-param">orda=4000</em>, <em class="sig-param">noise=200.0</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">noisetype='additive'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#test_urQRd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.test_urQRd" title="Permalink to this definition">¶</a></dt>
<dd><p>============== example of use of urQRd on a synthetic data-set ===============</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.urQRd">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">urQRd</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">k</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#urQRd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.urQRd" title="Permalink to this definition">¶</a></dt>
<dd><p>urQRd algorithm. Name stands for uncoiled random QR denoising.
From a data series return a denoised series denoised
data : the series to be denoised - a (normally complex) numpy buffer
k : the rank of the analysis
orda : is the order of the analysis</p>
<blockquote>
<div><p>internally, a Hankel matrix (M,N) is constructed, with M = orda and N = len(data)-orda+1
if None (default) orda = (len(data)+1)/2</p>
</div></blockquote>
<p>iterations : the number of time the operation should be repeated</p>
<p>values are such that
orda &lt;= (len(data)+1)/2
k &lt; orda
N = len(data)-orda+1
Omega is (N x k)</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.urQRdCore">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">urQRdCore</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">orda</em>, <em class="sig-param">Omega</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#urQRdCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.urQRdCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Core of urQRd algorithm</p>
</dd></dl>

<dl class="function">
<dt id="spike.Algo.urQRd.vec_mean">
<code class="sig-prename descclassname">spike.Algo.urQRd.</code><code class="sig-name descname">vec_mean</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo/urQRd.html#vec_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.urQRd.vec_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector for calculating the mean from the sum on the antidiagonal.
data = vec_sum*vec_mean</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-spike.Algo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spike.Algo" title="Permalink to this headline">¶</a></h2>
<p>Created by Marc-André on 2011-03-20.
Copyright (c) 2011 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.Algo.main">
<code class="sig-prename descclassname">spike.Algo.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/Algo.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.Algo.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">spike</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Readme.html">What is SPIKE ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#how-do-i-get-spike">How do I get SPIKE ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#developing-for-spike">Developing for SPIKE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Doc.html">First contact SPIKE</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="spike.html">spike package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="spike.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">spike.Algo package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Display.html">spike.Display package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.File.html">spike.File package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Interactive.html">spike.Interactive package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Miscellaneous.html">spike.Miscellaneous package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.plugins.html">spike.plugins package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.util.html">spike.util package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.v1.html">spike.v1 package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.FTICR">spike.FTICR module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.FTMS">spike.FTMS module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NMR">spike.NMR module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKConfigParser">spike.NPKConfigParser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKData">spike.NPKData module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKError">spike.NPKError module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.Orbitrap">spike.Orbitrap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.Tests">spike.Tests module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.dev_setup">spike.dev_setup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.processing">spike.processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.version">spike.version module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.version_rev">spike.version_rev module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">SPIKE Relase Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html">SPIKE License</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html#secondary-licenses">Secondary Licenses</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="spike.html">spike package</a><ul>
      <li>Previous: <a href="spike.html" title="previous chapter">spike package</a></li>
      <li>Next: <a href="spike.Display.html" title="next chapter">spike.Display package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2010-2019, IGBMC and others.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/spike.Algo.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>