
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>spike.plugins package &#8212; spike 0.99.21-490 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="spike.util package" href="spike.util.html" />
    <link rel="prev" title="spike.Miscellaneous package" href="spike.Miscellaneous.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="spike-plugins-package">
<h1>spike.plugins package<a class="headerlink" href="#spike-plugins-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spike.plugins.Bruker_NMR_FT">
<span id="spike-plugins-bruker-nmr-ft-module"></span><h2>spike.plugins.Bruker_NMR_FT module<a class="headerlink" href="#module-spike.plugins.Bruker_NMR_FT" title="Permalink to this headline">¶</a></h2>
<p>This plugin implement the set of Fourier Transform used for NMR</p>
<p>and some other related utilities
commands starting with <a href="#id9"><span class="problematic" id="id10">bk_</span></a> emulates (kind of) the topspin commands</p>
<p>MAD September 2015</p>
<dl class="class">
<dt id="spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">Bruker_NMR_FT</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#Bruker_NMR_FT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT.test_1D">
<code class="sig-name descname">test_1D</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#Bruker_NMR_FT.test_1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT.test_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Test mostly syntax</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT.test_2D">
<code class="sig-name descname">test_2D</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#Bruker_NMR_FT.test_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.Bruker_NMR_FT.test_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Test mostly syntax</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.bruker_corr">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">bruker_corr</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#bruker_corr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.bruker_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a correction on the spectrum for the time offset in the FID.
time offset is stored in the axis property zerotime</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.bruker_proc_phase">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">bruker_proc_phase</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#bruker_proc_phase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.bruker_proc_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a correction on the spectrum for the time offset in the FID and from proc file parameters.</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.check_cpx">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">check_cpx</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#check_cpx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.check_cpx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.check_real">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">check_real</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#check_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.check_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.conv_n_p">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">conv_n_p</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#conv_n_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.conv_n_p" title="Permalink to this definition">¶</a></dt>
<dd><p>realises the n+p to SH conversion</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ftF1">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ftF1</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ftF1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ftF1" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates Bruker ft of a 2D in F1 depending on FnMode</p>
<p>None    0
QF      1
QSEQ    2
TPPI    3
States  4
States-TPPI 5
Echo-AntiEcho   6</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ftF2">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ftF2</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ftF2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ftF2" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates Bruker ft of a 2D in F1 depending on FnMode</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_n_p">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_n_p</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis='F1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_n_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_n_p" title="Permalink to this definition">¶</a></dt>
<dd><p>F1-Fourier transform for N+P (echo/antiecho) 2D</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_phase_modu">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_phase_modu</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis='F1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_phase_modu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_phase_modu" title="Permalink to this definition">¶</a></dt>
<dd><p>F1-Fourier transform for phase-modulated 2D</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_seq">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_seq</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>performs the fourier transform of a data-set acquired on a Bruker in simultaneous mode
Processing is performed only along the F2 (F3) axis if in 2D (3D)</p>
<p>(Bruker QSIM mode)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_sh">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_sh</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis='F1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_sh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_sh" title="Permalink to this definition">¶</a></dt>
<dd><p>States-Haberkorn F1 Fourier transform</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_sh_tppi">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_sh_tppi</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis='F1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_sh_tppi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_sh_tppi" title="Permalink to this definition">¶</a></dt>
<dd><p>States-Haberkorn / TPPI F1 Fourier Transform</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_sim">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_sim</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_sim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>performs the fourier transform of a data-set acquired on a Bruker in
simultaneous mode
Processing is performed only along the F2 (F3) axis if in 2D (3D)</p>
<p>(Bruker QSIM mode)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.ft_tppi">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">ft_tppi</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis='F1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#ft_tppi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.ft_tppi" title="Permalink to this definition">¶</a></dt>
<dd><p>TPPI F1 Fourier transform</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.wdw">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">wdw</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#wdw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.wdw" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates Bruker window function</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.xf1">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">xf1</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#xf1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.xf1" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates xf1 command from topspin</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.xf2">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">xf2</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#xf2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.xf2" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates xf2 command from topspin</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bruker_NMR_FT.xfb">
<code class="sig-prename descclassname">spike.plugins.Bruker_NMR_FT.</code><code class="sig-name descname">xfb</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bruker_NMR_FT.html#xfb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bruker_NMR_FT.xfb" title="Permalink to this definition">¶</a></dt>
<dd><p>emulates xfb command from topspin</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.Bucketing">
<span id="spike-plugins-bucketing-module"></span><h2>spike.plugins.Bucketing module<a class="headerlink" href="#module-spike.plugins.Bucketing" title="Permalink to this headline">¶</a></h2>
<p>A set of tools for computing bucketing for 1D and 2D NMR spectra</p>
<p>First version by DELSUC Marc-André on 2015-09-06.
extended in 2017</p>
<p>This plugin implements the bucketing routines developped in the work</p>
<p><strong>Automatic differential analysis of NMR experiments in complex samples</strong>
Laure Margueritte, Petar Markov, Lionel Chiron, Jean-Philippe Starck, Catherine Vonthron-Sénécheau, Mélanie Bourjot, and Marc-André Delsuc
<em>Magn. Reson. Chem.</em>, (2018) <strong>80</strong> (5), 1387. <a class="reference external" href="http://doi.org/10.1002/mrc.4683">http://doi.org/10.1002/mrc.4683</a></p>
<p>It implements 1D and 2D bucketing
each bucket has a constant progammable size in ppm,
for each buckets, following properties are computes:</p>
<blockquote>
<div><p>center, normalized area, max, min, standard deviation, bucket_size</p>
</div></blockquote>
<p>The results are printed in cvs format either on screen or into a file</p>
<dl class="class">
<dt id="spike.plugins.Bucketing.BucketingTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Bucketing.</code><code class="sig-name descname">BucketingTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bucketing.html#BucketingTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bucketing.BucketingTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.Bucketing.BucketingTests.announce">
<code class="sig-name descname">announce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bucketing.html#BucketingTests.announce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bucketing.BucketingTests.announce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Bucketing.BucketingTests.setUp">
<code class="sig-name descname">setUp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bucketing.html#BucketingTests.setUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bucketing.BucketingTests.setUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bucketing.bucket1d">
<code class="sig-prename descclassname">spike.plugins.Bucketing.</code><code class="sig-name descname">bucket1d</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">zoom=(0.5</em>, <em class="sig-param">9.5)</em>, <em class="sig-param">bsize=0.04</em>, <em class="sig-param">pp=False</em>, <em class="sig-param">sk=False</em>, <em class="sig-param">thresh=10</em>, <em class="sig-param">file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bucketing.html#bucket1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bucketing.bucket1d" title="Permalink to this definition">¶</a></dt>
<dd><p>This tool permits to realize a bucket integration from the current 1D data-set.
You will have to give  (all spectral values are in ppm)</p>
<blockquote>
<div><ul class="simple">
<li><p>zoom (low,high),  : the starting and ending ppm of the integration zone in the spectrum</p></li>
<li><p>bsize: the size of the bucket</p></li>
<li><dl class="simple">
<dt>pp: if True, the number of peaks in the bucket is also added</dt><dd><ul>
<li><p>peaks are detected if intensity is larger that thresh*noise</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>sk: if True, skewness and kurtosis computed for each bucket</p></li>
<li><p>file: the filename to which the result is written</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>For a better bucket integration, you should be careful that :</dt><dd><ul class="simple">
<li><p>the bucket size is not too small, size is better than number !</p></li>
<li><p>the baseline correction has been carefully done</p></li>
<li><p>the spectral window is correctly determined to encompass the meaningfull spectral zone.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Bucketing.bucket2d">
<code class="sig-prename descclassname">spike.plugins.Bucketing.</code><code class="sig-name descname">bucket2d</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">zoom=((0.5</em>, <em class="sig-param">9.5)</em>, <em class="sig-param">(0.5</em>, <em class="sig-param">9.5))</em>, <em class="sig-param">bsize=(0.1</em>, <em class="sig-param">0.1)</em>, <em class="sig-param">pp=False</em>, <em class="sig-param">sk=False</em>, <em class="sig-param">thresh=10</em>, <em class="sig-param">file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Bucketing.html#bucket2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Bucketing.bucket2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This tool permits to realize a bucket integration from the current 2D data-set.
You will have to give the following values:  (all spectral values are in ppm)</p>
<blockquote>
<div><ul class="simple">
<li><p>zoom (F1limits, F2limits),  : the starting and ending ppm of the integration zone in the spectrum</p></li>
<li><p>bsize (F1,F2): the sizes of the bucket</p></li>
<li><dl class="simple">
<dt>pp: if True, the number of peaks in the bucket is also added</dt><dd><ul>
<li><p>peaks are detected if intensity is larger that thresh*noise</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>sk: if True, skewness and kurtosis computed for each bucket</p></li>
<li><p>file: the filename to which the result is written</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>For a better bucket integration, you should be careful that :</dt><dd><ul class="simple">
<li><p>the bucket size is not too small, size is better than number !</p></li>
<li><p>the baseline correction has been carefully done</p></li>
<li><p>the spectral window is correctly determined to encompass the meaningfull spectral zone.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.FTMS_calib">
<span id="spike-plugins-ftms-calib-module"></span><h2>spike.plugins.FTMS_calib module<a class="headerlink" href="#module-spike.plugins.FTMS_calib" title="Permalink to this headline">¶</a></h2>
<p>A utility for calibration of MS experiments</p>
<p>based on a list of experimentally measured m/z and theoretical ones
The method will reduce the difference between lists.</p>
<dl class="simple">
<dt>adds ppm() ppm_error() and display_icalib() methods to the FTMSAxis object</dt><dd><p>and imzmeas and mzref attributes</p>
</dd>
</dl>
<p>Adds the following methods():
to FTICR datasets</p>
<blockquote>
<div><p>set_calib(mzmeas, mzref, axis=1)
calib(axis=1, method=’l1’, verbose=False)
display_calib(axis=1, compare=False)</p>
</div></blockquote>
<dl class="simple">
<dt>to FTICR axes</dt><dd><p>display_icalib(xref, mzref, symbol=’bo’)
ppm_error(xref, mzref)
ppm(xref, mzref)
display_icalib(xref, mzref, symbol=’bo’)</p>
</dd>
<dt>and the following attributes:</dt><dd><p>RefAxis: a backup FTICRAxis, used to store the previous calibration</p>
</dd>
<dt>to FTICR axes</dt><dd><p>mzref : list of m/z of reference values
imzmeas : list of pea indices of reference peaks (to be match with mzref)</p>
</dd>
</dl>
<dl class="function">
<dt id="spike.plugins.FTMS_calib.calib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">calib</code><span class="sig-paren">(</span><em class="sig-param">npk</em>, <em class="sig-param">axis=1</em>, <em class="sig-param">method='l1'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.calib" title="Permalink to this definition">¶</a></dt>
<dd><p>the current FTMS experiment is recalibrated optimaly 
along its axis ‘axis’ (usefull only in 2D) using parameters provided with set_calib()
uses the current (2 or 3 parameters) calibration</p>
<p>method is either ‘l1’ (robust) or ‘l2’ (classic)</p>
<p>The current calibration is copied to a new unused axis called RefAxis</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.calib_loadref">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">calib_loadref</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">fname</em>, <em class="sig-param">recalibrate=False</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#calib_loadref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.calib_loadref" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a <a href="#id1"><span class="problematic" id="id2">*</span></a>.ref Bruker file holding a set of calibrating values for MS
with the following format:</p>
<blockquote>
<div><p># comments</p>
<p># TuneMixPos         m/z           charge
C5H12O2N             118.086255    +1
C6H19O6N3P3          322.048121    +1
…</p>
</div></blockquote>
<p>and associate the reference list to the experiment, preparing for recalibration</p>
<p>if recalibrate is True, values will be recomputed, with values interpreted as formula or peptides (A letter code)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.computes_index">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">computes_index</code><span class="sig-paren">(</span><em class="sig-param">meas</em>, <em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#computes_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.computes_index" title="Permalink to this definition">¶</a></dt>
<dd><p>locates in index measured values</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.display_calib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">display_calib</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">axis=1</em>, <em class="sig-param">compare=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#display_calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.display_calib" title="Permalink to this definition">¶</a></dt>
<dd><p>generates a plot of the current calibration
if compare is True, will try to draw the previous calibration curve along with the current one</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.distcalib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">distcalib</code><span class="sig-paren">(</span><em class="sig-param">param</em>, <em class="sig-param">xref</em>, <em class="sig-param">mzref</em>, <em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#distcalib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.distcalib" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the residual to minimize when calibrating
basically a wrapper around axis.ppm_error</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.icalib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">icalib</code><span class="sig-paren">(</span><em class="sig-param">npk</em>, <em class="sig-param">xind</em>, <em class="sig-param">ref</em>, <em class="sig-param">axis=1</em>, <em class="sig-param">method='l1'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#icalib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.icalib" title="Permalink to this definition">¶</a></dt>
<dd><p>given a list of location in index ‘xind’ and of theoretical values ‘ref’
the current FTMS experiment is recalibrated optimatly along its axis ‘axis’ (usefull only in 2D)
uses the current (2 or 3 parameters) calibration</p>
<p>method is either ‘l1’ (robust) or ‘l2’ (classic)</p>
<p>The current calibration is copied to a new unused axis called RefAxis</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.l1calib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">l1calib</code><span class="sig-paren">(</span><em class="sig-param">param</em>, <em class="sig-param">xref</em>, <em class="sig-param">mzref</em>, <em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#l1calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.l1calib" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the sum of residual to minimize when calibrating
basically a wrapper around axis.ppm</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.mzcalib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">mzcalib</code><span class="sig-paren">(</span><em class="sig-param">xind</em>, <em class="sig-param">ref</em>, <em class="sig-param">axis</em>, <em class="sig-param">method='l1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#mzcalib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.mzcalib" title="Permalink to this definition">¶</a></dt>
<dd><p>fit axis parameters so that points located at xind be closest to ref values
fits on two parameters if the 3rd (ML3 ie axis.calibC) is zero
method = l2      uses levenberg-marqtart on l2 norm : classical method
method = l1      uses powell on l1 norm : robust method</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.ppm">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">ppm</code><span class="sig-paren">(</span><em class="sig-param">axis</em>, <em class="sig-param">xref</em>, <em class="sig-param">mzref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#ppm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.ppm" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the mean error in ppm from a array of positions (xref) and the theoretical m/z (mzref)
uses l1 norm !
xref : array of point coordinates of the reference points
mzref: array of reference m/z</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.ppm_error">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">ppm_error</code><span class="sig-paren">(</span><em class="sig-param">axis</em>, <em class="sig-param">xref</em>, <em class="sig-param">mzref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#ppm_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.ppm_error" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the error from a array of positions (xref) and the theoretical m/z (mzref)
returns an array with errors in ppm
xref : array of point coordinates of the reference points
mzref: array of reference m/z</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.read_ref">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">read_ref</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#read_ref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.read_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a <a href="#id3"><span class="problematic" id="id4">*</span></a>.ref Bruker file holding a set of calibrating values for MS
returns a referencing dictionary {‘FORMULA’:(value,charge), … }</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.recalibrate">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">recalibrate</code><span class="sig-paren">(</span><em class="sig-param">calib</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#recalibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.recalibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>a referencing dictionary {‘FORMULA’:value, … }</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.FTMS_calib.set_calib">
<code class="sig-prename descclassname">spike.plugins.FTMS_calib.</code><code class="sig-name descname">set_calib</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">mzmeas</em>, <em class="sig-param">mzref</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/FTMS_calib.html#set_calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.FTMS_calib.set_calib" title="Permalink to this definition">¶</a></dt>
<dd><p>preset parameters for mass calibration
mzref : list of reference m/z of calibrants
mzmeas : list of measured m/z of calibrants</p>
<p>axis is the axis to be calibrated, defaut is 1</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.Fitter">
<span id="spike-plugins-fitter-module"></span><h2>spike.plugins.Fitter module<a class="headerlink" href="#module-spike.plugins.Fitter" title="Permalink to this headline">¶</a></h2>
<p>set of function for Peak fitter</p>
<p>Very First functionnal - Not finished !</p>
<p>reqruies the Peaks plugin installed</p>
<p>July 2016 M-A Delsuc</p>
<dl class="class">
<dt id="spike.plugins.Fitter.FitTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">FitTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#FitTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.FitTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<p>Test for fitter, assumes Peaks plugin is loaded</p>
<dl class="method">
<dt id="spike.plugins.Fitter.FitTests.test_fit1d">
<code class="sig-name descname">test_fit1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#FitTests.test_fit1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.FitTests.test_fit1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.Lor">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">Lor</code><span class="sig-paren">(</span><em class="sig-param">Amp</em>, <em class="sig-param">Pos</em>, <em class="sig-param">Width</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#Lor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.Lor" title="Permalink to this definition">¶</a></dt>
<dd><p>One Lorentzian
Param contains in sequence Amp_i, Pos_i, Width_i</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.Spec">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">Spec</code><span class="sig-paren">(</span><em class="sig-param">Param</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#Spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.Spec" title="Permalink to this definition">¶</a></dt>
<dd><p>x is the spectral coordinates
Param contains in sequence Amp_i, Pos_i, Width_i
all coordinates are in index</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.cSpec">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">cSpec</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">*Param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#cSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.cSpec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.cdSpec">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">cdSpec</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">*Param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#cdSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.cdSpec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.dLor">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">dLor</code><span class="sig-paren">(</span><em class="sig-param">Amp</em>, <em class="sig-param">Pos</em>, <em class="sig-param">Width</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#dLor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.dLor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.dSpec">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">dSpec</code><span class="sig-paren">(</span><em class="sig-param">Param</em>, <em class="sig-param">x</em>, <em class="sig-param">y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#dSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.dSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Param contains in sequence Amp_i, Pos_i, Width_i</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.dToFit">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">dToFit</code><span class="sig-paren">(</span><em class="sig-param">Param</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#dToFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.dToFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.display_fit">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">display_fit</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#display_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.display_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>displays the result of the fit
accept the same arguments than display()</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.fit">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">zoom=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>fit the 1D npkd data-set for Lorentzian line-shape
current peak list is used as an initial values for fitting
Only peaks within the zoom windows are fitted</p>
<dl>
<dt>fitting is contraint from the initial values</dt><dd><ul class="simple">
<li><p>intensity will not allowed to change by more than x0.5 to x2</p></li>
<li><p>positions by more than 5 points</p></li>
<li><p>width by more than x5</p></li>
</ul>
<p>(constraints work only for scipy version &gt;= 0.17 )</p>
</dd>
</dl>
<p>It may help to use centroid() to pre-optimize the peak list before calling fit(), or calling fit() twice (slower)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.residu">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">residu</code><span class="sig-paren">(</span><em class="sig-param">Params</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#residu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.residu" title="Permalink to this definition">¶</a></dt>
<dd><p>The residue function, returns a vector Ycalc(Params) - y_experimental
can be used by leastsq</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.simulate">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">simulate</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">zoom=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#simulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the 1D npkd data-set using the content of the Peak List
replace the current data-set</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Fitter.tofit">
<code class="sig-prename descclassname">spike.plugins.Fitter.</code><code class="sig-name descname">tofit</code><span class="sig-paren">(</span><em class="sig-param">Params</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Fitter.html#tofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Fitter.tofit" title="Permalink to this definition">¶</a></dt>
<dd><p>calls the residue function, and return sum( residue**2 )
can be used by minimize</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.Integrate">
<span id="spike-plugins-integrate-module"></span><h2>spike.plugins.Integrate module<a class="headerlink" href="#module-spike.plugins.Integrate" title="Permalink to this headline">¶</a></h2>
<p>A set of tools for computing Integrals for 1D  NMR spectra</p>
<p>If present, it can guess integral zones from an existing peak-list
Adds .integrals into NPKDataset  which is an object with its own methods.</p>
<p>First version by DELSUC Marc-André on May-2019.</p>
<dl class="class">
<dt id="spike.plugins.Integrate.Integralitem">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Integrate.</code><code class="sig-name descname">Integralitem</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">end</em>, <em class="sig-param">curve</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integralitem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integralitem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="spike.plugins.Integrate.Integralitem.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">bias</em>, <em class="sig-param">calibration=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integralitem.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integralitem.update" title="Permalink to this definition">¶</a></dt>
<dd><p>given a dataset and a constant bias, recompute the curve and the value</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Integrate.Integrals">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Integrate.</code><code class="sig-name descname">Integrals</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">*args</em>, <em class="sig-param">calibration=None</em>, <em class="sig-param">bias=0.0</em>, <em class="sig-param">separation=3</em>, <em class="sig-param">wings=5</em>, <em class="sig-param">compute=True</em>, <em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>the class to hold a list of Integral</p>
<p>an item is [start, end, curve as np.array(), value]
start and end are in index !</p>
<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.calibrate">
<code class="sig-name descname">calibrate</code><span class="sig-paren">(</span><em class="sig-param">calibration=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.calibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>computes integration values from curves
either use calibration value as a scale,
if calibration is None put the largest to 100.0</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.display">
<code class="sig-name descname">display</code><span class="sig-paren">(</span><em class="sig-param">integoff=0.3</em>, <em class="sig-param">integscale=0.5</em>, <em class="sig-param">color='red'</em>, <em class="sig-param">label=False</em>, <em class="sig-param">labelyposition=None</em>, <em class="sig-param">regions=False</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">figure=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.display" title="Permalink to this definition">¶</a></dt>
<dd><p>displays integrals</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.do_compute">
<code class="sig-name descname">do_compute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.do_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.do_compute" title="Permalink to this definition">¶</a></dt>
<dd><p>realize the computation, using internal parameters</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.integvalues">
<em class="property">property </em><code class="sig-name descname">integvalues</code><a class="headerlink" href="#spike.plugins.Integrate.Integrals.integvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>the list of calibrated values</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.integzones">
<em class="property">property </em><code class="sig-name descname">integzones</code><a class="headerlink" href="#spike.plugins.Integrate.Integrals.integzones" title="Permalink to this definition">¶</a></dt>
<dd><p>the list of (start, end) of integral zones</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.peakstozones">
<code class="sig-name descname">peakstozones</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.peakstozones"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.peakstozones" title="Permalink to this definition">¶</a></dt>
<dd><p>computes integrals zones from peak list, 
separation : if two peaks are less than separation x width n they are aggregated, default = 3
wings : integrals sides are extended by wings x width, default = 5</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.recalibrate">
<code class="sig-name descname">recalibrate</code><span class="sig-paren">(</span><em class="sig-param">entry</em>, <em class="sig-param">calib_value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.recalibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.recalibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>on a dataset already integrated, the integrals are adapted so that
the given entry is set to the given value.</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.to_pandas">
<code class="sig-name descname">to_pandas</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.to_pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.to_pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>export extract of current integrals list to pandas Dataframe</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Integrate.Integrals.zonestocurves">
<code class="sig-name descname">zonestocurves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#Integrals.zonestocurves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.Integrals.zonestocurves" title="Permalink to this definition">¶</a></dt>
<dd><p>from integral lists, computes curves and values</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Integrate.calibrate">
<code class="sig-prename descclassname">spike.plugins.Integrate.</code><code class="sig-name descname">calibrate</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">entry</em>, <em class="sig-param">calib_value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#calibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>on a dataset already integrated, the integrals are adapted so that
the given entry is set to the given value.</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Integrate.display">
<code class="sig-prename descclassname">spike.plugins.Integrate.</code><code class="sig-name descname">display</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">integoff=0.3</em>, <em class="sig-param">integscale=0.5</em>, <em class="sig-param">color='red'</em>, <em class="sig-param">label=False</em>, <em class="sig-param">labelyposition=None</em>, <em class="sig-param">regions=False</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">figure=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.display" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Integrate.integrate">
<code class="sig-prename descclassname">spike.plugins.Integrate.</code><code class="sig-name descname">integrate</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Integrate.html#integrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Integrate.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>computes integral zones and values from peak list,</p>
<p>separation : if two peaks are less than separation x width n they are aggregated, default = 3
wings : integrals sides are extended by wings x width, default = 5
bias: this value is substracted to data before integration
calibration: a coefficient to multiply all integrals / if None (default) largest is set at 100</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.Linear_prediction">
<span id="spike-plugins-linear-prediction-module"></span><h2>spike.plugins.Linear_prediction module<a class="headerlink" href="#module-spike.plugins.Linear_prediction" title="Permalink to this headline">¶</a></h2>
<p>plugin for the Linear Prediction algos into NPKDATA</p>
<dl class="class">
<dt id="spike.plugins.Linear_prediction.LinpredicTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Linear_prediction.</code><code class="sig-name descname">LinpredicTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#LinpredicTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.LinpredicTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.Linear_prediction.LinpredicTests.announce">
<code class="sig-name descname">announce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#LinpredicTests.announce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.LinpredicTests.announce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Linear_prediction.LinpredicTests.setUp">
<code class="sig-name descname">setUp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#LinpredicTests.setUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.LinpredicTests.setUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Linear_prediction.LinpredicTests.test_log">
<code class="sig-name descname">test_log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#LinpredicTests.test_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.LinpredicTests.test_log" title="Permalink to this definition">¶</a></dt>
<dd><p>testing log</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Linear_prediction.lpext">
<code class="sig-prename descclassname">spike.plugins.Linear_prediction.</code><code class="sig-name descname">lpext</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">final_size</em>, <em class="sig-param">lprank=10</em>, <em class="sig-param">algotype='burg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#lpext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.lpext" title="Permalink to this definition">¶</a></dt>
<dd><p>extends a 1D FID or 2D FID in F1 up to final_size, using lprank coefficients, and algotype mode</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Linear_prediction.lpext1d">
<code class="sig-prename descclassname">spike.plugins.Linear_prediction.</code><code class="sig-name descname">lpext1d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">final_size</em>, <em class="sig-param">lprank=10</em>, <em class="sig-param">algotype='burg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#lpext1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.lpext1d" title="Permalink to this definition">¶</a></dt>
<dd><p>extends the current FID up to final_size, using lprank coefficients, and algotype mode</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Linear_prediction.lpext2d">
<code class="sig-prename descclassname">spike.plugins.Linear_prediction.</code><code class="sig-name descname">lpext2d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">final_size</em>, <em class="sig-param">lprank=10</em>, <em class="sig-param">algotype='burg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Linear_prediction.html#lpext2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Linear_prediction.lpext2d" title="Permalink to this definition">¶</a></dt>
<dd><p>extends a 2D FID in F1 up to final_size, using lprank coefficients, and algotype mode</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.PALMA">
<span id="spike-plugins-palma-module"></span><h2>spike.plugins.PALMA module<a class="headerlink" href="#module-spike.plugins.PALMA" title="Permalink to this headline">¶</a></h2>
<p>complete DOSY processing, using the PALMA algorithm</p>
<p>This program uses the PALMA algorithm, presented in the manuscript</p>
<p>Cherni, A., Chouzenoux, E., &amp; Delsuc, M.-A. (2017).
PALMA, an improved algorithm for DOSY signal processing.
Analyst, 142(5), 772–779. <a class="reference external" href="http://doi.org/10.1039/c6an01902a">http://doi.org/10.1039/c6an01902a</a></p>
<p>see manuscript for details.</p>
<p>Authors:
Afef Cherni, Emilie Chouzenoux, and Marc-André Delsuc</p>
<p>Licence: CC-BY-NC-SA   <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">https://creativecommons.org/licenses/by-nc-sa/4.0/</a></p>
<dl class="function">
<dt id="spike.plugins.PALMA.Import_DOSY">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">Import_DOSY</code><span class="sig-paren">(</span><em class="sig-param">fname</em>, <em class="sig-param">nucleus=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#Import_DOSY"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.Import_DOSY" title="Permalink to this definition">¶</a></dt>
<dd><p>Import and calibrate DOSY data-set from a Bruker ser file</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.Import_DOSY_proc">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">Import_DOSY_proc</code><span class="sig-paren">(</span><em class="sig-param">fname</em>, <em class="sig-param">nucleus='1H'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#Import_DOSY_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.Import_DOSY_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Import and calibrate DOSY data-set from a Bruker 2rr file</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.L1">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">L1</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.L1" title="Permalink to this definition">¶</a></dt>
<dd><p>computes L1 norm of x</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.PPXAplus">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">PPXAplus</code><span class="sig-paren">(</span><em class="sig-param">K</em>, <em class="sig-param">Binv</em>, <em class="sig-param">y</em>, <em class="sig-param">eta</em>, <em class="sig-param">nbiter=1000</em>, <em class="sig-param">lamda=0.1</em>, <em class="sig-param">prec=1e-12</em>, <em class="sig-param">full_output=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#PPXAplus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.PPXAplus" title="Permalink to this definition">¶</a></dt>
<dd><p>performs the PPXA+ algorithm
K : a MxN matrix which transform from data space to image space
Binv : inverse of (Id + K.t K)
y : a M vector containing the data
a : an estimate of $sum{x}$ where x is final image - used as a bayesian prior of x
eta : an estimate of the standard deviation of the noise in y
nbiter : maximum number of iteration to do
lamda: is in [0..1], the weigth of l1 vs MaxEnt regularisation</p>
<blockquote>
<div><p>lamda = 0 is full L1
lamda = 1 is full MaxEnt</p>
</div></blockquote>
<p>prec: precision of the result, algo will stop if steps are below this evel
full_output: if True, will compute additional terms during convergence (slower):</p>
<blockquote>
<div><dl class="simple">
<dt>parameters =  (lcrit, lent, lL1, lresidus)</dt><dd><p>with lcrit: the optimized criterion
len: evolution of -entropy
lL1: evolution of L1(x)
lresidus: evolution of the distance ||Kx-y||</p>
</dd>
</dl>
<p>if False, returns the number of performed iterations</p>
</div></blockquote>
<p>returns
(x, parameters), where x is the computed optimal image</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.approx_lambert">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">approx_lambert</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#approx_lambert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.approx_lambert" title="Permalink to this definition">¶</a></dt>
<dd><p>approximation of W( exp(x) )
no error below 50, and  less than 0.2% error for x&gt;50 and converges toward 0 for x-&gt;inf
does not overflow !     does not NaN</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.auto_damp_width">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">auto_damp_width</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#auto_damp_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.auto_damp_width" title="Permalink to this definition">¶</a></dt>
<dd><p>uses the tab buffer to determine the optimum dmin and dmax for ILT processing</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.calibdosy">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">calibdosy</code><span class="sig-paren">(</span><em class="sig-param">litdelta</em>, <em class="sig-param">bigdelta</em>, <em class="sig-param">recovery=0.0</em>, <em class="sig-param">seq_type='ste'</em>, <em class="sig-param">nucleus='1H'</em>, <em class="sig-param">maxgrad=50.0</em>, <em class="sig-param">maxtab=50.0</em>, <em class="sig-param">gradshape=1.0</em>, <em class="sig-param">unbalancing=0.2</em>, <em class="sig-param">os_tau=None</em>, <em class="sig-param">os_version=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#calibdosy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.calibdosy" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the DOSY calibrating factor from the parameters</p>
<blockquote>
<div><blockquote>
<div><dl>
<dt>bigdelta float</dt><dd><p>“Big Delta”  : diffusion delay in msec</p>
</dd>
<dt>litdelta float</dt><dd><p>“little Delta”  : gradient duration in msec</p>
</dd>
<dt>seq_type enum “pgse”,”ste”,”bpp_ste”,”ste_2echoes”,”bpp_ste_2echoes”,”oneshot” / default ste</dt><dd><dl>
<dt>the type of DOSY sequence used</dt><dd><p>pgse : the standard hahn echoe sequence
ste : the standard stimulated echoe sequence
bpp_ste : ste with bipolar gradient pulses
ste_2echoes : ste compensated for convection
bpp_ste_2echoes : bpp_ste compensated for convection
oneshot : the oneshot sequence from Pelta, Morris, Stchedroff, Hammond, 2002, Magn.Reson.Chem. 40, p147</p>
<blockquote>
<div><p>uses unbalancing=0.2, os_tau=None, os_version=1
unbalancing is called alpha in the publication
os_tau is called tau in the publication
os_version=1 corresponds to equation(1) / os_version=2 to (2)</p>
</div></blockquote>
</dd>
</dl>
</dd>
<dt>nucleus enum “1H”,”2H”,”13C”,”15N”,”17O”,”19F”,”31P” / default 1H</dt><dd><p>the observed nucleus</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>recovery float</dt><dd><p>Gradient recovery delay</p>
</dd>
<dt>maxgrad float</dt><dd><p>Maximum Amplificator Gradient Intensity, in G/cm    / default 50.0</p>
</dd>
<dt>maxtab float</dt><dd><p>Maximum Tabulated Gradient Value in the tabulated file. / default 50.0
Bruker users with gradient list in G/cm (difflist) use maxgrad here
Bruker users with gradient list in % use 100 here
Varian users use 32768 here</p>
</dd>
<dt>gradshape float</dt><dd><p>integral factor depending on the gradient shape used / default 1.0
typical values are :</p>
<blockquote>
<div><p>1.0 for rectangular gradients
0.6366 = 2/pi for sine bell gradients
0.4839496 for 4% truncated gaussian (Bruker gauss.100 file)</p>
</div></blockquote>
<p>Bruker users using difflist use 1.0 here, as it is already included in difflist</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.criterion">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">criterion</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">K</em>, <em class="sig-param">y</em>, <em class="sig-param">lamda</em>, <em class="sig-param">a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#criterion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.criterion" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute regularization function, (not used during iteration without full_output)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.dcalibdosy">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">dcalibdosy</code><span class="sig-paren">(</span><em class="sig-param">npk</em>, <em class="sig-param">nucleus='1H'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#dcalibdosy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.dcalibdosy" title="Permalink to this definition">¶</a></dt>
<dd><p>use stored parameters to determine correct DOSY calbiration</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.determine_seqtype">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">determine_seqtype</code><span class="sig-paren">(</span><em class="sig-param">pulprog</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#determine_seqtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.determine_seqtype" title="Permalink to this definition">¶</a></dt>
<dd><p>given the PULPROG name, determines which seq_type is to be used
PULPROG should be follow the standard Bruker naming scheme</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.do_palma">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">do_palma</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">miniSNR=32</em>, <em class="sig-param">mppool=None</em>, <em class="sig-param">nbiter=1000</em>, <em class="sig-param">lamda=0.1</em>, <em class="sig-param">uncertainty=1.2</em>, <em class="sig-param">precision=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#do_palma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.do_palma" title="Permalink to this definition">¶</a></dt>
<dd><p>realize PALMA computation on each column of the 2D datasets
dataset should have been prepared with prepare_palma()</p>
<p>the noise in the initial spectrum is analysed on the first DOSY increment
then each column is processed with palma() if its intensity is sufficient</p>
<p>miniSNR: determines the minimum Signal to Noise Ratio of the signal for allowing the processing
mppool: if passed as a multiprocessing.Pool, it will be used for parallel processing</p>
<p>the other parameters are transparently passed to palma()</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.ent">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">ent</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#ent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.ent" title="Permalink to this definition">¶</a></dt>
<dd><p>computes Entropy of x</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.eval_dosy_noise">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">eval_dosy_noise</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">window_size=9</em>, <em class="sig-param">order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#eval_dosy_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.eval_dosy_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>we estimate the noise in x by computing difference from polynomial fitting
input: x - a real vector
return: the noise level</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.lambert_w">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">lambert_w</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#lambert_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.lambert_w" title="Permalink to this definition">¶</a></dt>
<dd><p>W Lambert function</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.palma">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">palma</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">N</em>, <em class="sig-param">nbiter=1000</em>, <em class="sig-param">uncertainty=1.0</em>, <em class="sig-param">lamda=0.1</em>, <em class="sig-param">precision=1e-08</em>, <em class="sig-param">full_output=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#palma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.palma" title="Permalink to this definition">¶</a></dt>
<dd><p>realize PALMA computation on a 1D dataset containing a decay
dataset should have been prepared with prepare_palma
on each column, the noise is estimated, then PPXA+ algorithm is applied
nbiter: maximum iteration number of the PALMA algo</p>
<dl class="simple">
<dt>uncertainty: noise is estimated on the dataset, and then multiplied by this value</dt><dd><p>so uncertainty=1 is full confidence in the noise evaluation algo
uncertainty&gt;1 allows more room for algo when data quality is poor</p>
</dd>
<dt>lamda is the balance between entropy and L1</dt><dd><p>lamda = 0 is full L1
lamda = 1 is full Ent</p>
</dd>
</dl>
<p>precision: is the required precision for the convergence
full_output is used for debugging purposes, do not use in production</p>
<blockquote>
<div><p>check PPXAplus() doc for details</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.prepare_palma">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">prepare_palma</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">finalsize</em>, <em class="sig-param">Dmin</em>, <em class="sig-param">Dmax</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#prepare_palma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.prepare_palma" title="Permalink to this definition">¶</a></dt>
<dd><p>this method prepares a DOSY dataset for processing
- computes experimental values from imported parameter file
- prepare DOSY transformation matrix</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.process">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">process</code><span class="sig-paren">(</span><em class="sig-param">param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.process" title="Permalink to this definition">¶</a></dt>
<dd><p>do the elemental processing, used by loops</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.prox_l1">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">prox_l1</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">w</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#prox_l1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.prox_l1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute proximity operator of L1 norm”</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.prox_l1_Sent">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">prox_l1_Sent</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">lamda</em>, <em class="sig-param">a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#prox_l1_Sent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.prox_l1_Sent" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the proximity operator of L1 + Shannon Entropy</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.prox_l2">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">prox_l2</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">dx</em>, <em class="sig-param">eta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#prox_l2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.prox_l2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute projection of x onto l2 ball ||z-dx||&lt;=eta
x and dx are image vectors</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.residus">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">residus</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">K</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#residus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.residus" title="Permalink to this definition">¶</a></dt>
<dd><p>computes distance between y and Kx</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.PALMA.test">
<code class="sig-prename descclassname">spike.plugins.PALMA.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param">npkd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/PALMA.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PALMA.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-spike.plugins.Peaks">
<span id="spike-plugins-peaks-module"></span><h2>spike.plugins.Peaks module<a class="headerlink" href="#module-spike.plugins.Peaks" title="Permalink to this headline">¶</a></h2>
<p>set of function for Peak detections and display - 1D and 2D</p>
<p>Very First functionnal - Not finished !</p>
<dl class="simple">
<dt>Peak1D and Peak2D are simple objects</dt><dd><p>with attributes like Id, label, intens(ity), pos(ition), or width
the only added method is report() (returns a string)</p>
</dd>
<dt>Peak1DList and Peak2DList are python list, with a few added methods</dt><dd><ul class="simple">
<li><p>report (to stdio or to a file)</p></li>
<li><dl class="simple">
<dt>largest sort in decreasing order of intensity</dt><dd><dl class="simple">
<dt>other sorts can simply done by peaklist.sort(key = lambda p: p.XXX)</dt><dd><p>where XXX is any peak attribute  (see largest code)</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>Example of usage:</p>
<p># assuming d is a 2D NPKData / 1D will be just as simple
d.pp()          # computes a peak picking over the whole spectrum using 3 x standard_deviation(d)</p>
<blockquote>
<div><p># This is just a detection of all local maxima</p>
</div></blockquote>
<p># We can be more specific:
d.pp(threshold=5E5, zoom=((700,1050),(300,350)) )     # zoom is always in the currently active unit, defined with d.unit</p>
<p># this attached the peak list to the dataset as d.peaks,
# it is a list of Peaks2D objects, with some added properties
print( “number of detected peaks: %d” % len(d.peaks))</p>
<p>p0 = d.peaks[0]     # peaks have label, intensity and positions attributes</p>
<dl class="simple">
<dt>print( p0.report() )        # and a report method</dt><dd><p># report has an additional format parameter which enables control on the output</p>
</dd>
</dl>
<p># we can call centroid to improve the accuracy and move the position to center of a fitted (2D) parabola
d.centroid()</p>
<p># The peak list can be displayed on screen as simple crosses
d.display_peaks()</p>
<p># The label can be modififed for specific purposes:
for p in d.peaks:</p>
<blockquote>
<div><dl class="simple">
<dt>if 150 &lt; p.posF2 &lt; 1500 :</dt><dd><p>p.label = “%.2f x %.f”%(p.posF1,p.posF2)    # for instance changing to the coordinates for a certain zone</p>
</dd>
<dt>else:</dt><dd><p>p.label = “”                                # and removing elsewhere</p>
</dd>
</dl>
</div></blockquote>
<p>d.display_peaks(peak_label=True)</p>
<p># peak lists can also be reported
d.report_peak()</p>
<p># but also as a formatted stream, and redirected to a file:
output = open(“my_peak_list.csv”,”w”)      # open the file
output.write(“# LABEL, INTENSITY, F1, Width, F2, width”)
d.report_peak(file=output, format=”{1}, {4:.2f}, {2:.7f}, {5:.2f}, {3:.7f}, {6:.2f}”)</p>
<blockquote>
<div><p># arguments order order is   id, label, posF1, posF2, intensity, widthF1, widthF2</p>
</div></blockquote>
<p>output.close()</p>
<p>Sept 2015 M-A Delsuc</p>
<dl class="class">
<dt id="spike.plugins.Peaks.Peak">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">Peak</code><span class="sig-paren">(</span><em class="sig-param">Id</em>, <em class="sig-param">label</em>, <em class="sig-param">intens</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>a generic class to store peaks
defines :
Id          a unique integer
intens      The intensity (the height of the largest point)
area        The area/volume of the peak
label       a string 
intens_err  The uncertainty of the previous values
area_err    ..</p>
</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.Peak1D">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">Peak1D</code><span class="sig-paren">(</span><em class="sig-param">Id</em>, <em class="sig-param">label</em>, <em class="sig-param">intens</em>, <em class="sig-param">pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#spike.plugins.Peaks.Peak" title="spike.plugins.Peaks.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">spike.plugins.Peaks.Peak</span></code></a></p>
<p>a class to store a single 1D peak
defines in addition to Peak
pos         position of the peak in index relative to the typed (real/complex) buffer
width       width of the peak in index
pos_err     uncertainty of the previous values
width_err   …</p>
<dl class="attribute">
<dt id="spike.plugins.Peaks.Peak1D.full_format">
<code class="sig-name descname">full_format</code><em class="property"> = '{}, {}, {}, {}, {}, {}, {}, {}, '</em><a class="headerlink" href="#spike.plugins.Peaks.Peak1D.full_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak1D.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">f=&lt;function _identity&gt;</em>, <em class="sig-param">format=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1D.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1D.report" title="Permalink to this definition">¶</a></dt>
<dd><p>print the peak list
f is a function used to transform the coordinate
indentity function is default,
for instance you can use something like
peaks.report(f=s.axis1.itop)    to get ppm values on a NMR dataset
order is “id, label, position, intensity”</p>
<p>parameters are : 
Id label positions intens width intens_err pos_err width_err 
in that order.</p>
<p>By default returns only the 4 first fields with 2 digits, but the format keyword can change that.
format values:
- None or “report”, the standard value is used:  “{}, {}, {:.2f}, {:.2f}”</p>
<blockquote>
<div><p>(so only the four first parameters are shown)</p>
</div></blockquote>
<ul class="simple">
<li><p>“full” is all parrameters at full resolution  ( “{}; “<a href="#id5"><span class="problematic" id="id6">*</span></a>8 )</p></li>
<li><dl class="simple">
<dt>any othe string following the format syta will do.</dt><dd><p>you can use any formating syntax. So for instance the following format
“{1} :   {3:.2f}  F1: {2:.7f} +/- {4:.2f}”
will remove the Id, show position with 7 digits after the comma, and will show width</p>
</dd>
</dl>
</li>
</ul>
<p>you can change the report and full default values by setting
pk.__class__.report_format   and   pk.__class__.full_format  which class attributes</p>
</dd></dl>

<dl class="attribute">
<dt id="spike.plugins.Peaks.Peak1D.report_format">
<code class="sig-name descname">report_format</code><em class="property"> = '{}, {}, {:.2f}, {:.2f}'</em><a class="headerlink" href="#spike.plugins.Peaks.Peak1D.report_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.Peak1DList">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">Peak1DList</code><span class="sig-paren">(</span><em class="sig-param">*arg</em>, <em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1DList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1DList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#spike.plugins.Peaks.PeakList" title="spike.plugins.Peaks.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">spike.plugins.Peaks.PeakList</span></code></a></p>
<p>store a list of 1D peaks
contains the array version of the Peak1D object :
self.pos is the numpy array of the position of all the peaks
and self[k] is the kth Peak1D object of the list</p>
<dl class="method">
<dt id="spike.plugins.Peaks.Peak1DList.display">
<code class="sig-name descname">display</code><span class="sig-paren">(</span><em class="sig-param">peak_label=False</em>, <em class="sig-param">peak_mode='marker'</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">show=False</em>, <em class="sig-param">f=&lt;function _identity&gt;</em>, <em class="sig-param">color='red'</em>, <em class="sig-param">markersize=None</em>, <em class="sig-param">figure=None</em>, <em class="sig-param">scale=1.0</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1DList.display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1DList.display" title="Permalink to this definition">¶</a></dt>
<dd><p>displays 1D peaks
zoom is in index
peak_mode is either “marker” or “bar”
NbMaxPeaks is the maximum number of peaks to displayin the zoom window (show only the largest)
f() should be a function which converts from points to current display scale - typically npk.axis1.itoc</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak1DList.pos">
<em class="property">property </em><code class="sig-name descname">pos</code><a class="headerlink" href="#spike.plugins.Peaks.Peak1DList.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a numpy array of the positions in index</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak1DList.pos2label">
<code class="sig-name descname">pos2label</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1DList.pos2label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1DList.pos2label" title="Permalink to this definition">¶</a></dt>
<dd><p>use pos in current unit, using converion f and set it as label for each peak</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak1DList.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">f=&lt;function _identity&gt;</em>, <em class="sig-param">file=None</em>, <em class="sig-param">format=None</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak1DList.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak1DList.report" title="Permalink to this definition">¶</a></dt>
<dd><p>print the peak list
f is a function used to transform respectively the coordinates
indentity function is default,
for instance you can use something like
d.peaks.report(f=d.axis1.itop)    to get ppm values on a NMR dataset</p>
<p>check documentation for Peak1D.report() for details on output format</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.Peak2D">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">Peak2D</code><span class="sig-paren">(</span><em class="sig-param">Id</em>, <em class="sig-param">label</em>, <em class="sig-param">intens</em>, <em class="sig-param">posF1</em>, <em class="sig-param">posF2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#spike.plugins.Peaks.Peak" title="spike.plugins.Peaks.Peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">spike.plugins.Peaks.Peak</span></code></a></p>
<p>a class to store a single 2D peak
defines in addition to Peak
posF1 posF2         positions in F1 and F2 of the peak in index relative to the typed (real/complex) axis
widthF1 …F2       widthes of the peak in index
posF1_err …       uncertainty of the previous values
widthF1_err   …</p>
<dl class="attribute">
<dt id="spike.plugins.Peaks.Peak2D.full_format">
<code class="sig-name descname">full_format</code><em class="property"> = '{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, '</em><a class="headerlink" href="#spike.plugins.Peaks.Peak2D.full_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak2D.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">f1=&lt;function _identity&gt;</em>, <em class="sig-param">f2=&lt;function _identity&gt;</em>, <em class="sig-param">format=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak2D.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak2D.report" title="Permalink to this definition">¶</a></dt>
<dd><p>print the peak list
f1, f2 are two functions used to transform respectively the coordinates in F1 and F2
indentity function is default,
for instance you can use something like
peaks.report(f1=s.axis1.itop, f2=s.axis2.itop)    to get ppm values on a NMR dataset
order is “id, label, posF1, posF2, intensity, widthF1, widthF2”</p>
<p>printed parameters are : 
Id label posF1 posF2 intens widthF1 widthF2 posF1_err posF2_err intens_err widthF1_err widthF2_err</p>
<p>By default returns only the 5 first fields with 2 digits, but the format keyword can change that.
format values:
- None or “report”, the standard value is used:  “{}, {}, {:.2f}, {:.2f}, {:.2f}”</p>
<blockquote>
<div><p>(so only the four first parameters are shown)</p>
</div></blockquote>
<ul class="simple">
<li><p>“full” is all parrameters at full resolution  ( “{}; “<a href="#id7"><span class="problematic" id="id8">*</span></a>12 )</p></li>
<li><dl class="simple">
<dt>any othe string following the format syntxa will do.</dt><dd><p>you can use any formating syntax. So for instance the following format
“{1} :   {4:.2f}  F1: {2:.7f} +/- {5:.2f}  X  F2: {3:.7f} +/- {6:.2f}”
will remove the Id, show position with 7 digits after the comma, and will show widthes</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="spike.plugins.Peaks.Peak2D.report_format">
<code class="sig-name descname">report_format</code><em class="property"> = '{}, {}, {:.2f}, {:.2f}, {:.2f}'</em><a class="headerlink" href="#spike.plugins.Peaks.Peak2D.report_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.Peak2DList">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">Peak2DList</code><span class="sig-paren">(</span><em class="sig-param">*arg</em>, <em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak2DList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak2DList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#spike.plugins.Peaks.PeakList" title="spike.plugins.Peaks.PeakList"><code class="xref py py-class docutils literal notranslate"><span class="pre">spike.plugins.Peaks.PeakList</span></code></a></p>
<p>store a list of 2D peaks
contains the array version of the Peak2D object :
self.posF1 is the numpy array of the position of all the peaks
and self[k] is the kth Peak2D object of the list</p>
<dl class="method">
<dt id="spike.plugins.Peaks.Peak2DList.display">
<code class="sig-name descname">display</code><span class="sig-paren">(</span><em class="sig-param">axis=None</em>, <em class="sig-param">peak_label=False</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">show=False</em>, <em class="sig-param">f1=&lt;function _identity&gt;</em>, <em class="sig-param">f2=&lt;function _identity&gt;</em>, <em class="sig-param">color=None</em>, <em class="sig-param">markersize=6</em>, <em class="sig-param">figure=None</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak2DList.display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak2DList.display" title="Permalink to this definition">¶</a></dt>
<dd><p>displays 2D peak list
zoom is in index
f1 and f2 should be functions which convert from points to current display scale - typically npk.axis1.itoc npk.axis2.itoc</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak2DList.posF1">
<em class="property">property </em><code class="sig-name descname">posF1</code><a class="headerlink" href="#spike.plugins.Peaks.Peak2DList.posF1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a numpy array of the F1 positions in index</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak2DList.posF2">
<em class="property">property </em><code class="sig-name descname">posF2</code><a class="headerlink" href="#spike.plugins.Peaks.Peak2DList.posF2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a numpy array of the F2 positions in index</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.Peak2DList.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">f1=&lt;function _identity&gt;</em>, <em class="sig-param">f2=&lt;function _identity&gt;</em>, <em class="sig-param">file=None</em>, <em class="sig-param">format=None</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#Peak2DList.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.Peak2DList.report" title="Permalink to this definition">¶</a></dt>
<dd><p>print the peak list
f1, f2 are two functions used to transform respectively the coordinates in F1 and F2
indentity function is default,
for instance you can use something like
d.peaks.export(f1=s.axis1.itop, f2=s.axis2.itop)    to get ppm values on a NMR dataset
the file keyword allows to redirect the output to a file object</p>
<p>check documentation for Peak2D.report() for details on output format</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.PeakList">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">PeakList</code><span class="sig-paren">(</span><em class="sig-param">*arg</em>, <em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>the class generic to all peak lists</p>
<dl class="method">
<dt id="spike.plugins.Peaks.PeakList.intens">
<em class="property">property </em><code class="sig-name descname">intens</code><a class="headerlink" href="#spike.plugins.Peaks.PeakList.intens" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a numpy array of the intensities</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakList.label">
<em class="property">property </em><code class="sig-name descname">label</code><a class="headerlink" href="#spike.plugins.Peaks.PeakList.label" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array of the labels</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakList.largest">
<code class="sig-name descname">largest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakList.largest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakList.largest" title="Permalink to this definition">¶</a></dt>
<dd><p>sort the peaklist in decresing order of intensities</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakList.len">
<code class="sig-name descname">len</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakList.len"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakList.len" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="spike.plugins.Peaks.PeakTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">PeakTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.Peaks.PeakTests.test_center1d">
<code class="sig-name descname">test_center1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakTests.test_center1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakTests.test_center1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakTests.test_center2d">
<code class="sig-name descname">test_center2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakTests.test_center2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakTests.test_center2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakTests.test_peaks1d">
<code class="sig-name descname">test_peaks1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakTests.test_peaks1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakTests.test_peaks1d" title="Permalink to this definition">¶</a></dt>
<dd><p>test 1D peak picker</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.Peaks.PeakTests.test_peaks2d">
<code class="sig-name descname">test_peaks2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#PeakTests.test_peaks2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.PeakTests.test_peaks2d" title="Permalink to this definition">¶</a></dt>
<dd><p>test 2D peak picker</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.center">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">center</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">xo</em>, <em class="sig-param">intens</em>, <em class="sig-param">width</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.center" title="Permalink to this definition">¶</a></dt>
<dd><p>the centroid definition, used to fit the spectrum
x can be a nparray
FWMH is   sqrt(2) x width.</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.center2d">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">center2d</code><span class="sig-paren">(</span><em class="sig-param">yx</em>, <em class="sig-param">yo</em>, <em class="sig-param">xo</em>, <em class="sig-param">intens</em>, <em class="sig-param">widthy</em>, <em class="sig-param">widthx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#center2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.center2d" title="Permalink to this definition">¶</a></dt>
<dd><p>the 2D centroid, used to fit 2D spectra - si center()
xy is [x0, y_0, x_1, y_1, …, x_n-1, y_n-1] - is 2*n long for n points,
returns [z_0, z_1, … z_n-1]</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.centroid">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">centroid</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">*arg</em>, <em class="sig-param">**kwarg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#centroid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.centroid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.centroid1d">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">centroid1d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">npoints=3</em>, <em class="sig-param">reset_label=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#centroid1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.centroid1d" title="Permalink to this definition">¶</a></dt>
<dd><p>from peak lists determined with peak()
realize a centroid fit of the peak summit and width,
will use npoints values around center  (npoints has to be odd)
computes Full width at half maximum
updates in data peak list
reset_label when True (default) reset the labels of FTMS datasets
TODO : update uncertainties</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.centroid2d">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">centroid2d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">npoints_F1=3</em>, <em class="sig-param">npoints_F2=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#centroid2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.centroid2d" title="Permalink to this definition">¶</a></dt>
<dd><p>from peak lists determined with peak()
realize a centroid fit of the peak summit and width,
computes Full width at half maximum
updates in data peak list</p>
<p>TODO : update uncertainties</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.display_peaks">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">display_peaks</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">peak_label=False</em>, <em class="sig-param">peak_mode='marker'</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">show=False</em>, <em class="sig-param">color=None</em>, <em class="sig-param">markersize=6</em>, <em class="sig-param">figure=None</em>, <em class="sig-param">scale=1.0</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#display_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.display_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>display the content of the peak list, 
peak_mode is either “marker” (default) or “bar” (1D only)
zoom is in current unit.</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.peak_aggreg">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">peak_aggreg</code><span class="sig-paren">(</span><em class="sig-param">pklist</em>, <em class="sig-param">distance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#peak_aggreg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.peak_aggreg" title="Permalink to this definition">¶</a></dt>
<dd><p>aggregates peaks in peaklist if peaks are closer than a given distance in pixel
distance : if two peaks are less than distance (in points),  they are aggregated</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.peakpick">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">peakpick</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">threshold=None</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">autothresh=3.0</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#peakpick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.peakpick" title="Permalink to this definition">¶</a></dt>
<dd><p>performs a peak picking of the current experiment
threshold is the level above which peaks are picked</p>
<blockquote>
<div><p>None (default) means that autothresh*(noise level of dataset) will be used - using d.robust_stats() as proxy for noise-level</p>
</div></blockquote>
<dl class="simple">
<dt>zoom defines the region on which detection is made</dt><dd><p>zoom is in currentunit (same syntax as in display)
None means the whole data</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.peaks1d">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">peaks1d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">threshold</em>, <em class="sig-param">zoom=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#peaks1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.peaks1d" title="Permalink to this definition">¶</a></dt>
<dd><p>math code for NPKData 1D peak picker</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.peaks2d">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">peaks2d</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">threshold</em>, <em class="sig-param">zoom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#peaks2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.peaks2d" title="Permalink to this definition">¶</a></dt>
<dd><p>math code for NPKData 2D peak picker</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.pk2pandas">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">pk2pandas</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">full=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#pk2pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.pk2pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>export extract of current peak list to pandas Dataframe - in current unit
if full is False (default), the uncertainty are not listed
uses nmr or ms version depending on data_type</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.pk2pandas_ms">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">pk2pandas_ms</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">full=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#pk2pandas_ms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.pk2pandas_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>export extract of current peak list to pandas Dataframe for MS datasets</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.pk2pandas_nmr">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">pk2pandas_nmr</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">full=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#pk2pandas_nmr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.pk2pandas_nmr" title="Permalink to this definition">¶</a></dt>
<dd><p>export extract of current peak list to pandas Dataframe for NMR datasets</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.Peaks.report_peaks">
<code class="sig-prename descclassname">spike.plugins.Peaks.</code><code class="sig-name descname">report_peaks</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">file=None</em>, <em class="sig-param">format=None</em>, <em class="sig-param">NbMaxPeaks=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/Peaks.html#report_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.Peaks.report_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>print the content of the peak list, using the current unit</p>
<p>if file should be an already opened writable file stream. 
if None, output will go to stdout</p>
<p>for documentation, check Peak1D.report() and Peak2D.report()</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.apmin">
<span id="spike-plugins-apmin-module"></span><h2>spike.plugins.apmin module<a class="headerlink" href="#module-spike.plugins.apmin" title="Permalink to this headline">¶</a></h2>
<p>Autmomatic phase correction for 1D NMR spectra</p>
<p>based on an earlier version from NPK</p>
<p>works by minimizing the negative part of the spectrum
WILL NOT WORK on positive/negative spectra (JMOD, W-LOGSY, etc.)</p>
<p>Created by DELSUC Marc-André on 2016-05-23.
Copyright (c) 2016 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.plugins.apmin.apmin">
<code class="sig-prename descclassname">spike.plugins.apmin.</code><code class="sig-name descname">apmin</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">first_order=True</em>, <em class="sig-param">inwater=False</em>, <em class="sig-param">baselinecorr=True</em>, <em class="sig-param">apt=False</em>, <em class="sig-param">debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/apmin.html#apmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.apmin.apmin" title="Permalink to this definition">¶</a></dt>
<dd><p>automatic 1D phase correction
phase by minimizing the negative wing of the 1D spectrum</p>
<p>first_order = False   inhibit optimizing 1st order phase
inwater = True   does not look to the central zone of the spectrum
baselinecorr = True, an advanced baseline correction is applied on the final steps
apt = True   (Attached proton test) performs the phasing on up-down spectra, such as APT / DEPT 13C spectra.</p>
<p>performs a grid/simplex search on P0 first then on (P0 P1)    
the dataset is returned phased and the values are stored in d.axis1.P0 and d.axis1.P1</p>
<p>P1 is kept to 0 if first_order=False</p>
<dl class="simple">
<dt>note that if baselinecorr is True</dt><dd><ul class="simple">
<li><p>the algo becomes quite slow !</p></li>
<li><p>a simple linear baseline correction is always applied anyway anyhow</p></li>
</ul>
</dd>
</dl>
<p>adapted from NPK v1 
MAD, may 2016</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.apmin.neg_wing">
<code class="sig-prename descclassname">spike.plugins.apmin.</code><code class="sig-name descname">neg_wing</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">bcorr=False</em>, <em class="sig-param">inwater=False</em>, <em class="sig-param">apt=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/apmin.html#neg_wing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.apmin.neg_wing" title="Permalink to this definition">¶</a></dt>
<dd><p>measure negative wing power of NPKData d</p>
<p>if bcorr == True, a baseline correction is applied
if inwater == True, the 10% central zone is just zeroed
if apt == False, computes the std() of the negative points  (distance to mean)</p>
<blockquote>
<div><p>== True, computes the sum(abs()) of all the points (l_1 norm)</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.apmin.phase_pivot">
<code class="sig-prename descclassname">spike.plugins.apmin.</code><code class="sig-name descname">phase_pivot</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">p0</em>, <em class="sig-param">p1</em>, <em class="sig-param">pivot=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/apmin.html#phase_pivot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.apmin.phase_pivot" title="Permalink to this definition">¶</a></dt>
<dd><p>three parameter phasing routine
pivot = 0 is on left side
pivot = 1 is on right side
all intermediate values are possible
returns actual (P0, P1)</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.bcorr">
<span id="spike-plugins-bcorr-module"></span><h2>spike.plugins.bcorr module<a class="headerlink" href="#module-spike.plugins.bcorr" title="Permalink to this headline">¶</a></h2>
<p>set of function for the baseline correction</p>
<p>First version - Not finished !</p>
<p>improved July 2016</p>
<dl class="function">
<dt id="spike.plugins.bcorr.autopoints">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">autopoints</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">Npoints=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#autopoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.autopoints" title="Permalink to this definition">¶</a></dt>
<dd><p>computes Npoints (defaut 8) positions for a spline baseline correction</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bcorr.bcorr">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">bcorr</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">method='spline'</em>, <em class="sig-param">xpoints=None</em>, <em class="sig-param">nsmooth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#bcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.bcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>recapitulate all baseline correction methods, only 1D so far</p>
<dl class="simple">
<dt>method is either</dt><dd><dl class="simple">
<dt>auto: </dt><dd><p>use bcorr_auto, uses an automatic determination of the baseline
does not work with negative peaks.</p>
</dd>
<dt>linear:</dt><dd><p>simple 1D correction</p>
</dd>
<dt>spline:</dt><dd><p>a cubic spline correction</p>
</dd>
</dl>
</dd>
</dl>
<p>both linear and spline use an additional list of pivot points ‘xpoints’ used to calculate the baseline
if xpoints absent,  pivots are estimated automaticaly
if xpoints is integer, it determines the number of computed pivots (defaut is 8 if xpoints is None)
if xpoints is a list of integers, there will used as pivots</p>
<p>if nsmooth &gt;0, buffer is smoothed by moving average over 2*nsmooth+1 positions around pivots.
default is spline with automatic detection of 8 baseline points</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bcorr.bcorr_auto">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">bcorr_auto</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">iterations=10</em>, <em class="sig-param">nbchunks=40</em>, <em class="sig-param">degree=1</em>, <em class="sig-param">nbcores=2</em>, <em class="sig-param">smooth=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#bcorr_auto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.bcorr_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>applies an automatic baseline correction</p>
<p>Find baseline by using low norm value and then high norm value to attract the baseline on the small values.
Parameters : 
iterations : number of iterations for convergence toward the small values. 
nbchunks : number of chunks on which is done the minimization. Typically, each chunk must be larger than the peaks. 
degree : degree of the polynome used for approaching each signal chunk. 
nbcores : number of cores used for minimizing in parallel on many chunks (if not None)</p>
<p>smooth i True, applies a final Savitsky-Golay smoothing</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bcorr.get_ypoints">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">get_ypoints</code><span class="sig-paren">(</span><em class="sig-param">buff</em>, <em class="sig-param">xpoints</em>, <em class="sig-param">nsmooth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#get_ypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.get_ypoints" title="Permalink to this definition">¶</a></dt>
<dd><p>from  buff and xpoints, returns ypoints = buff[xpoints]
eventually smoothed by moving average over 2*nsmooth+1 positions</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bcorr.linear_interpolate">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">linear_interpolate</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">xpoints</em>, <em class="sig-param">axis='F2'</em>, <em class="sig-param">nsmooth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#linear_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.linear_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>”
compute and applies a linear function as a baseline correction
xpoints are the location of pivot points</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bcorr.spline_interpolate">
<code class="sig-prename descclassname">spike.plugins.bcorr.</code><code class="sig-name descname">spline_interpolate</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">xpoints</em>, <em class="sig-param">axis='F2'</em>, <em class="sig-param">nsmooth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bcorr.html#spline_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bcorr.spline_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>”
compute and applies a spline function as a baseline correction
xpoints are the location of pivot points</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.bokeh_display">
<span id="spike-plugins-bokeh-display-module"></span><h2>spike.plugins.bokeh_display module<a class="headerlink" href="#module-spike.plugins.bokeh_display" title="Permalink to this headline">¶</a></h2>
<p>displays interactive plots through bokeh, allows to save them in html format.</p>
<p>This plugin uses bokeh (<a class="reference external" href="https://bokeh.pydata.org/en/latest/">https://bokeh.pydata.org/en/latest/</a>) to build and display interactive plots.
It adds npkd.bokeh_fig, a python dictionary containing the styles (colors, lines…) and npkd.bokeh_plot containing the plot itself (bokeh figure format).</p>
<dl>
<dt>To make it work in the notebook add:</dt><dd><p>from bokeh.io import show,output_notebook
output_notebook()</p>
</dd>
<dt>And do: </dt><dd><p>npkd.bokeh(show=True)</p>
</dd>
<dt>To save the plot in html format after doing npkd.bokeh(show=True):</dt><dd><p>from bokeh.resources import CDN
from bokeh.embed import file_html
html_text = file_html(npkd.bokeh_plot, CDN, “Title”)
with open(“bokehplot.html”, “w”) as file:</p>
<blockquote>
<div><p>file.write(html_text)</p>
</div></blockquote>
</dd>
</dl>
<dl class="function">
<dt id="spike.plugins.bokeh_display.bokeh_display">
<code class="sig-prename descclassname">spike.plugins.bokeh_display.</code><code class="sig-name descname">bokeh_display</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">scale=1.0</em>, <em class="sig-param">autoscalethresh=3.0</em>, <em class="sig-param">absmax=None</em>, <em class="sig-param">show=False</em>, <em class="sig-param">title=None</em>, <em class="sig-param">label=None</em>, <em class="sig-param">xlabel='_def_'</em>, <em class="sig-param">ylabel='_def_'</em>, <em class="sig-param">axis=None</em>, <em class="sig-param">image=False</em>, <em class="sig-param">mode3D=False</em>, <em class="sig-param">zoom=None</em>, <em class="sig-param">mpldic={}</em>, <em class="sig-param">dbkdic={}</em>, <em class="sig-param">dfigdic={}</em>, <em class="sig-param">linewidth=1</em>, <em class="sig-param">color=None</em>, <em class="sig-param">plot_width=600</em>, <em class="sig-param">plot_height=400</em>, <em class="sig-param">sizing_mode=None</em>, <em class="sig-param">redraw=False</em>, <em class="sig-param">tools='pan</em>, <em class="sig-param">box_zoom</em>, <em class="sig-param">box_select</em>, <em class="sig-param">reset</em>, <em class="sig-param">save'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bokeh_display.html#bokeh_display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bokeh_display.bokeh_display" title="Permalink to this definition">¶</a></dt>
<dd><p>Display using bokeh instead of matplotlib</p>
<p>scale       allows to increase the vertical scale of display
absmax      overwrite the value for the largest point, which will not be computed</p>
<blockquote>
<div><p>display is scaled so that the largest point is first computed (and stored in absmax),
and then the value at absmax/scale is set full screen</p>
</div></blockquote>
<dl class="simple">
<dt>show        will call bk.show() at the end, allowing every declared display to be shown on-screen</dt><dd><p>useless in ipython/jupyter notebook</p>
</dd>
</dl>
<p>title       add a title to the bokeh plot
label       add a label text to plot
xlabel, ylabel    axes label (default is self.currentunit - use None to remove)
axis        used as axis if present, axis length should match experiment length</p>
<blockquote>
<div><p>in 2D, should be a pair (xaxis,yaxis)</p>
</div></blockquote>
<dl class="simple">
<dt>image       if True, the function will generate the 2D NMR FID of data,</dt><dd><p>if False (Default), the function present contour plots.</p>
</dd>
</dl>
<p>mode3D      not implemented
zoom        is a tuple defining the zoom window (left,right) or   ((F1_limits),(F2_limits))</p>
<blockquote>
<div><p>defined in the current axis unit (points, ppm, m/z etc ….)</p>
</div></blockquote>
<p>mpldic      a dictionnary passed as is to the matplotlib plot command 
dbkdic      a dictionnary passed as is to populated the parameters of the bokeh graph 
dfigdic     a dictionnary passed as is to populated the content of the bokeh figure
linewidth   linewidth for the plots (useful for example when using seaborn)
color       if 1D is the color of the curve,</p>
<blockquote>
<div><p>if 2D FID is the palette name to be used,
if 2D contour is the color set to be used by matplotlib.</p>
</div></blockquote>
<p>plot_width, plot_height  width and height of the plot
sizing_mode if provided, resize plot according to the window chosen sizes.</p>
<blockquote>
<div><p>e.g. “scale_width”, “scale_height”, “scale_both”</p>
</div></blockquote>
<dl class="simple">
<dt>tools       a string containing the tools to be available for bokeh interactivity.</dt><dd><p>e.g. “pan, box_zoom, box_select, reset, save” (see bokeh doc for more info)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.bokeh_display.get_contour_data">
<code class="sig-prename descclassname">spike.plugins.bokeh_display.</code><code class="sig-name descname">get_contour_data</code><span class="sig-paren">(</span><em class="sig-param">ax</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/bokeh_display.html#get_contour_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.bokeh_display.get_contour_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get informations about contours created by matplotlib.
ax is the input matplotlob contour ax (cf. fig,ax produced by matplotlib)
xs and ys are the different contour lines got out of the matplotlib. col is the color corresponding to the lines.</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.diagonal_2DMS">
<span id="spike-plugins-diagonal-2dms-module"></span><h2>spike.plugins.diagonal_2DMS module<a class="headerlink" href="#module-spike.plugins.diagonal_2DMS" title="Permalink to this headline">¶</a></h2>
<p>computes diagonal of 2D-MS spectra</p>
<p>Created by DELSUC Marc-André on 2020-12-10.</p>
<dl class="function">
<dt id="spike.plugins.diagonal_2DMS.diagonal">
<code class="sig-prename descclassname">spike.plugins.diagonal_2DMS.</code><code class="sig-name descname">diagonal</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/diagonal_2DMS.html#diagonal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.diagonal_2DMS.diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>allows to extract the diagonal of a 2D FTMS spectrum</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.fastclean">
<span id="spike-plugins-fastclean-module"></span><h2>spike.plugins.fastclean module<a class="headerlink" href="#module-spike.plugins.fastclean" title="Permalink to this headline">¶</a></h2>
<p>A utility to set to zero all points below a ratio</p>
<dl class="function">
<dt id="spike.plugins.fastclean.fastclean">
<code class="sig-prename descclassname">spike.plugins.fastclean.</code><code class="sig-name descname">fastclean</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">nsigma=2.0</em>, <em class="sig-param">nbseg=20</em>, <em class="sig-param">axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/fastclean.html#fastclean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.fastclean.fastclean" title="Permalink to this definition">¶</a></dt>
<dd><p>set to zeros all points below nsigma times the noise level
This allows the corresponding data-set, once stored to file, to be considerably more compressive.</p>
<dl class="simple">
<dt>nsigma: float</dt><dd><p>the ratio used, typically 1.0 to 3.0 (higher compression)</p>
</dd>
<dt>nbseg: int</dt><dd><p>the number of segments used for noise evaluation, see util.signal_tools.findnoiselevel</p>
</dd>
<dt>axis: int</dt><dd><p>the axis on which the noise is evaluated, default is fastest varying dimension</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.gaussenh">
<span id="spike-plugins-gaussenh-module"></span><h2>spike.plugins.gaussenh module<a class="headerlink" href="#module-spike.plugins.gaussenh" title="Permalink to this headline">¶</a></h2>
<p>Gaussian enhancement apodisation</p>
<p>d.gaussenh(width, enhancement=1.0, axis=0)</p>
<blockquote>
<div><p>apply an gaussian enhancement, width is in Hz
enhancement is the strength of the effect
axis is either F1, or F2 in 2D, 0 is default axis.
multiplies by gauss(width) * exp(-enhancement*width)</p>
</div></blockquote>
<p>Created by DELSUC Marc-André on February 2019
Copyright (c) 2019 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.plugins.gaussenh.gaussenh">
<code class="sig-prename descclassname">spike.plugins.gaussenh.</code><code class="sig-name descname">gaussenh</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">width</em>, <em class="sig-param">enhancement=2.0</em>, <em class="sig-param">axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/gaussenh.html#gaussenh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.gaussenh.gaussenh" title="Permalink to this definition">¶</a></dt>
<dd><p>apply an gaussian enhancement, width is in Hz
enhancement is the strength of the effect
multiplies by gauss(width) * exp(-enhancement*width)</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.pg_sane">
<span id="spike-plugins-pg-sane-module"></span><h2>spike.plugins.pg_sane module<a class="headerlink" href="#module-spike.plugins.pg_sane" title="Permalink to this headline">¶</a></h2>
<p>plugin for PG_Sane algorithm,  used for NUS processing</p>
<p>It takes a NUS acquired transient, and fill it by estimating the missing values.</p>
<p>associated publications</p>
<ul class="simple">
<li><p>Lionel Chiron, Afef Cherni, Christian Rolando, Emilie Chouzenoux, Marc-André Delsuc
Fast Analysis of Non Uniform Sampled DataSets in 2D-FT-ICR-MS. - in progress</p></li>
<li><p>Bray, F., Bouclon, J., Chiron, L., Witt, M., Delsuc, M.-A., &amp; Rolando, C. (2017).
Nonuniform Sampling Acquisition of Two-Dimensional Fourier Transform Ion Cyclotron Resonance Mass Spectrometry for Increased Mass Resolution of Tandem Mass Spectrometry Precursor Ions.
Anal. Chem., acs.analchem.7b01850. <a class="reference external" href="http://doi.org/10.1021/acs.analchem.7b01850">http://doi.org/10.1021/acs.analchem.7b01850</a></p></li>
<li><p>Chiron, L., van Agthoven, M. A., Kieffer, B., Rolando, C., &amp; Delsuc, M.-A. (2014).
Efficient denoising algorithms for large experimental datasets and their applications in Fourier transform ion cyclotron resonance mass spectrometry.
PNAS , 111(4), 1385–1390. <a class="reference external" href="http://doi.org/10.1073/pnas.1306700111">http://doi.org/10.1073/pnas.1306700111</a></p></li>
</ul>
<dl class="function">
<dt id="spike.plugins.pg_sane.HT">
<code class="sig-prename descclassname">spike.plugins.pg_sane.</code><code class="sig-name descname">HT</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#HT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.HT" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Hard Thresholding of x,
i.e. all points such as x_i &lt;= thresh are set to 0.0</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.pg_sane.HTproj">
<code class="sig-prename descclassname">spike.plugins.pg_sane.</code><code class="sig-name descname">HTproj</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#HTproj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.HTproj" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Hard Thresholding of x, on the ball of radius ell_o = k
i.e. the k largest values are kept, all other are set to 0</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.pg_sane.noise">
<code class="sig-prename descclassname">spike.plugins.pg_sane.</code><code class="sig-name descname">noise</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">iterations=10</em>, <em class="sig-param">tresh=3.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple noise evaluation</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.pg_sane.pg_sane">
<code class="sig-prename descclassname">spike.plugins.pg_sane.</code><code class="sig-name descname">pg_sane</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">HTmode='projection'</em>, <em class="sig-param">axis=1</em>, <em class="sig-param">iterations=10</em>, <em class="sig-param">HTratio=None</em>, <em class="sig-param">rank=20</em>, <em class="sig-param">Lthresh=2.0</em>, <em class="sig-param">sampling=None</em>, <em class="sig-param">size=None</em>, <em class="sig-param">final='SANE'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#pg_sane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.pg_sane" title="Permalink to this definition">¶</a></dt>
<dd><p>Papoulis Gershberg algorithm - stabilized with SANE</p>
<p>This function takes FID with a partial sampling, and fills the holes with estimated values.
The FID can then be processed normally, as it was completely acquired.</p>
<p>mode (threshold or projection) determine PG algorithm
iterations : the number of iterations used for the program</p>
<blockquote>
<div><p>pg_sane converges quite rapidely, and usually 5 to 20 iterations are suffisant.
when the SNR is high, or for large data-sets (&gt;8k) more iterations might be needed</p>
</div></blockquote>
<dl class="simple">
<dt>HTratio:    number of lines left by HT/projection - usually a few % of the whole spectrum</dt><dd><p>default is 0.01 ( 1% )</p>
</dd>
<dt>rank<span class="classifier">a rough estimate of the number of lines present in the FT spectrum of the FID - not stringent -</span></dt><dd><p>if in doubt, use a slightly larger value.</p>
</dd>
<dt>Lthresh<span class="classifier">the multiplier for HT/threshold, usually 2.0</span></dt><dd><p>lower recovers more weak signals but requires more iterations
higher requires less iteration but look only to larger peaks.</p>
</dd>
<dt>sampling<span class="classifier">if provided, the sampling index list and npkd is supposed to be zerofilled (missing values set to zero)</span></dt><dd><p>if None, npkd.axis1.sampled should be True, and sampling it will be fetched via npkd.axis1.get_sampling()</p>
</dd>
<dt>final: the final step after iterations,</dt><dd><p>default is ‘SANE’: better (noise-less) data-sets, the best reconstruction quality in simulations
‘PG’ to reapply PG step - produces the cleanest/more compressible data-sets
‘Reinject’: the closest to acquired data - to use if there is very little noise.</p>
</dd>
</dl>
<p>size: if different from None, pg_sane will also extrapolate to size</p>
</dd></dl>

<dl class="class">
<dt id="spike.plugins.pg_sane.sane_pgTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.pg_sane.</code><code class="sig-name descname">sane_pgTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#sane_pgTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.sane_pgTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.pg_sane.sane_pgTests.test_NUS_sampling">
<code class="sig-name descname">test_NUS_sampling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#sane_pgTests.test_NUS_sampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.sane_pgTests.test_NUS_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>NUS example
removing the sampling noise</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.pg_sane.sane_pgTests.test_NUS_sampling2">
<code class="sig-name descname">test_NUS_sampling2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/pg_sane.html#sane_pgTests.test_NUS_sampling2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.pg_sane.sane_pgTests.test_NUS_sampling2" title="Permalink to this definition">¶</a></dt>
<dd><p>NUS larger example
removing the sampling noise</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-spike.plugins.rem_ridge">
<span id="spike-plugins-rem-ridge-module"></span><h2>spike.plugins.rem_ridge module<a class="headerlink" href="#module-spike.plugins.rem_ridge" title="Permalink to this headline">¶</a></h2>
<p>removes ridges in 2D</p>
<p>Created by Marc-André on 2011-08-15.
Copyright (c) 2011 IGBMC. All rights reserved.</p>
<dl class="function">
<dt id="spike.plugins.rem_ridge.rem_ridge">
<code class="sig-prename descclassname">spike.plugins.rem_ridge.</code><code class="sig-name descname">rem_ridge</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/rem_ridge.html#rem_ridge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.rem_ridge.rem_ridge" title="Permalink to this definition">¶</a></dt>
<dd><p>This function removes a F1 ridge by evaluating a mean avalue over the last 10% data of each column of a 2D</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.sane">
<span id="spike-plugins-sane-module"></span><h2>spike.plugins.sane module<a class="headerlink" href="#module-spike.plugins.sane" title="Permalink to this headline">¶</a></h2>
<p>plugin for Sane denoising</p>
<p>This plugin implements the SANE denoising algorithm, 
SANE is inspired from urQRd algorithm, but is improved in several points</p>
<ul class="simple">
<li><p>faster on vector length != 2**n</p></li>
<li><p>much more efficient on weak signals</p></li>
<li><p>requires less iterations and less overestimate of rank</p></li>
<li><p>however, a non productive iteration is always performed,
so processing time for I iterations of SANE should be compared
with I+1 iterations of urQRd.</p></li>
</ul>
<p>associated publications
- Bray, F., Bouclon, J., Chiron, L., Witt, M., Delsuc, M.-A., &amp; Rolando, C. (2017).</p>
<blockquote>
<div><p>Nonuniform Sampling Acquisition of Two-Dimensional Fourier Transform Ion Cyclotron Resonance Mass Spectrometry for Increased Mass Resolution of Tandem Mass Spectrometry Precursor Ions.
Analytical Chemistry, acs.analchem.7b01850. <a class="reference external" href="http://doi.org/10.1021/acs.analchem.7b01850">http://doi.org/10.1021/acs.analchem.7b01850</a></p>
</div></blockquote>
<ul class="simple">
<li><p>Chiron, L., van Agthoven, M. A., Kieffer, B., Rolando, C., &amp; Delsuc, M.-A. (2014).
Efficient denoising algorithms for large experimental datasets and their applications in Fourier transform ion cyclotron resonance mass spectrometry.
PNAS , 111(4), 1385–1390. <a class="reference external" href="http://doi.org/10.1073/pnas.1306700111">http://doi.org/10.1073/pnas.1306700111</a></p></li>
</ul>
<dl class="function">
<dt id="spike.plugins.sane.sane_plugin">
<code class="sig-prename descclassname">spike.plugins.sane.</code><code class="sig-name descname">sane_plugin</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">rank</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">axis=0</em>, <em class="sig-param">trick=True</em>, <em class="sig-param">optk=False</em>, <em class="sig-param">ktrick=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/sane.html#sane_plugin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.sane.sane_plugin" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply “sane” denoising to data
rank is about 2 x number_of_expected_lines
Manages real and complex cases.
Handles the case of hypercomplex for denoising of 2D FTICR for example.</p>
<p>sane algorithm. Name stands for Support Selection for Noise Elimination.
From a data series return a denoised series denoised
data : the series to be denoised - a (normally complex) numpy buffer
rank : the rank of the analysis
orda : is the order of the analysis</p>
<blockquote>
<div><p>internally, a Hankel matrix (M,N) is constructed, with M = orda and N = len(data)-orda+1
if None (default) orda = (len(data)+1)/2</p>
</div></blockquote>
<p>iterations : the number of time the operation should be repeated
optk : if set to True will calculate the rank giving the best recovery for an automatic estimated noise level. 
trick : permits to enhanced the denoising by using a cleaned signal as the projective space. “Support Selection”
ktrick : if a value is given, it permits to change the rank on the second pass.</p>
<blockquote>
<div><p>The idea is that for the first pass a rank large enough as to be used to compensate for the noise while
for the second pass a lower rank can be used.</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.sg">
<span id="spike-plugins-sg-module"></span><h2>spike.plugins.sg module<a class="headerlink" href="#module-spike.plugins.sg" title="Permalink to this headline">¶</a></h2>
<p>set of function Savitsky-Golay smoothing</p>
<dl class="function">
<dt id="spike.plugins.sg.sg">
<code class="sig-prename descclassname">spike.plugins.sg.</code><code class="sig-name descname">sg</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">window_size</em>, <em class="sig-param">order</em>, <em class="sig-param">deriv=0</em>, <em class="sig-param">axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/sg.html#sg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.sg.sg" title="Permalink to this definition">¶</a></dt>
<dd><p>applies Savitzky-Golay of order filter to data
window_size : int</p>
<blockquote>
<div><p>the length of the window. Must be an odd integer number.</p>
</div></blockquote>
<dl class="simple">
<dt>order<span class="classifier">int</span></dt><dd><p>the order of the polynomial used in the filtering.
Must be less than <cite>window_size</cite> - 1.</p>
</dd>
<dt>deriv: int</dt><dd><p>the order of the derivative to compute (default = 0 means only smoothing)</p>
</dd>
<dt>axis: int</dt><dd><p>the axis on which the filter is to be applied, default is fastest varying dimension</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.sg.sg2D">
<code class="sig-prename descclassname">spike.plugins.sg.</code><code class="sig-name descname">sg2D</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">window_size</em>, <em class="sig-param">order</em>, <em class="sig-param">deriv=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/sg.html#sg2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.sg.sg2D" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a 2D Savitzky-Golay of order filter to data
window_size : int</p>
<blockquote>
<div><p>the length of the square window. Must be an odd integer number.</p>
</div></blockquote>
<dl class="simple">
<dt>order<span class="classifier">int</span></dt><dd><p>the order of the polynomial used in the filtering.
Must be less than <cite>window_size</cite> - 1.</p>
</dd>
<dt>deriv: None, ‘col’, or ‘row’.   ‘both’ mode does not work.</dt><dd><p>the direction of the derivative to compute (default = None means only smoothing)</p>
</dd>
</dl>
<p>can be applied to a 2D only.</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.test">
<span id="spike-plugins-test-module"></span><h2>spike.plugins.test module<a class="headerlink" href="#module-spike.plugins.test" title="Permalink to this headline">¶</a></h2>
<p>Test procedure for plugins</p>
<dl class="function">
<dt id="spike.plugins.test.fake">
<code class="sig-prename descclassname">spike.plugins.test.</code><code class="sig-name descname">fake</code><span class="sig-paren">(</span><em class="sig-param">dd</em>, <em class="sig-param">title</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/test.html#fake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.test.fake" title="Permalink to this definition">¶</a></dt>
<dd><p>fake method</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.urQRd">
<span id="spike-plugins-urqrd-module"></span><h2>spike.plugins.urQRd module<a class="headerlink" href="#module-spike.plugins.urQRd" title="Permalink to this headline">¶</a></h2>
<p>plugin for the urQRd denoising method</p>
<dl class="class">
<dt id="spike.plugins.urQRd.urQRdTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.urQRd.</code><code class="sig-name descname">urQRdTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/urQRd.html#urQRdTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.urQRd.urQRdTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.urQRd.urqrd">
<code class="sig-prename descclassname">spike.plugins.urQRd.</code><code class="sig-name descname">urqrd</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">k</em>, <em class="sig-param">orda=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/urQRd.html#urqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.urQRd.urqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply urQRd denoising to data
k is about 2 x number_of_expected_lines
Manages real and complex cases.
Handles the case of hypercomplex for denoising of 2D FTICR for example.</p>
</dd></dl>

</div>
<div class="section" id="module-spike.plugins.wavelet">
<span id="spike-plugins-wavelet-module"></span><h2>spike.plugins.wavelet module<a class="headerlink" href="#module-spike.plugins.wavelet" title="Permalink to this headline">¶</a></h2>
<p>A plugin which install wavelet denoising</p>
<p>This plugin is based on the PyWavelet library, which should be installed independently before trying to use this plugin
It can be found at: <a class="reference external" href="http://www.pybytes.com/pywavelets/">http://www.pybytes.com/pywavelets/</a></p>
<p>M-A Delsuc april 2016 from an idea by L Chiron</p>
<dl class="class">
<dt id="spike.plugins.wavelet.WaveLetTest">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.wavelet.</code><code class="sig-name descname">WaveLetTest</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#WaveLetTest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.WaveLetTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<ul class="simple">
<li><p>Testing Wavelet plugin-</p></li>
</ul>
<dl class="method">
<dt id="spike.plugins.wavelet.WaveLetTest.announce">
<code class="sig-name descname">announce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#WaveLetTest.announce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.WaveLetTest.announce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="spike.plugins.wavelet.WaveLetTest.setUp">
<code class="sig-name descname">setUp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#WaveLetTest.setUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.WaveLetTest.setUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

<dl class="method">
<dt id="spike.plugins.wavelet.WaveLetTest.test_wave">
<code class="sig-name descname">test_wave</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#WaveLetTest.test_wave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.WaveLetTest.test_wave" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>testing wavelet -</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.wavelet.denoise1D">
<code class="sig-prename descclassname">spike.plugins.wavelet.</code><code class="sig-name descname">denoise1D</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">noiseSigma</em>, <em class="sig-param">wavelet='db3'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#denoise1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.denoise1D" title="Permalink to this definition">¶</a></dt>
<dd><p>performed the 1D denoising
data : a 1D numpy array
wavelet : the wavelet basis used,</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.wavelet.denoise2D">
<code class="sig-prename descclassname">spike.plugins.wavelet.</code><code class="sig-name descname">denoise2D</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">noiseSigma</em>, <em class="sig-param">wavelet='db3'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#denoise2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.denoise2D" title="Permalink to this definition">¶</a></dt>
<dd><p>performed the 2D denoising
data : a 2D numpy array
wavelet : the wavelet basis used</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.wavelet.ilog2">
<code class="sig-prename descclassname">spike.plugins.wavelet.</code><code class="sig-name descname">ilog2</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#ilog2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.ilog2" title="Permalink to this definition">¶</a></dt>
<dd><p>integer log2 definition</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.wavelet.wavelet">
<code class="sig-prename descclassname">spike.plugins.wavelet.</code><code class="sig-name descname">wavelet</code><span class="sig-paren">(</span><em class="sig-param">npkd</em>, <em class="sig-param">nsigma=1.0</em>, <em class="sig-param">wavelet='db3'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins/wavelet.html#wavelet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.wavelet.wavelet" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the wavelet denoising of a 1D or 2D spectrum.</p>
<dl class="simple">
<dt>nsigma  the threshold is nsigma times the estimate noise level,</dt><dd><p>default 1.0 - corresponds to a relatively strong denoising</p>
</dd>
<dt>wavelet the wavelet basis used, default ‘db3’ (Daubechies 3)</dt><dd><p>check pywt.wavelist() for the list of possible wavelet</p>
</dd>
</dl>
<p>eg:
d.wavelet(nsigma=0.5)  # d is cleaned after execution</p>
<p>ref: Donoho DL (1995) De-noising by soft-thresholding. IEEE Trans Inf Theory 41:613–621.</p>
<p>Based on the PyWavelet library</p>
</dd></dl>

</div>
<div class="section" id="spike-plugins-zoom3d-module">
<h2>spike.plugins.zoom3D module<a class="headerlink" href="#spike-plugins-zoom3d-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spike.plugins">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spike.plugins" title="Permalink to this headline">¶</a></h2>
<p>Plug-ins for the Spike package</p>
<p>All the plugin files located in the spike/plugins folder are loaded automatically 
when import importing spike the first time.</p>
<p>the variable spike.plugins.plugins contains the list of the loaded plugin modules.</p>
<p>It is allways possible to load a plugin afterward by import a plugin definition at a later time during run-time.</p>
<p>Each plugin file should define the needed functions :</p>
<dl class="simple">
<dt>def myfunc(npkdata, args):</dt><dd><p>“myfunc doc”
…do whatever, assuming npkdata is a NPKData
return npkdata     # THIS is important, that is the standard NPKData mechanism</p>
</dd>
</dl>
<p>and register them into NPKData as follows :
NPKData_plugin(“myname”, myfunc)</p>
<p>then, any NPKData will inherit the myname() method</p>
<p>For the moment, only NPKData plugins are handled.</p>
<dl class="class">
<dt id="spike.plugins.PluginTests">
<em class="property">class </em><code class="sig-prename descclassname">spike.plugins.</code><code class="sig-name descname">PluginTests</code><span class="sig-paren">(</span><em class="sig-param">methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins.html#PluginTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PluginTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<dl class="method">
<dt id="spike.plugins.PluginTests.test_plugin">
<code class="sig-name descname">test_plugin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins.html#PluginTests.test_plugin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.PluginTests.test_plugin" title="Permalink to this definition">¶</a></dt>
<dd><p>Test of plugin mechanism</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spike.plugins.load">
<code class="sig-prename descclassname">spike.plugins.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">debug=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.load" title="Permalink to this definition">¶</a></dt>
<dd><p>the load() function is called at initialization, and loads all files found in the plugins folder</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.loadone">
<code class="sig-prename descclassname">spike.plugins.</code><code class="sig-name descname">loadone</code><span class="sig-paren">(</span><em class="sig-param">pluginname</em>, <em class="sig-param">pgfile=None</em>, <em class="sig-param">debug=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins.html#loadone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.loadone" title="Permalink to this definition">¶</a></dt>
<dd><p>loads the plugin “pluginname” found in file pgfile
if pgfile is None, the file is found in the plugins folder (without the .py extension)</p>
</dd></dl>

<dl class="function">
<dt id="spike.plugins.report">
<code class="sig-prename descclassname">spike.plugins.</code><code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">module=None</em>, <em class="sig-param">mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spike/plugins.html#report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spike.plugins.report" title="Permalink to this definition">¶</a></dt>
<dd><p>print a nice report
mode=choose the verbosity</p>
<blockquote>
<div><p>“short”: only one line (default) 
“detailed”: with list of all added methods
“full”: prints the whole plugin doc</p>
</div></blockquote>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">spike</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Readme.html">What is SPIKE ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#how-do-i-get-spike">How do I get SPIKE ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Readme.html#developing-for-spike">Developing for SPIKE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Doc.html">First contact SPIKE</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="spike.html">spike package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="spike.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="spike.Algo.html">spike.Algo package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Display.html">spike.Display package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.File.html">spike.File package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Interactive.html">spike.Interactive package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.Miscellaneous.html">spike.Miscellaneous package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">spike.plugins package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.util.html">spike.util package</a></li>
<li class="toctree-l3"><a class="reference internal" href="spike.v1.html">spike.v1 package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.FTICR">spike.FTICR module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.FTMS">spike.FTMS module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NMR">spike.NMR module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKConfigParser">spike.NPKConfigParser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKData">spike.NPKData module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.NPKError">spike.NPKError module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.Orbitrap">spike.Orbitrap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.Tests">spike.Tests module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.dev_setup">spike.dev_setup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.processing">spike.processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.version">spike.version module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike.version_rev">spike.version_rev module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spike.html#module-spike">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">SPIKE Relase Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html">SPIKE License</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html#secondary-licenses">Secondary Licenses</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="spike.html">spike package</a><ul>
      <li>Previous: <a href="spike.Miscellaneous.html" title="previous chapter">spike.Miscellaneous package</a></li>
      <li>Next: <a href="spike.util.html" title="next chapter">spike.util package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2010-2019, IGBMC and others.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/spike.plugins.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>