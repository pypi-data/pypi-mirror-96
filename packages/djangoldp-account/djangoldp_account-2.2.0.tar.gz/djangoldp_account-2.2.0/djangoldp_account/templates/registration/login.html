{% extends "base.html" %}
{% load i18n %}
{% load static %}

{% block title %}
    {% trans "Se connecter" %}
{% endblock %}

{% block supplementary_css %}
    <link rel="stylesheet" href="{% static 'registration/login.css' %}"/>
{% endblock %}

{% block content %}
    {% if next %}
        <div class="sib-login-title">
            {% if user.is_authenticated %}
                <h2 class="text-center">
                    {% blocktrans %}
                        Ton compte n'a pas accès à cette page. 
                        Pour continuer, connecte-toi avec un compte qui y a accès.
                    {% endblocktrans %}
                </h2>
            {% else %}
                <h2 class="text-center">{% trans "Connecte-toi pour voir cette page." %}</h2>
            {% endif %}
        </div>
    {% endif %}

    <div class="sib-login-forms">
        <div class="flex-column">
            {% if form.errors %}
                <p class="error text-center">{% trans "Ton nom d'utilisateur et ton mot de passe ne correspondent pas. Réessaye." %}</p>
            {% endif %}
            <form class="flex-column" method="post" action="{% url 'login' %}">
                {% csrf_token %}
                <div class="input-line">
                    <label for="id_username">{%  trans "Nom d'utilisateur ou e-mail:" %}</label>
                    {{ form.username }}
                </div>
                <div class="input-line">
                    {{ form.password.label_tag }}
                    {{ form.password }}
                </div>
                <input type="submit" class="connection-btn" value="{% trans 'Se connecter' %}"/>
                <input type="hidden" name="next" value="{{ next }}"/>
            </form>
            <a class="sib-link" href="{% url 'password_reset' %}">{% trans "Mot de passe oublié ?" %}</a>
        </div>

        {% if distant_login %}
        <div class="flex-column">
            <p class="other-login-title text-center">{% trans "Se connecter avec un autre fournisseur d'identité" %}</p>

            <form class="flex-column" method="post" action="{% url 'oidc_login' %}">
                {% csrf_token %}
                <label for="id_subject" title="Your webfinger-id or provider url">{% trans "Webfinger :" %}</label>
                <input type="text" name="subject" required id="id_subject"/>
                <input type="submit" value="{% trans 'Se connecter' %}"/>
                <input type="hidden" name="next" value="{{ next }}"/>
            </form>
        </div>
        {% endif %}

        {% if registration_open %}
            <div class="flex-column">
                <p class="other-login-title text-center">{% trans "Tu n'as pas encore de compte ?" %}</p>
                <a class="sib-link sib-register-link" href="{% url 'django_registration_register' %}?next={{next|urlencode}}">{% trans "S'inscrire !" %}</a>
            </div>
        {% endif %}
    </div>
{% endblock %}
