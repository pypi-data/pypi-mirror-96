(self.webpackChunkgreenflowlab=self.webpackChunkgreenflowlab||[]).push([[272],{16272:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FACTORY:()=>ze,IGREENFLOWTracker:()=>Je,cleanIcon:()=>Ue,default:()=>Xe,gqIcon:()=>Fe,isEnabled:()=>Ye,isLinkedView:()=>Ke,layoutIcon:()=>$e,runIcon:()=>Pe,setupContextMenu:()=>Ze});var o={};n.r(o),n.d(o,{GreenflowModel:()=>We,GreenflowView:()=>Me});var s=n(32685),i=n(2145),a=n(62045),r=n(64532),d=n(41797);const l="0.1.0",c="greenflowlab";var h=n(87708),p=n(80629),u=n(52683);async function m(e="",t={}){const n=u.ServerConnection.makeSettings(),o=p.URLExt.join(n.baseUrl,"greenflowlab",e);let s;try{s=await u.ServerConnection.makeRequest(o,t,n)}catch(e){throw new u.ServerConnection.NetworkError(e)}let i=await s.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",s)}if(!s.ok)throw new u.ServerConnection.ResponseError(s,i.message||i);return i}var g=n(41915),f=n(64520),y=n(56271),w=n.n(y),C=n(85499),b=n(93320),x=n.n(b),v=n(10323);const _={};function k(e,t){_[e]=t}function S(e){return function(t){e.tooltip.transition().delay(30).duration(200).style("opacity",1),e.tooltip.html(function(e){const t=Object.keys(e)[0];let n=`<div>Port: ${t.split(".")[1]}</div>`;const o=e[t].portType;let s="<ul>";for(let e=0;e<o.length;e++)s+=`<li>${o[e][0]}</li>`;return s+="</ul>",n+=`<div>Port Type:${s}</div>`,n+=function(e,t){const n=e[t].content;let o="";return e[t].portType.forEach((e=>{e[0]in _&&(o=_[e[0]](n))})),o}(e,t),n}(t)).style("left",e.mousePage.x+25+"px").style("top",e.mousePage.y+"px"),v.select(this).transition().delay(20).duration(200).attr("r",e.circleRadius+1).style("opacity",1)}}function H(e){return function(t){e.tooltip.style("opacity",0).style("left","-1000px").style("top","-1000px"),v.select(this).transition().delay(20).attr("r",e.circleRadius).duration(200)}}function N(e,t,n){return function(e){v.select(this).style("cursor",n),v.select(this.parentNode).attr("stroke",t)}}function I(e){return function(e){v.select(this).style("cursor","default"),v.select(this.parentNode).attr("stroke",null)}}function R(e,t){let n=0,o=0;return v.drag().on("start",(function(e){v.select(this.parentNode).attr("stroke","black"),n=v.event.x,o=v.event.y})).on("drag",(function(e){const[s,i]=v.mouse(this.parentNode.parentNode);v.select(this.parentNode).raise().attr("transform",((e,t)=>`translate(${e.x=s-n}, ${e.y=i-o})`)),t.link=t.link.data(t.edgeData()).join("line").attr("x1",(e=>e.source.x)).attr("y1",(e=>e.source.y)).attr("x2",(e=>e.target.x)).attr("y2",(e=>e.target.y))})).on("end",(function(n){v.select(this.parentNode).attr("stroke",null),e({nodes:t.bars.data()})}))}const E={};function T(e,t){const n=Object.keys(e);for(let o=0;o<n.length;o++){const s=n[o];if(!(s in t)||null!==t[s]&&null!==e[s]&&e[s]!==t[s])return!1}return!0}function O(e){return function(t,n){if(t===n)return!0;if(t.split(".")[0]===n.split(".")[0])return!1;if(e.outputPorts.has(t)){if(!e.inputPorts.has(n))return!1;if(e.props.edges.findIndex((e=>e.to===n))>=0)return!1;const o=e.portTypes[n],s=e.portTypes[t];if(o.findIndex((e=>"any"===e[0]))<0&&s.findIndex((e=>"any"===e[0]))<0&&!o.some((e=>s.some((t=>t.includes(e[0]))))))return!1;if(t in e.outputMeta&&n in e.inputRequriements){let s=!1;for(let i=0;i<o.length;i++)if(o[i][0]in E)return s=!0,E[o[i][0]](e.inputRequriements[n],e.outputMeta[t]);if(!s)return T(e.inputRequriements[n],e.outputMeta[t])}else if(!(t in e.outputMeta)&&n in e.inputRequriements)return T(e.inputRequriements[n],{})}else{if(!e.outputPorts.has(n))return!1;if(e.props.edges.findIndex((e=>e.to===t))>=0)return!1;const o=e.portTypes[n],s=e.portTypes[t];if(o.findIndex((e=>"any"===e[0]))<0&&s.findIndex((e=>"any"===e[0]))<0&&!s.some((e=>o.some((t=>t.includes(e[0]))))))return!1;if(n in e.outputMeta&&t in e.inputRequriements){let o=!1;for(let i=0;i<s.length;i++)if(s[i][0]in E)return o=!0,E[s[i][0]](e.inputRequriements[t],e.outputMeta[n]);if(!o)return T(e.inputRequriements[t],e.outputMeta[n])}else if(!(n in e.outputMeta)&&t in e.inputRequriements)return T(e.inputRequriements[t],{})}return!0}}function j(e){return function(t){console.log("mouse up"),v.event.stopPropagation(),v.event.preventDefault();let n=v.select(this.parentNode).attr("group");if(e.starting){const o=v.select(this.parentNode).datum().id;n=v.select(this.parentNode).attr("group");const s=Object.keys(t)[0].split(".")[1];if("outputs"===n){if("inputs"===e.starting.groupName){const t={from:o+"."+s,to:e.starting.from},n=e.props.edges.findIndex((e=>e.from===t.from&&e.to===t.to));n>=0?e.props.edges.splice(n,1):O(e)(t.from,t.to)&&e.props.edges.push(t),e.connectionUpdate(),e.isDirty=!1}}else if("outputs"===e.starting.groupName){const t={from:e.starting.from,to:o+"."+s},n=e.props.edges.findIndex((e=>e.from===t.from&&e.to===t.to));n>=0?e.props.edges.splice(n,1):O(e)(t.from,t.to)&&e.props.edges.push(t),e.connectionUpdate(),e.isDirty=!1}e.starting=null}e.drawCircles()}}function A(e){return function(t){console.log("mouse down"),v.event.stopPropagation(),v.event.preventDefault();let n=v.select(this.parentNode).attr("group");const o=Object.keys(t)[0],s=v.select(this.parentNode).datum().id;n=v.select(this.parentNode).attr("group");const i=Object.keys(t)[0].split(".")[1];if(e.starting={from:s+"."+i,groupName:n,point:null},"inputs"===n){const t=e.props.edges.findIndex((e=>e.to===o));t>=0&&(e.starting={from:e.props.edges[t].from,groupName:"outputs",point:null},e.props.edges.splice(t,1),e.drawLinks(),e.isDirty=!0)}else{const t=e.props.edges.findIndex((e=>e.from===o));t>=0&&(e.starting={from:e.props.edges[t].to,groupName:"inputs",point:null},e.props.edges.splice(t,1),e.drawLinks(),e.isDirty=!0)}"outputs"===e.starting.groupName?e.starting.point=e.translateCorr(e.starting.from,!0):e.starting.point=e.translateCorr(e.starting.from,!1),e.drawCircles()}}var L=n(60802),D=n(66510),G=n(15973),W=n.n(G),M=n(44339),B=n.n(M),q=(n(72814),n(93379)),z=n.n(q),F=n(28856);z()(F.Z,{insert:"head",singleton:!1}),F.Z.locals;class P extends w().Component{constructor(e){super(e)}render(){const e=W().input`
      width: 100%;
    `,t=W().div`
      width: 100%;
    `;return this._id='taskgraph_editor_"'+Math.random().toString(36).substring(2,15),w().createElement(t,null,w().createElement(e,{id:this._id,type:"text",className:"custom",value:this.props.value,required:this.props.required,onChange:e=>this.props.onChange(e.target.value),onClick:e=>{this.props.formContext.commandRegistry&&this.props.formContext.commandRegistry.execute(te,{filter:[".gq.yaml"]}).then((e=>{e&&this.props.onChange(e.path)}))}}),w().createElement("button",{onClick:()=>{const e=document.getElementById(this._id);this.props.formContext.commandRegistry&&this.props.formContext.commandRegistry.execute(be,{path:e.value})}},"Show Taskgraph"))}}class U extends w().Component{constructor(e){super(e)}render(){const e=W().input`
      width: 100%;
    `;return w().createElement(e,{type:"text",className:"custom",value:this.props.value,required:this.props.required,onChange:e=>this.props.onChange(e.target.value),onClick:e=>{this.props.formContext.commandRegistry&&this.props.formContext.commandRegistry.execute(te,{filter:[".csv",".csv.gz"]}).then((e=>{e&&this.props.onChange(e.path)}))}})}}class $ extends w().Component{constructor(e){super(e)}render(){const e=W().input`
      width: 100%;
    `;return w().createElement(e,{type:"text",className:"custom",value:this.props.value,required:this.props.required,onChange:e=>this.props.onChange(e.target.value),onClick:e=>{this.props.formContext.commandRegistry&&this.props.formContext.commandRegistry.execute(te).then((e=>{e&&this.props.onChange(e.path)}))}})}}class J extends w().Component{constructor(e){super(e)}render(){const e=W().input`
      width: 100%;
    `;return w().createElement(e,{type:"text",className:"custom",value:this.props.value,required:this.props.required,onChange:e=>this.props.onChange(e.target.value),onClick:e=>{console.log("event"),console.log(this.props),this.props.formContext.commandRegistry&&this.props.formContext.commandRegistry.execute(ne).then((e=>{e&&this.props.onChange(e.path)}))}})}}class V extends w().Component{constructor(e){super(e),this.handleSave=this.handleSave.bind(this),this.handleDelete=this.handleDelete.bind(this),this.handleClone=this.handleClone.bind(this),this.handleConvert=this.handleConvert.bind(this),this.myRef=w().createRef()}_bugWorkaround(e){const t=e=>{Object.keys(e).forEach((n=>{if("indicators"===n){const t=e[n];Array.isArray(t)&&t.forEach((e=>{console.log(e);let t=0,n=-1;Object.keys(e).forEach((e=>{if(e.startsWith("function.")){t+=1;const o=parseInt(e.split(".")[1]);n<o&&(n=o)}})),t>0&&(console.log("found dup"),Object.keys(e).forEach((t=>{parseInt(t.split(".")[1])!==n&&delete e[t]})))}))}"object"==typeof e[n]&&t(e[n])}))};t(e)}handleSave(e){const t=this.props.nodeDatum.id,n=this.props.nodes.filter((e=>e.id!==t)),o=this.myRef.current.value;if(n.findIndex((e=>e.id===o))>=0)return void window.alert(`the node id ${o} is not unique`);const s=this.props.edges.map((e=>{let n=e.from.split(".")[0];return n===t&&(e.from=o+"."+e.from.split(".")[1]),n=e.to.split(".")[0],n===t&&(e.to=o+"."+e.to.split(".")[1]),e})),i=this.props.nodes.map((n=>(n.id===t&&(n.id=o,n.conf=e.formData),n)));this.props.setChartState({nodes:i,edges:s})}handleDelete(){const e=this.props.nodeDatum.id,t=this.props.nodes.filter((t=>t.id!==e)),n=this.props.edges.filter((t=>t.from.split(".")[0]!==e&&t.to.split(".")[0]!==e));this.props.setChartState({nodes:t,edges:n}),this.props.handler.updateEditor.emit({nodes:[],nodeDatum:{},edges:[],setChartState:null,handler:this.props.handler})}handleClone(){const e=JSON.parse(JSON.stringify(this.props.nodeDatum));e.id=Math.random().toString(36).substring(2,15),e.x+=20,e.y+=20,this.props.nodes.push(e),this.props.setChartState({nodes:this.props.nodes,edges:this.props.edges})}handleConvert(){f.InputDialog.getText({title:"Provide a customized Node name"}).then((e=>{console.log("text "+e.value),this.props.handler.commandRegistry.execute(xe,{nodeName:e.value,conf:this.props.nodeDatum.conf})}))}render(){const e={FileSelector:$,PathSelector:J,TaskgraphSelector:P,CsvFileSelector:U},t=W().div`
      text-align: left;
      padding: 10px;
      background-color: yellowgreen;
      overflow-y: auto;
      height: 100%;
    `;return null===this.props.setChartState?w().createElement(t,null,w().createElement("h2",null,"Click on the Task Node to Edit")):this.props.nodeDatum.id===Ee?w().createElement(t,null,w().createElement("button",{className:"btn btn-danger",onClick:this.handleDelete},"Delete")):"CompositeNode"===this.props.nodeDatum.type?w().createElement(t,null,w().createElement("div",null,w().createElement("span",null,"Node id:"),w().createElement("input",{type:"text",placeholder:"unique node name",defaultValue:this.props.nodeDatum.id,ref:this.myRef})),w().createElement(B(),{schema:this.props.nodeDatum.schema,formData:this.props.nodeDatum.conf,uiSchema:this.props.nodeDatum.ui,onSubmit:this.handleSave,widgets:e,formContext:this.props.handler}),w().createElement("button",{className:"btn btn-primary",onClick:this.handleConvert},"Convert it To Node"),w().createElement("button",{className:"btn btn-primary",onClick:this.handleClone},"Clone"),w().createElement("button",{className:"btn btn-danger",onClick:this.handleDelete},"Delete")):w().createElement(t,null,w().createElement("div",null,w().createElement("span",null,"Node id:"),w().createElement("input",{type:"text",placeholder:"unique node name",defaultValue:this.props.nodeDatum.id,ref:this.myRef})),w().createElement(B(),{schema:this.props.nodeDatum.schema,formData:this.props.nodeDatum.conf,uiSchema:this.props.nodeDatum.ui,onSubmit:this.handleSave,widgets:e,formContext:this.props.handler}),w().createElement("button",{className:"btn btn-primary",onClick:this.handleClone},"Clone"),w().createElement("button",{className:"btn btn-danger",onClick:this.handleDelete},"Delete"))}}const K=V;class Y extends f.ReactWidget{constructor(e){super(),this._contentHandler=e,this.id="jp-Greenflow-NodeEditor",this.addClass("jp-Greenflow-first")}get contentHandler(){return this._contentHandler}render(){return w().createElement(w().Fragment,null,w().createElement(f.UseSignal,{signal:this._contentHandler.updateEditor,initialArgs:{edges:[],nodeDatum:{},setChartState:null,nodes:[],handler:null}},((e,t)=>w().createElement(K,{handler:t.handler,nodeDatum:t.nodeDatum,setChartState:t.setChartState,nodes:t.nodes,edges:t.edges}))))}}class Z extends D.StackedPanel{constructor(e){super(),this._handler=e,this.addClass("jp-RovaPanel"),this.id="greenflow-editor-panel",this.title.label="Node Editor",this.title.closable=!0,this._example=new Y(this._handler),this.addWidget(this._example)}onResize(e){console.log("here"),console.log(e)}dispose(){super.dispose()}get handler(){return this._handler}}var X=n(19850);const Q="greenflow:convertCellToFile",ee="greenflow:toolbarConvertCellToFile",te="greenflow:selectTheFile",ne="greenflow:selectThePath",oe="greenflow:openNewFile",se="greenflow:includeNewFile",ie="greenflow:includeNewFile",ae="greenflow:toolbaropenTaskGraph",re="greenflow:export-yaml",de="greenflow:create-new",le="greenflow:openeditor",ce="greenflow:openAnNewNotebook",he="greenflow:addnode",pe="greenflow:reLayout",ue="greenflow:toolbarReLayout",me="greenflow:aspect",ge="greenflow:execute",fe="greenflow:cleanResult",ye="greenflow:toolbarexecute",we="greenflow:toolbarcleanResult",Ce="greenflow:addOutputCollector",be="greenflow:openDocumentForward",xe="greenflow:createCustomizedNode",ve="greenflow:showLogBox";function _e(){return Math.random().toString(36).substring(2,15)}class ke extends w().Component{constructor(e){super(e),this.myRef=w().createRef(),this.mouse=null,this.mousePage=null,this.starting=null,this.tooltip=null,this.textHeight=25,this.circleHeight=20,this.circleRadius=8,this.bars=null,this.svg=null,this.transform=null,this.link=null,this.mouseLink=null,this.g=null,this.isDirty=!1,this.state={x:-1e3,y:-1e3,opacity:0,nodeDatum:null},this.inputPorts=new Set,this.outputPorts=new Set,this.inputRequriements={},this.outputMeta={},this.portTypes={},this.props.contentHandler.reLayoutSignal.connect(this.nodeReLayout,this),this.props.contentHandler.nodeAddedSignal.connect(this.addNewNode,this)}portMap(){this.inputPorts=new Set,this.outputPorts=new Set,this.inputRequriements={},this.outputMeta={},this.props.nodes.forEach((e=>{const t=e.id;e.inputs.forEach((e=>{this.inputPorts.add(t+"."+e.name),this.portTypes[t+"."+e.name]=e.type})),e.outputs.forEach((e=>{this.outputPorts.add(t+"."+e.name),this.portTypes[t+"."+e.name]=e.type}));let n=Object.keys(e.required);n.forEach((n=>{this.inputRequriements[t+"."+n]=e.required[n]})),n=Object.keys(e.output_meta),n.forEach((n=>{this.outputMeta[t+"."+n]=e.output_meta[n]}))}))}translateCorr(e,t=!1){const n=e.split("."),o=n[0],s=n[1],i=this.props.nodes.filter((e=>e.id===o))[0];if(t){const e=i.outputs.findIndex((e=>e.name===s));return{x:i.x+i.width,y:i.y+(e+.4)*this.circleHeight+this.textHeight,id:o}}{const e=i.inputs.findIndex((e=>e.name===s));return{x:i.x,y:i.y+(e+.4)*this.circleHeight+this.textHeight,id:o}}}edgeMap(e){return{source:this.translateCorr(e.from,!0),target:this.translateCorr(e.to,!1)}}edgeData(){return this.props.edges.map(this.edgeMap.bind(this))}nodeReLayout(e,t){this.reLayout()}addNewNode(e,t){const n=JSON.parse(JSON.stringify(t));t.id===Ee&&this.props.nodes.findIndex((e=>e.id===Ee))>=0||(n.type===Te?n.id=Ee:n.id=Math.random().toString(36).substring(2,15),n.x=this.mouse?this.mouse.x:0,n.y=this.mouse?this.mouse.y:0,this.transform&&([n.x,n.y]=this.transform.invert([n.x,n.y])),this.props.nodes.push(n),this.props.setChartState({nodes:this.props.nodes,edges:this.props.edges}))}componentWillUnmount(){this.props.contentHandler.reLayoutSignal.disconnect(this.nodeReLayout,this),this.props.contentHandler.nodeAddedSignal.disconnect(this.addNewNode,this)}componentDidMount(){this.tooltip=v.select(this.myRef.current).append("div").attr("class","tooltip").style("opacity",0);const e=v.zoom().scaleExtent([.1,30]).on("zoom",(e=>{this.g.attr("transform",v.event.transform),this.transform=v.event.transform}));var t;this.svg=v.select(this.myRef.current).append("svg").attr("width",this.props.width).attr("height",this.props.height).attr("viewBox",`0 -${.1*this.props.height} ${1.1*this.props.width+300} ${1.1*this.props.height+300}`).attr("font-family","sans-serif").attr("font-size","14").attr("text-anchor","end").on("mouseleave",(function(e){this.mouse=null})).on("mousemove",(t=this,function(e){let[n,o]=v.mouse(this);t.mouse={x:n,y:o},t.mousePage={x:v.event.clientX,y:v.event.clientY};let s=null;t.starting&&(s=t.starting.point);const i=v.zoomTransform(this);[n,o]=i.invert([n,o]),t.mouseLink=t.mouseLink.data(t.starting?["ab"]:[]).join("line").attr("x1",t.starting&&s.x).attr("y1",t.starting&&s.y).attr("x2",t.mouse&&n).attr("y2",t.mouse&&o)})).on("click",function(e){return function(t){if("rect"===v.event.target.tagName||"text"===v.event.target.tagName){const t=v.select(v.event.target.parentNode).datum();e.datum=t,e.renderEditor()}else{console.log("clicked"),e.isDirty&&(e.connectionUpdate(),e.isDirty=!1);const[t,n]=v.mouse(this);e.mouse={x:t,y:n},e.starting=null,e.setState({opacity:0,x:-1e3,y:-1e3})}}}(this)).call(e.bind(this)),this.g=this.svg.append("g"),this.bars=this.g.selectAll("g").data(this.props.nodes),this.link=this.g.append("g").attr("stroke","#999").selectAll("line").data(this.edgeData()).join("line"),this.mouseLink=this.g.append("g").attr("stroke","red").selectAll("line")}drawCircles(){this.bars.selectAll("g").filter(((e,t)=>0===t)).data(((e,t)=>[e])).join("g").attr("transform",((e,t)=>`translate(0, ${this.textHeight})`)).attr("group","inputs").selectAll("circle").data((e=>{const t=[];for(let n=0;n<e.inputs.length;n++)if(e.inputs[n].name in e.required){const o={};o.content=e.required[e.inputs[n].name],o.portType=e.inputs[n].type,t.push({[e.id+"."+e.inputs[n].name]:o})}else{const o={content:{}};o.portType=e.inputs[n].type,t.push({[e.id+"."+e.inputs[n].name]:o})}return t})).join("circle").attr("fill",(e=>{if(!this.starting)return"blue";const t=Object.keys(e)[0];return O(this)(this.starting.from,t)?"blue":"white"})).attr("cx",0).attr("cy",((e,t)=>(t+.4)*this.circleHeight)).attr("r",this.circleRadius).on("mouseover",S(this)).on("mouseout",H(this)).on("mousedown",A(this)).on("mouseup",j(this)),this.bars.selectAll("g").filter(((e,t)=>1===t)).data(((e,t)=>[e])).join("g").attr("transform",((e,t)=>`translate(${e?e.width:0}, ${this.textHeight})`)).attr("group","outputs").selectAll("circle").data((e=>{const t=[];for(let n=0;n<e.outputs.length;n++)if(e.outputs[n].name in e.output_meta){const o={};o.content=e.output_meta[e.outputs[n].name],o.portType=e.outputs[n].type,t.push({[e.id+"."+e.outputs[n].name]:o})}else{const o={content:{}};o.portType=e.outputs[n].type,t.push({[e.id+"."+e.outputs[n].name]:o})}return t})).join("circle").attr("fill",(e=>{if(!this.starting)return"green";const t=Object.keys(e)[0];return O(this)(this.starting.from,t)?"green":"white"})).attr("cx",0).attr("cy",((e,t)=>(t+.4)*this.circleHeight)).attr("r",this.circleRadius).on("mouseover",S(this)).on("mouseout",H(this)).on("mousedown",A(this)).on("mouseup",j(this))}drawLinks(){this.link=this.link.data(this.edgeData()).join("line").attr("x1",(e=>e.source.x)).attr("y1",(e=>e.source.y)).attr("x2",(e=>e.target.x)).attr("y2",(e=>e.target.y))}componentDidUpdate(){this.bars=this.bars.data(this.props.nodes).join("g").attr("transform",((e,t)=>`translate(${e?e.x:0}, ${e?e.y:0})`)),this.bars.selectAll("rect").filter(((e,t)=>0===t)).data(((e,t)=>[{w:e.width,h:this.textHeight+Math.max(e.inputs.length,e.outputs.length)*this.circleHeight,color:e.busy?"red":"steelblue"}])).join("rect").attr("fill",(e=>e.color)).attr("width",(e=>e.w)).attr("height",(e=>e.h)).on("mouseover",N(0,"red","pointer")).on("mouseout",I()),this.bars.selectAll("rect").filter(((e,t)=>1===t)).data(((e,t)=>[{w:e.width,h:this.textHeight}])).join("rect").attr("fill","seagreen").attr("width",(e=>e.w)).attr("height",(e=>e.h)).call(R(this.props.setChartState,this)).on("mouseover",N(0,"black","grab")).on("mouseout",I()),this.bars.selectAll("text").filter(((e,t)=>0===t)).data(((e,t)=>[{w:e.width,id:e.id===Ee?"":e.id}])).join("text").attr("fill","white").attr("x",(e=>e.w)).attr("y",0).attr("dy","1.00em").attr("dx","-1.00em").text((e=>e.id)).call(R(this.props.setChartState,this)).on("mouseover",N(0,"black","grab")).on("mouseout",I()),this.bars.selectAll("text").filter(((e,t)=>1===t)).data(((e,t)=>[{w:e.width,text:e.type}])).join("text").attr("transform",((e,t)=>`translate(0, ${this.textHeight})`)).attr("fill","black").attr("x",((e,t)=>e.w)).attr("y",0).attr("dy","1.00em").attr("dx","-1.00em").text(((e,t)=>e.text)).on("mouseover",N(0,"red","pointer")).on("mouseout",I()),this.drawCircles(),this.drawLinks()}reLayout(){this.props.layout(this.props.nodes,this.props.edges,this.transform)}_fixDynamicPorts(e){const t=[];e.nodes.forEach((e=>{e.inputs.forEach((n=>{"dynamic"in n&&t.push(e.id+"."+n.name)}))})),0!==t.length&&e.edges.forEach((e=>{t.includes(e.to)&&(e.to=e.to.split(".")[0]+"."+e.from.split(".")[0]+"@"+e.from.split(".")[1])}))}_fixOutputCollectorPorts(e){const t=e.nodes.findIndex((e=>e.id===Ee));if(t<0)return;const n=e.edges.filter((e=>e.to.split(".")[0]===Ee));this.props.contentHandler.outputs=n.map((e=>e.from));const o=n.map((e=>e.to.split(".")[1])),s=e.nodes[t],i=o.length+1;s.inputs=[];for(let e=0;e<i;e++)s.inputs.push({name:`in${e+1}`,type:[["any"]]});n.forEach(((e,t)=>{e.to=`${Ee}.in${t+1}`}))}fullUpdate(e,t){this._fixDynamicPorts({nodes:e,edges:t,height:0,width:0}),this._fixOutputCollectorPorts({nodes:e,edges:t,height:0,width:0});const n=Ie(e,t),o=JSON.stringify(n);this._updateInputs(o,e,t)}nodeEditorUpdate(e){this.fullUpdate(e.nodes,e.edges)}renderEditor(){const e={nodeDatum:this.datum,setChartState:this.nodeEditorUpdate.bind(this),nodes:this.props.nodes,edges:this.props.edges,handler:this.props.contentHandler};this.props.contentHandler.commandRegistry&&this.props.contentHandler.commandRegistry.execute(le),this.props.contentHandler.updateEditor.emit(e)}_updateInputs(e,t,n){m("load_graph",{body:e,method:"POST"}).then((e=>{const o={};e.nodes.forEach((e=>{o[e.id]={required:e.required,outputMeta:e.output_meta,inputs:e.inputs,outputs:e.outputs,schema:e.schema,ui:e.ui,conf:e.conf}})),t.forEach((e=>{if(e.id in o){if(e.id===Ee)return;e.required=o[e.id].required,e.output_meta=o[e.id].outputMeta,e.inputs=o[e.id].inputs,e.outputs=o[e.id].outputs,e.schema=o[e.id].schema,e.ui=o[e.id].ui,e.conf=o[e.id].conf}})),this.props.setChartState({nodes:t,edges:n});let s=null;if(this.datum){const e=t.findIndex((e=>e.id===this.datum.id));e>=0?(this.datum=t[e],s={nodeDatum:this.datum,setChartState:this.nodeEditorUpdate.bind(this),nodes:t,edges:n,handler:this.props.contentHandler}):(this.datum={},s={nodeDatum:this.datum,setChartState:null,nodes:[],edges:[],handler:this.props.contentHandler})}this.props.contentHandler.updateEditor.emit(s)}))}connectionUpdate(){this.fullUpdate(this.props.nodes,this.props.edges)}render(){return this.portMap(),this.svg&&this.svg.attr("width",this.props.width).attr("height",this.props.height).attr("viewBox",`0 -${.1*this.props.height} ${1.1*this.props.width+300} ${1.1*this.props.height+300}`),console.log("rendering"),w().createElement("div",{ref:this.myRef})}}function Se(e,t){return e.findIndex((e=>e.id===t))>=0}const He=/-(\d+)$/;function Ne(e){const t=e.match(He);if(t){const n=t[1],o=(parseInt(n)+1).toString(),s=t.index;return e.substr(0,s)+"-"+o}return e+"-1"}function Ie(e,t){const n=e,o=t,s={};for(let e=0;e<o.length;e++){const t=o[e].to.split(".")[0],n=o[e].to.split(".")[1];t in s?s[t][n]=o[e].from:s[t]={[n]:o[e].from}}const i=[];for(let e=0;e<n.length;e++){const t=n[e],o={};o.id=t.id===Ee?"":t.id,o.type=t.type,o.conf=t.conf,t.id in s?o.inputs=s[t.id]:o.inputs={},"filepath"in t&&(o.filepath=t.filepath),"module"in t&&(o.module=t.module),i.push(o)}return i}class Re extends w().Component{constructor(e){super(e),this.state={height:null,width:null,nodes:[],edges:[]},e.contentHandler.contentChanged.connect(this.contentChangeHandler,this),e.contentHandler.chartStateUpdate.connect(this.stateUpdateHandler,this),e.contentHandler.sizeStateUpdate.connect(this.stateHandleResize,this),this.props.contentHandler.contentReset.connect(this.contentResetHandler,this),this.props.contentHandler.saveCache.connect(this.saveCacheHandler,this),this.props.contentHandler.includeContent.connect(this.contentIncludeHandler,this)}componentWillUnmount(){this.props.contentHandler.contentChanged.disconnect(this.contentChangeHandler,this),this.props.contentHandler.chartStateUpdate.disconnect(this.stateUpdateHandler,this),this.props.contentHandler.chartStateUpdate.disconnect(this.stateHandleResize,this),this.props.contentHandler.contentReset.disconnect(this.contentResetHandler,this),this.props.contentHandler.saveCache.disconnect(this.saveCacheHandler,this),this.props.contentHandler.includeContent.disconnect(this.contentIncludeHandler,this)}contentChangeHandler(e,t){if(!t.width&&!t.height)return;const n=this._updateLayout(t.nodes,t.edges,null,t.width?t.width:100,t.height?t.height:100);if(this.props.contentHandler.privateCopy&&this.props.contentHandler.privateCopy.get("cache")&&!this.props.contentHandler.privateCopy.get("cache").nodes&&t.width&&t.height){console.log("empty cache",this.state);const e={nodes:n,edges:t.edges},o=JSON.parse(JSON.stringify(e));this.props.contentHandler.privateCopy.set("cache",o),this.props.contentHandler.privateCopy.save()}this.setState({nodes:n,edges:t.edges,width:t.width?t.width:this.state.width,height:t.height?t.height:this.state.height})}saveCacheHandler(e){if(this.props.contentHandler.privateCopy){const e=JSON.parse(JSON.stringify(this.state));this.props.contentHandler.privateCopy.set("cache",e),this.props.contentHandler.privateCopy.save()}}contentIncludeHandler(e,t){const n=this.state.nodes,o=this.state.edges;let s=!1;t.nodes.forEach((e=>{let o=e.id;if(e.id!==Ee){for(;Se(n,o);)o=Ne(o);o!==e.id&&(t.edges.forEach((t=>{t.from.split(".")[0]===e.id&&(t.from=o+"."+t.from.split(".")[1]),t.to.split(".")[0]===e.id&&(t.to=o+"."+t.to.split(".")[1])})),e.id=o)}else Se(n,o)&&(s=!0)})),n.forEach((e=>{s&&e.id===Ee||t.nodes.push(e)})),o.forEach((e=>{t.edges.push(e)})),this.contentResetHandler(e,t)}contentResetHandler(e,t){const n=this._updateLayout(t.nodes,t.edges,null,this.state.width,this.state.height);this.updateWorkFlow({nodes:n,edges:t.edges,height:this.state.height,width:this.state.width})}stateUpdateHandler(e,t){this.setState({nodes:t.nodes,edges:t.edges})}stateHandleResize(e,t){const n=this._updateLayout(this.state.nodes,this.state.edges,null,t.width,t.height);this.setState({nodes:n,edges:this.state.edges,width:t.width,height:t.height})}_updateLayout(e,t,n,o,s){if(0===e.length)return e;const i={},a={};for(let e=0;e<t.length;e++){const n=t[e].to.split(".")[0],o=t[e].from.split(".")[0];n in i?i[n].findIndex((e=>e===o))<0&&i[n].push(o):i[n]=[o],o in a?a[o].findIndex((e=>e===n))<0&&a[o].push(n):a[o]=[n]}const r="something uniq 24dd8da7-ac82-4b82-aa6b-4d9338ff15b9",d={id:r,width:0,type:"Empty Layout Node",conf:{},required:{},output_meta:[],outputs:[],schema:{},ui:{},inputs:[]},l=JSON.parse(JSON.stringify(e)),c=l.filter(((e,t)=>!(e.id in a)));i[r]=c.map((e=>e.id)),l.push(d);const h=l.map(((e,t)=>(e.id in i?e.parentIds=i[e.id]:e.parentIds=[],e.x=10*t,e.y=10*t,e))),p=(0,C.dagStratify)()(h);return(0,C.sugiyama)().size([s||100,o||100]).layering((0,C.layeringLongestPath)()).decross((0,C.decrossTwoLayer)()).coord((0,C.coordCenter)())(p),p.descendants().forEach((e=>{if(n){const t=n.invert([e.y,e.x]);e.data.y=t[1],e.data.x=t[0]}else e.data.y=e.x,e.data.x=e.y})),h.filter((e=>e.id!==r))}layout(e,t,n){if(0===e.length)return;const o=this._updateLayout(e,t,n,this.state.width,this.state.height);this.setState({nodes:o,edges:t})}updateWorkFlow(e,t=!0){if(e.edges&&e.nodes){const t=Ie(e.nodes,e.edges);if(this.props.contentHandler.privateCopy){this.props.contentHandler.privateCopy.set("value",t);const n=JSON.parse(JSON.stringify(e));this.props.contentHandler.privateCopy.set("cache",n),this.props.contentHandler.privateCopy.save(),console.log("edges:",e.edges.length,"nodes:",e.nodes.length)}const n=x().safeDump(t);this.props.contentHandler.update(n)}t&&this.setState(e)}render(){return console.log("chart engine render",this.state.height,this.state.width),w().createElement(ke,{contentHandler:this.props.contentHandler,nodes:this.state.nodes,edges:this.state.edges,setChartState:this.updateWorkFlow.bind(this),width:this.state.width?this.state.width:100,height:this.state.height?this.state.height:100,layout:this.layout.bind(this)})}}const Ee="collector_id_fd9567b6",Te="Output_Collector";class Oe extends f.ReactWidget{constructor(e){super(),this._contentHandler=e,this.addClass("jp-Greenflow"),this.firstTimeReSize=!1}_calclateSize(){this._height=300;const e=this.parent.parent.parent.parent.parent.parent;this._width=e.inputArea.editorWidget.node.clientWidth-5,this._contentHandler&&this._contentHandler.privateCopy&&this._contentHandler.aspectRatio&&(this._height=this._width*this._contentHandler.aspectRatio)}mimerenderWidgetUpdateSize(){if(this._calclateSize(),!this._contentHandler.privateCopy)return;if(!this._contentHandler.privateCopy.get("cache"))return;if(!this._contentHandler.privateCopy.get("cache").nodes)return;this._contentHandler.sizeStateUpdate.emit({nodes:[],edges:[],width:this._width,height:this._height});const e=this.parent;3===e.widgets.length&&(e.widgets[2].node.style.width=this._width+"px")}onAfterAttach(e){console.log("attached"),super.onAfterAttach(e),this._calclateSize(),this._contentHandler.privateCopy&&this._contentHandler.privateCopy.get("value")&&this._contentHandler.renderGraph(this._contentHandler.privateCopy.get("value"),this._width,this._height)}get contentHandler(){return this._contentHandler}onResize(e){this._height=e.height,this._width=e.width,console.log("resize",this._height,this._width),this._height<0||this._width<0?this.mimerenderWidgetUpdateSize():this.firstTimeReSize?this._contentHandler.sizeStateUpdate.emit({nodes:[],edges:[],width:this._width,height:this._height}):(this._contentHandler.emit(this._width,this._height),this.firstTimeReSize=!0)}render(){return console.log("re render"),w().createElement("div",null,w().createElement(Re,{contentHandler:this._contentHandler}))}}var je=n(6168);class Ae{constructor(e){this._contentChanged=new je.Signal(this),this._contentReset=new je.Signal(this),this._includeContent=new je.Signal(this),this._chartStateUpdate=new je.Signal(this),this._sizeStateUpdate=new je.Signal(this),this._runGraph=new je.Signal(this),this._cleanResult=new je.Signal(this),this._updateEditor=new je.Signal(this),this._saveCache=new je.Signal(this),this._nodeAdded=new je.Signal(this),this._reLayout=new je.Signal(this),this._aspectRatio=.3,this.context=e}set commandRegistry(e){this._commandRegistry=e}get commandRegistry(){return this._commandRegistry}get updateEditor(){return this._updateEditor}get runGraph(){return this._runGraph}get saveCache(){return this._saveCache}get cleanResult(){return this._cleanResult}get reLayoutSignal(){return this._reLayout}set aspectRatio(e){this._aspectRatio=e}get aspectRatio(){return this._aspectRatio}set outputs(e){this._outputs=e}get outputs(){return this._outputs?this._outputs:[]}get reLayoutSignalInstance(){return this._reLayout}get privateCopy(){return this._privateCopy}get nodeAddedSignal(){return this._nodeAdded}get contentChanged(){return this._contentChanged}get contentReset(){return this._contentReset}get includeContent(){return this._includeContent}get chartStateUpdate(){return this._chartStateUpdate}get sizeStateUpdate(){return this._sizeStateUpdate}setPrivateCopy(e){e&&(this._privateCopy=e)}update(e){this.context&&this.context.model.fromString(e)}emit(e,t){this._onContentChanged(e,t)}async renderGraph(e,t,n){const o=JSON.stringify(e),s=await m("load_graph",{body:o,method:"POST"});t&&(s.width=t),n&&(s.height=n),this._contentChanged.emit(s)}_onContentChanged(e,t){console.log("content chagned"),(async()=>{if(null===this.context)return;await this.context.ready;const n=this.context.model.toString();console.log("model path",this.context.path);const o=x().safeLoad(n);this.renderGraph(o,e,t)})()}}class Le extends g.DocumentWidget{constructor(e){super(Object.assign({},e)),this.context=e.context}get contentHandler(){return this.content.content.contentHandler}}class De extends g.ABCWidgetFactory{constructor(e){super(e)}createNewWidget(e){const t=new Ae(e),n=new Oe(t),o=new f.MainAreaWidget({content:n});return o.toolbar.hide(),new Le({context:e,content:o})}}var Ge=n(94968);class We extends h.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:We.model_name,_model_module:We.model_module,_model_module_version:We.model_module_version,_view_name:We.view_name,_view_module:We.view_module,_view_module_version:We.view_module_version,value:[],cache:{nodes:[],edges:[]},sub:null})}}We.serializers=Object.assign(Object.assign({},h.DOMWidgetModel.serializers),{sub:{deserialize:h.unpack_models}}),We.model_name="GreenflowModel",We.model_module=c,We.model_module_version=l,We.view_name="GreenflowView",We.view_module=c,We.view_module_version=l;class Me extends h.DOMWidgetView{addCommands(e,t){const n=new f.CommandToolbarButton({commands:e,id:ue}),o=new f.CommandToolbarButton({commands:e,id:ye}),s=new f.CommandToolbarButton({commands:e,id:we}),i=new f.CommandToolbarButton({commands:e,id:ae}),a=new f.CommandToolbarButton({commands:e,id:ee}),r=new f.CommandToolbarButton({commands:e,id:ie}),d=new f.CommandToolbarButton({commands:e,id:ve});t.addItem("relayout",n),t.addItem("run",o),t.addItem("clean",s),t.addItem("open",i),t.addItem("add",r),t.addItem("create",a),t.addItem("log",d)}render(){this._contentHandler=new Ae(null);const e=new Ge.CommandRegistry;this._contentHandler.commandRegistry=e,this._contentHandler.runGraph.connect(this.run,this),this._contentHandler.cleanResult.connect(this.clean,this);const t=new D.Panel;this._widget=new Oe(this._contentHandler);const n=new f.Toolbar;t.addWidget(this._widget),t.addWidget(n),this.pWidget=t,this._contentHandler.renderGraph(this.model.get("value")),this._contentHandler.setPrivateCopy(this.model),this.model.on("change:cache",this.cache_changed,this),this.views=new h.ViewList(this.addView,null,this),this.model.on("change:sub",this.sub_changed,this),function(e,t,n,o,s){e.addCommand(ae,{label:"",caption:"Open TaskGraph file",icon:L.folderIcon,mnemonic:0,execute:async()=>{const e=i.FileDialog.getOpenFiles({manager:n.defaultBrowser.model.manager,filter:e=>e.path.endsWith(".gq.yaml")}),o=await e;if(o.button.accept){const e=o.value;if(1===e.length){const n={path:e[0].path},o=await m("load_graph_path",{body:JSON.stringify(n),method:"POST"});t.contentReset.emit(o)}}}}),e.addCommand(ee,{label:"",caption:"Create Taskgraph from this Cell",icon:Fe,execute:async e=>(async e=>{const n=await o.execute("docmanager:new-untitled",{path:e,type:"file",ext:".gq.yaml"}),i=t.privateCopy.get("value");n.content=x().safeDump(i),n.format="text",s.serviceManager.contents.save(n.path,n)})(n.defaultBrowser.model.path)}),e.addCommand(ue,{label:"",caption:"Taskgraph Nodes Auto Layout",icon:$e,mnemonic:0,execute:()=>{t.reLayoutSignal.emit()}}),e.addCommand(ye,{label:"",caption:"Run",icon:Pe,mnemonic:0,execute:async()=>{t.saveCache.emit(),t.runGraph.emit()}}),e.addCommand(ve,{label:"",caption:"Show Log Console",icon:L.listIcon,mnemonic:0,execute:async()=>{var e;s.commands.execute("logconsole:open",{insertMode:"split-bottom",ref:null===(e=s.shell.currentWidget)||void 0===e?void 0:e.id})}}),e.addCommand(we,{label:"",caption:"Clean Result",icon:Ue,mnemonic:0,execute:async()=>{t.cleanResult.emit()}}),e.addCommand(te,{label:"Select the file",caption:"Select the file",icon:L.folderIcon,execute:async e=>await s.commands.execute(te,e)}),e.addCommand(ne,{label:"Select the Path",caption:"Select the Path",icon:L.folderIcon,execute:async()=>s.commands.execute(ne)}),e.addCommand(le,{label:"Task Node Editor",caption:"Open the Task Node Editor",icon:L.editIcon,mnemonic:0,execute:()=>{if(Ke(s.shell.currentWidget)){let e=null;for(const n of(0,X.toArray)(s.shell.widgets()))if(n instanceof Z&&n.handler===t){e=n;break}null===e?(e=new Z(t),e.id=e.id+_e(),s.shell.add(e,"main",{mode:"split-bottom"})):s.shell.activateById(e.id)}else{let e=null;for(const n of(0,X.toArray)(s.shell.widgets()))if(n instanceof Z&&n.handler===t){e=n;break}null===e?(e=new Z(t),e.id=e.id+_e(),s.shell.add(e,"main",{mode:"split-bottom"})):s.shell.activateById(e.id)}}}),e.addCommand(be,{label:"Task Node Editor",caption:"Open the Task Node Editor",icon:L.editIcon,mnemonic:0,execute:e=>{s.commands.execute("docmanager:open",e)}}),e.addCommand(xe,{label:"Create Customized Node",caption:"Create Customized Node",icon:L.folderIcon,execute:e=>{s.commands.execute(xe,e)}}),e.addCommand(ie,{label:"",caption:"Import TaskGraph from file",icon:L.addIcon,execute:async()=>{const e=i.FileDialog.getOpenFiles({manager:n.defaultBrowser.model.manager,filter:e=>e.path.endsWith(".gq.yaml")}),o=await e;if(o.button.accept){const e=o.value;if(1===e.length){const n={path:e[0].path},o=await m("load_graph_path",{body:JSON.stringify(n),method:"POST"});t.includeContent.emit(o)}}}})}(e,this._contentHandler,Me.browserFactory,Me.apps.commands,Me.apps),this.addCommands(e,n),this.createContexMenu()}run(){this.send({event:"run"})}clean(){const e=this.model.get("cache");e.nodes.forEach((e=>{e.busy=!1})),this._contentHandler.chartStateUpdate.emit(e),this._contentHandler.privateCopy.set("cache",e),this.send({event:"clean"})}sub_changed(e,t){this.create_child_view(t).then((e=>{const t=this.pWidget;3===t.widgets.length&&t.layout.removeWidget(t.widgets[2]),t.insertWidget(2,e.pWidget)})),this.views.update([t]).then((()=>{const e=this.pWidget;if(3===e.widgets.length){const t=e.widgets[2],n=this._widget.parent.parent.parent.parent.parent.parent.inputArea.editorWidget.node.clientWidth-5;t.node.style.width=n+"px"}}))}getFigureSize(){return this.el.getBoundingClientRect()}addView(e){return this.create_child_view(e)}processPhosphorMessage(e){switch(super.processPhosphorMessage.apply(this,e),e.type){case"resize":case"after-show":case"after-attach":this.pWidget.isVisible&&console.log(this.getFigureSize())}}cache_changed(){const e=this.model.get("cache");if("register"in e){const t=e.register;m("register_node",{body:JSON.stringify(t),method:"POST"}).then((e=>{console.log(e)})),delete e.register}this._contentHandler.chartStateUpdate.emit(e)}createContexMenu(){const e=Me.apps.commands,t=new L.ContextMenuSvg({commands:e});Ze(t,e,null),t.addItem({type:"separator",selector:".jp-Greenflow"}),t.addItem({command:"notebook:create-output-view",selector:".jp-Greenflow"}),this.pWidget.node.addEventListener("contextmenu",(e=>{t.open(e)&&(e.preventDefault(),e.stopPropagation())}))}}Me.apps=null,Me.browserFactory=null;var Be=n(32309),qe=n(10410);const ze="GREENFLOWLAB",Fe=new L.LabIcon({name:"greenflowlab:gq",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="-2 -2 34 34">\n    <rect\n       y="-1.7763568e-15"\n       x="0"\n       height="30"\n       width="10"\n       id="rect22"\n       style="fill:#2e8b57;fill-opacity:1;fill-rule:evenodd;stroke-width:0.183308" />\n    <rect\n       style="fill:#2e8b57;fill-opacity:1;fill-rule:evenodd;stroke-width:0.183309;stroke:none;stroke-opacity:1"\n       id="rect22-9"\n       width="10"\n       height="30"\n       x="20"\n       y="0" />\n    <circle\n       r="5"\n       cy="10"\n       cx="10"\n       id="path1050"\n       style="fill:#2e8b57;fill-opacity:1;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />\n    <path\n       d="m 10,15 a 5,5 0 0 1 -4.330127,-2.5 5,5 0 0 1 0,-5 A 5,5 0 0 1 10,5"\n       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="path1050-2" />\n    <circle\n       r="5"\n       cx="20"\n       cy="20"\n       id="path1050-2-5"\n       style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />\n    <path\n       d="m 20,25 a 5,5 0 0 1 -4.330127,-2.5 5,5 0 0 1 0,-5 A 5,5 0 0 1 20,15 v 5 z"\n       style="fill:#2e8b57;fill-opacity:1;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="path1050-2-5-1" />\n</svg>\n'}),Pe=new L.LabIcon({name:"greenflowlab:gqrun",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 640 480">\n <g>\n  <title>Layer 1</title>\n  <path d="m416.846985,109.244995c17.785004,0 32.207001,-14.471008 32.207001,-32.255005c0,-17.785004 -14.421997,-32.207001 -32.207001,-32.207001c-17.832977,0 -32.254974,14.421997 -32.254974,32.207001c0,17.783997 14.421997,32.255005 32.254974,32.255005" fill-rule="nonzero" fill="#00aa00" id="path8248"/>\n  <path d="m305.852997,133.169006l-50.136993,57.932983c-2.972015,3.654022 -7.455017,5.895996 -12.522003,5.895996c-8.964996,0 -16.225006,-7.259979 -16.225006,-16.176971c0,-4.872009 2.095001,-9.209015 5.457001,-12.181l54.084015,-62.269012c2.971985,-3.557007 7.454987,-5.847015 12.522003,-5.847015l78.250977,-0.048981c5.75,0 10.914001,2.338989 14.714996,5.992981l49.893005,49.894012l41.367004,-41.269989c2.924011,-2.485016 6.676025,-3.947021 10.768005,-3.947021c9.257996,0 16.713013,7.503998 16.713013,16.762024c0,4.043976 -1.36499,7.697998 -3.752014,10.621979l-49.845001,50.234009c-15.152985,15.105011 -27.333984,2.290009 -27.333984,2.290009l-30.598999,-30.744995l-47.798004,55.301971l43.802979,43.803009c0,0 9.257019,8.576019 3.946014,25.628998l-24.557007,109.483032c-1.949005,9.501953 -10.32901,16.664001 -20.365997,16.664001c-11.548004,0 -20.854004,-9.355042 -20.854004,-20.854004c0,-1.851013 0.195007,-3.605042 0.632996,-5.262024l20.221008,-89.799011l-49.796997,-48.382996l-42.828003,47.75c0,0 -6.919006,8.527039 -25.287994,7.893005l-86.875,0.145996c-9.695999,0.147034 -18.514999,-6.47998 -20.659012,-16.322021c-2.582993,-11.20697 4.336014,-22.218964 15.591003,-24.702972c1.755005,-0.389984 3.509003,-0.536011 5.214005,-0.488007l74.694,0.195007l110.458008,-128.046997l-28.894012,-0.145996z" fill-rule="nonzero" fill="#00aa00" id="path8256"/>\n </g>\n</svg>'}),Ue=new L.LabIcon({name:"greenflowlab:gqclean",svgstr:'\n<svg height="16" viewBox="1 -25 511.9995 511" width="16" xmlns="http://www.w3.org/2000/svg">\n    <path d="m291.160156 462.433594h-226.105468c-8.28125 0-15-6.71875-15-15 0-8.285156 6.71875-15 15-15h226.105468c8.285156 0 15 6.714844 15 15 0 8.28125-6.714844 15-15 15zm0 0" fill="#878477" />\n    <path d="m379.1875 462.445312h-28.027344c-8.285156 0-15-6.714843-15-15 0-8.285156 6.714844-15 15-15h28.027344c8.285156 0 15 6.714844 15 15 0 8.285157-6.714844 15-15 15zm0 0" fill="#878477" />\n    <path d="m65.058594 462.445312c-3.980469 0-7.796875-1.582031-10.609375-4.394531l-32.566407-32.566406c-14.113281-14.109375-21.882812-32.871094-21.882812-52.828125s7.769531-38.71875 21.882812-52.832031l96.585938-96.585938c2.8125-2.8125 6.628906-4.394531 10.605469-4.394531 3.976562 0 7.792969 1.582031 10.605469 4.394531l149.582031 149.582031c5.855469 5.855469 5.855469 15.351563 0 21.210938l-64.007813 64.007812c-2.8125 2.8125-6.628906 4.390626-10.605468 4.394532zm0 0" fill="#edeade" />\n    <path d="m65.058594 462.445312 149.589844-.011718c3.980468-.003906 7.792968-1.582032 10.605468-4.394532l64.007813-64.007812c5.855469-5.859375 5.855469-15.355469 0-21.210938l-74.789063-74.792968-160.023437 160.023437c2.8125 2.8125 6.628906 4.394531 10.609375 4.394531zm0 0" fill="#c4c0ad" />\n    <path d="m285.035156 404.808594c-3.839844 0-7.675781-1.464844-10.605468-4.394532l-162.34375-162.34375c-5.855469-5.859374-5.855469-15.355468 0-21.210937l211.964843-211.964844c2.8125-2.8125 6.628907-4.394531 10.605469-4.394531 3.980469 0 7.792969 1.582031 10.609375 4.394531l162.339844 162.34375c5.859375 5.855469 5.859375 15.351563 0 21.210938l-211.960938 211.964843c-2.929687 2.929688-6.769531 4.394532-10.609375 4.394532zm0 0" fill="#4dc979" />\n    <path d="m426.433594 86.066406-233.175782 233.175782 81.171876 81.171874c2.929687 2.925782 6.769531 4.394532 10.605468 4.394532 3.839844 0 7.679688-1.464844 10.605469-4.394532l211.964844-211.964843c5.859375-5.859375 5.859375-15.355469 0-21.210938zm0 0" fill="#1e9e60" />\n</svg>'}),$e=new L.LabIcon({name:"greenflowlab:layout",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 485 485">\n   <g\n   id="g4"\n   style="fill:#00aa00">\n\t<path\n   d="M430,102.509c-30.327,0-55,24.673-55,55c0,9.724,2.547,18.859,6.993,26.794l-61.444,61.445   c-7.934-4.446-17.07-6.993-26.794-6.993c-9.724,0-18.86,2.547-26.794,6.993l-27.707-27.707c4.446-7.934,6.993-17.07,6.993-26.794   c0-30.327-24.673-55-55-55s-55,24.673-55,55c0,9.724,2.547,18.859,6.993,26.794l-61.445,61.444   c-7.935-4.446-17.071-6.993-26.795-6.993c-30.327,0-55,24.673-55,55s24.673,55,55,55s55-24.673,55-55   c0-9.724-2.547-18.859-6.993-26.793l61.445-61.444c7.934,4.446,17.07,6.993,26.794,6.993c9.724,0,18.859-2.547,26.794-6.993   l27.707,27.707c-4.446,7.934-6.993,17.07-6.993,26.794c0,30.327,24.673,55,55,55s55-24.673,55-55c0-9.724-2.547-18.86-6.993-26.794   l61.444-61.444c7.935,4.446,17.07,6.993,26.794,6.993c30.327,0,55-24.673,55-55S460.327,102.509,430,102.509z M55,352.491   c-13.785,0-25-11.215-25-25s11.215-25,25-25s25,11.215,25,25S68.785,352.491,55,352.491z M191.247,216.247   c-13.785,0-25-11.215-25-25s11.215-25,25-25s25,11.215,25,25S205.032,216.247,191.247,216.247z M293.755,318.754   c-13.785,0-25-11.215-25-25s11.215-25,25-25s25,11.215,25,25S307.54,318.754,293.755,318.754z M430,182.509   c-13.785,0-25-11.215-25-25s11.215-25,25-25s25,11.215,25,25S443.785,182.509,430,182.509z"\n   id="path2"\n   style="fill:#00aa00" />\n</g>\n<g\n   id="g6">\n</g>\n<g\n   id="g8">\n</g>\n<g\n   id="g10">\n</g>\n<g\n   id="g12">\n</g>\n<g\n   id="g14">\n</g>\n<g\n   id="g16">\n</g>\n<g\n   id="g18">\n</g>\n<g\n   id="g20">\n</g>\n<g\n   id="g22">\n</g>\n<g\n   id="g24">\n</g>\n<g\n   id="g26">\n</g>\n<g\n   id="g28">\n</g>\n<g\n   id="g30">\n</g>\n<g\n   id="g32">\n</g>\n<g\n   id="g34">\n</g>\n</svg>\n'}),Je=new d.Token("greenflow/tracki");function Ve(e){if(!e)return!1;if(0===e.widgets.length)return!1;let t=e.widgets[0];if(!t)return!1;if(t.widgets[0]instanceof Oe)return!0;const n=t.children();if(!n)return!1;if(n.next(),t=n.next(),!t)return!1;if(t=t.children().next(),!t)return!1;const o=t.children().next();return!!o&&o instanceof Oe}function Ke(e){if(e)for(const t of(0,X.toArray)(e.children()))if(t instanceof D.Widget&&t.id.startsWith("LinkedOutputView-"))for(const e of(0,X.toArray)(t.children()))for(const t of(0,X.toArray)(e.children()))if(Ve(t))return!0;return!1}function Ye(e){return!!e&&(e instanceof qe.CodeCell&&Ve(e.outputArea))}async function Ze(e,t,n){e.addItem({command:le,selector:".jp-Greenflow"}),e.addItem({command:"docmanager:save",selector:".jp-Greenflow"}),e.addItem({command:"filebrowser:download",selector:".jp-Greenflow"}),e.addItem({command:Q,selector:".jp-Greenflow"}),e.addItem({command:oe,selector:".jp-Greenflow"}),e.addItem({command:se,selector:".jp-Greenflow"}),e.addItem({command:pe,selector:".jp-Greenflow"}),e.addItem({type:"separator",selector:".jp-Greenflow"});const o=new D.Menu({commands:t});o.title.label="Add Nodes",o.title.mnemonic=4;const s={},i=await m("all_nodes");for(const e in i){const a=e.split(".");let r=null;for(let e=0;e<a.length;e++){const n=a.slice(0,e+1).join(".");n in s?r=s[n]:(r=new D.Menu({commands:t}),r.title.label=a[e],r.title.mnemonic=0,s[n]=r,e>0?s[a.slice(0,e).join(".")].addItem({type:"submenu",submenu:r}):o.addItem({type:"submenu",submenu:r}))}for(let t=0;t<i[e].length;t++){const o={name:i[e][t].type,node:i[e][t]};r.addItem({command:he,args:o}),n&&n.addItem({command:he,category:"Add New Nodes",args:o})}}e.addItem({type:"submenu",submenu:o,selector:".jp-Greenflow"}),e.addItem({type:"separator",selector:".jp-Greenflow"}),e.addItem({command:ge,selector:".jp-Greenflow"}),e.addItem({command:fe,selector:".jp-Greenflow"}),e.addItem({command:Ce,selector:".jp-Greenflow"}),e.addItem({type:"separator",selector:".jp-Greenflow"});const a=new D.Menu({commands:t});return a.title.label="Change Aspect Ratio",a.title.mnemonic=0,[.3,.5,.7,1].forEach((e=>{a.addItem({command:me,args:{aspect:e}})})),e.addItem({type:"submenu",submenu:a,selector:".jp-Greenflow"}),m("register_plugins").then((e=>{console.log(e.validation);for(const o in e.validation)t=o,n=new Function("required","outputs",e.validation[o]),E[t]=n;var t,n;for(const t in e.display)k(t,new Function("metaObj",e.display[t]))})),o}const Xe=[{id:"greenflowlab-extension",requires:[i.IFileBrowserFactory,s.ILayoutRestorer,r.IMainMenu,f.ICommandPalette,Be.INotebookTracker],optional:[a.ILauncher],autoStart:!0,activate:async function(e,t,n,o,s,a,r){const d=new De({name:ze,fileTypes:["gq.yaml"],defaultFor:["gq.yaml"],toolbarFactory:t=>(t.contentHandler.commandRegistry=e.commands,[{name:"layout",widget:new f.ToolbarButton({className:"myButton",icon:$e,onClick:()=>{t.contentHandler.reLayoutSignal.emit()},tooltip:"Taskgraph Nodes Auto Layout"})},{name:"download",widget:new f.ToolbarButton({className:"myButton",icon:L.downloadIcon,onClick:()=>{e.commands.execute("filebrowser:download")},tooltip:"Download the TaskGraph"})},{name:"save",widget:new f.ToolbarButton({className:"myButton",icon:L.saveIcon,onClick:()=>{e.commands.execute("docmanager:save")},tooltip:"Save the TaskGraph"})},{name:"notebook",widget:new f.ToolbarButton({className:"myButton",icon:L.notebookIcon,onClick:()=>{e.commands.execute(ce)},tooltip:"Convert TaskGraph to Notebook"})},{name:"editor",widget:new f.ToolbarButton({className:"myButton",icon:L.editIcon,onClick:()=>{e.commands.execute(le)},tooltip:"Open Task Node Editor"})},{name:"add",widget:new f.ToolbarButton({className:"myButton",icon:L.addIcon,onClick:()=>{e.commands.execute(se)},tooltip:"Import a TaskGraph from file"})}])}),{commands:l}=e,c=new f.WidgetTracker({namespace:"greenflow"});n.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:ze}),name:e=>e.context.path}),d.widgetCreated.connect(((e,t)=>{t.title.icon=Fe,t.context.pathChanged.connect((()=>{c.save(t)})),c.add(t)})),e.docRegistry.addWidgetFactory(d),e.docRegistry.addFileType({name:"gq.yaml",displayName:"TaskGraph",mimeTypes:["application/gq.yaml"],extensions:[".gq.yaml"],icon:Fe,fileFormat:"text"}),function(e,t,n,o,s,a,r){function d(){return a()||s()}e.addCommand(Q,{label:"Create Taskgraph from this Cell",caption:"Create Taskgraph from this Cell",icon:Fe,execute:()=>(async o=>{const s=await e.execute("docmanager:new-untitled",{path:o,type:"file",ext:".gq.yaml"}),i=n().contentHandler.privateCopy.get("value");s.content=x().safeDump(i),s.format="text",t.serviceManager.contents.save(s.path,s)})(o.defaultBrowser.model.path),isVisible:s}),e.addCommand(te,{label:"Select the file",caption:"Select the file",icon:L.folderIcon,execute:async e=>{let t=null;t=e&&"filter"in e?i.FileDialog.getOpenFiles({manager:o.defaultBrowser.model.manager,title:"Select the File",filter:t=>e.filter.some((e=>t.path.endsWith(e)))}):i.FileDialog.getOpenFiles({manager:o.defaultBrowser.model.manager,title:"Select the File"});const n=await t;if(n.button.accept){const e=n.value;if(1===e.length)return e[0]}}}),e.addCommand(ne,{label:"Select the Path",caption:"Select the Path",icon:L.folderIcon,execute:async()=>{const e=i.FileDialog.getExistingDirectory({manager:o.defaultBrowser.model.manager,title:"Select the Path"}),t=await e;if(t.button.accept){const e=t.value;if(1===e.length)return e[0]}}}),e.addCommand(xe,{label:"Create Customized Node",caption:"Create Customized Node",icon:L.folderIcon,execute:async n=>{const s=o.defaultBrowser.model.path,i=await e.execute("docmanager:new-untitled",{path:s,type:"file",ext:".py"}),a=`import greenflow\nfrom greenflow.dataframe_flow.portsSpecSchema import ConfSchema\nimport json\n\ndata = """${JSON.stringify({conf:n.conf},null,2)}\n"""\n\n\nclass ${n.nodeName}(greenflow.plugin_nodes.util.CompositeNode):\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        # modify the self.conf to the one that this Composite node wants\n        global data\n        node_conf = self.conf\n        data_obj = json.loads(data)\n        data_obj['conf']['subnodes_conf'].update(node_conf)\n        self.conf = data_obj['conf']\n\n    def conf_schema(self):\n        full_schema = super().conf_schema()\n        full_schema_json = full_schema.json\n        ui = full_schema.ui\n        json = {\n            "title": "${n.nodeName} configure",\n            "type": "object",\n            "description": "Enter your node description here",\n            "properties": {\n            }\n        }\n        item_dict = full_schema_json['properties']["subnodes_conf"]['properties']\n        for key in item_dict.keys():\n            json['properties'][key] = item_dict[key]\n        return ConfSchema(json=json, ui=ui)\n\n      `;i.content=a,i.format="text",t.serviceManager.contents.save(i.path,i)}}),e.addCommand(oe,{label:"Open TaskGraph file",caption:"Open TaskGraph file",icon:L.folderIcon,execute:async()=>{const e=i.FileDialog.getOpenFiles({manager:o.defaultBrowser.model.manager,filter:e=>e.path.endsWith(".gq.yaml")}),t=await e;if(t.button.accept){const e=t.value;if(1===e.length){const t={path:e[0].path},o=await m("load_graph_path",{body:JSON.stringify(t),method:"POST"});n().contentHandler.contentReset.emit(o)}}},isVisible:s}),e.addCommand(se,{label:"Import TaskGraph from file",caption:"Import TaskGraph from file",icon:L.addIcon,execute:async()=>{const e=i.FileDialog.getOpenFiles({manager:o.defaultBrowser.model.manager,filter:e=>e.path.endsWith(".gq.yaml")}),r=await e;if(r.button.accept){const e=r.value;if(1===e.length){const o={path:e[0].path},i=await m("load_graph_path",{body:JSON.stringify(o),method:"POST"});s()?n().contentHandler.includeContent.emit(i):a()&&t.shell.currentWidget.contentHandler.includeContent.emit(i)}}}}),e.addCommand(re,{label:"Create an empty Taskgraph",caption:"Create an empty Taskgraph",execute:()=>(async n=>{const o=await e.execute("docmanager:new-untitled",{path:n,type:"file",ext:".gq.yaml"});o.content="",o.format="text",t.serviceManager.contents.save(o.path,o)})(o.defaultBrowser.model.path)}),e.addCommand(de,{label:"TaskGraph",icon:Fe,caption:"Create a new task graph file",execute:()=>(async t=>{const n=await e.execute("docmanager:new-untitled",{path:t,type:"file",ext:".gq.yaml"});return e.execute("docmanager:open",{path:n.path,factory:ze})})(o.defaultBrowser.model.path)}),t.commands.addCommand(le,{label:"Task Node Editor",caption:"Open the Task Node Editor",icon:L.editIcon,mnemonic:0,execute:()=>{if(s()){if(Ye(r.activeCell)){const e=n();let o=null;for(const n of(0,X.toArray)(t.shell.widgets()))if(n instanceof Z&&n.handler===e.contentHandler){o=n;break}null===o?(o=new Z(e.contentHandler),o.id=o.id+_e(),t.shell.add(o,"main",{mode:"split-bottom"})):t.shell.activateById(o.id)}else if(Ke(t.shell.currentWidget)){const e=n();let o=null;for(const n of(0,X.toArray)(t.shell.widgets()))if(n instanceof Z&&n.handler===e.contentHandler){o=n;break}null===o?(o=new Z(e.contentHandler),o.id=o.id+_e(),t.shell.add(o,"main",{mode:"split-bottom"})):t.shell.activateById(o.id)}}else{const e=t.shell.currentWidget;e.contentHandler.reLayoutSignal.emit();let n=null;for(const o of(0,X.toArray)(t.shell.widgets()))if(o instanceof Z&&o.handler===e.contentHandler){n=o;break}null===n?(n=new Z(e.contentHandler),n.id=n.id+_e(),t.shell.add(n,"main",{mode:"split-bottom"})):t.shell.activateById(n.id)}},isVisible:d}),e.addCommand(ce,{label:"Convert TaskGraph to Notebook",caption:"Convert TaskGraph to Notebook",icon:L.notebookIcon,execute:async()=>{let i,r="";return s()&&(i=n(),r=JSON.stringify(i.contentHandler.privateCopy.get("value"))),a()&&(i=t.shell.currentWidget,r=JSON.stringify(x().safeLoad(i.contentHandler.context.model.toString()),null,2)),(async(n,s,i)=>{const a=await e.execute("docmanager:new-untitled",{type:"notebook"}),r=[],d={cells:[{cell_type:"code",execution_count:1,metadata:{},outputs:r,source:"# run this cell if you need Dask\nfrom dask_cuda import LocalCUDACluster\ncluster = LocalCUDACluster()\nfrom dask.distributed import Client\nclient = Client(cluster)\nclient\n"},{cell_type:"code",execution_count:2,metadata:{},outputs:r,source:s},{cell_type:"code",execution_count:3,metadata:{},outputs:r,source:"taskGraph.run(formated=True)"}],metadata:{kernelspec:{display_name:"Python 3",language:"python",name:"python3"}},nbformat:4,nbformat_minor:4};a.content=d,a.format="text";const l=await t.serviceManager.contents.save(a.path,a);o.defaultBrowser.model.manager.open(l.path)})(0,`import json\nfrom greenflow.dataframe_flow import TaskGraph\nobj="""${r}"""\ntaskList=json.loads(obj)\ntaskGraph=TaskGraph(taskList)\ntaskGraph.draw()`)},isVisible:a}),e.addCommand(he,{label:e=>"Add "+e.name,mnemonic:4,execute:e=>{s()?n().contentHandler.nodeAddedSignal.emit(e.node):t.shell.currentWidget.contentHandler.nodeAddedSignal.emit(e.node)},isVisible:d}),e.addCommand(pe,{label:"Taskgraph Nodes Auto Layout",caption:"Taskgraph Nodes Auto Layout",icon:$e,mnemonic:0,execute:()=>{s()?(Ye(r.activeCell)||Ke(t.shell.currentWidget))&&n().contentHandler.reLayoutSignal.emit():t.shell.currentWidget.contentHandler.reLayoutSignal.emit()},isVisible:d}),e.addCommand(me,{label:e=>"AspectRatio "+e.aspect.toString(),caption:"AspectRatio 1.0",mnemonic:14,execute:e=>{const t=n();t.contentHandler.aspectRatio=e.aspect,t.mimerenderWidgetUpdateSize()},isEnabled:s}),e.addCommand(ge,{label:"Run",caption:"Run",icon:Pe,mnemonic:0,execute:async()=>{if(s())if(Ye(r.activeCell)){const e=n();e.contentHandler.saveCache.emit(),e.contentHandler.runGraph.emit()}else if(Ke(t.shell.currentWidget)){const e=n();e.contentHandler.saveCache.emit(),e.contentHandler.runGraph.emit()}},isVisible:s}),e.addCommand(fe,{label:"Clean Result",caption:"Clean Result",icon:Ue,mnemonic:0,execute:async()=>{s()&&Ye(r.activeCell)&&n().contentHandler.cleanResult.emit()},isVisible:s}),e.addCommand(Ce,{label:"Add Output Collector",mnemonic:1,execute:()=>{const e={id:Ee,width:160,type:Te,conf:{},required:{},output_meta:[],outputs:[],schema:{},ui:{},inputs:[{name:"in1",type:[["any"]]}]};s()&&Ye(r.activeCell)&&n().contentHandler.nodeAddedSignal.emit(e),a()&&t.shell.currentWidget.contentHandler.nodeAddedSignal.emit(e)},isVisible:d}),e.addCommand(be,{label:"Task Node Editor",caption:"Open the Task Node Editor",icon:L.editIcon,mnemonic:0,execute:e=>{t.commands.execute("docmanager:open",e)}})}(l,e,(function(){const t=e.shell.currentWidget;if(t)for(const e of(0,X.toArray)(t.children()))if(e.id.startsWith("LinkedOutputView-"))for(const t of(0,X.toArray)(e.children()))for(const e of(0,X.toArray)(t.children())){const t=e;if(t&&t.widgets.length>0&&t.widgets[0].widgets.length>0&&t.widgets[0].widgets[0]instanceof Oe)return t.widgets[0].widgets[0]}let n=a.activeCell.outputArea.widgets[0];const o=n.children();return o.next(),n=o.next(),n=n.children().next(),n.children().next()}),t,(function(){return!!Ke(e.shell.currentWidget)||null!==a.currentWidget&&a.currentWidget===e.shell.currentWidget}),(function(){return null!==c.currentWidget&&c.currentWidget===e.shell.currentWidget}),a),r&&r.add({command:de,rank:1,category:"Other"});const h=Ze(e.contextMenu,l,s);if(o&&(o.fileMenu.newMenu.addGroup([{command:de}],40),o.fileMenu.addGroup([{command:re}],40),o.addMenu(await h,{rank:40})),s){const e={format:"YAML",label:"YAML",isPalette:!0};s.addItem({command:re,category:"Notebook Operations",args:e}),s.addItem({command:pe,category:"GreenflowLab",args:e}),[.3,.5,.7,1].forEach((e=>{s.addItem({command:me,category:"GreenflowLab",args:{aspect:e}})})),s.addItem({command:Ce,category:"Add New Nodes",args:e}),s.addItem({command:Q,category:"GreenflowLab",args:e}),s.addItem({command:fe,category:"GreenflowLab",args:e}),s.addItem({command:ge,category:"GreenflowLab",args:e})}e.commands.addKeyBinding({command:pe,keys:["Alt A"],selector:".jp-Greenflow"}),e.commands.addKeyBinding({command:Ce,keys:["Alt O"],selector:".jp-Greenflow"}),e.commands.addKeyBinding({command:ge,keys:["Alt R"],selector:".jp-Notebook"}),e.commands.addKeyBinding({command:fe,keys:["Alt C"],selector:".jp-Notebook"}),e.commands.addKeyBinding({command:pe,keys:["Alt A"],selector:".jp-Notebook"}),e.commands.addKeyBinding({command:Ce,keys:["Alt O"],selector:".jp-Notebook"}),e.commands.addKeyBinding({command:ge,keys:["Alt R"],selector:".jp-LinkedOutputView"}),e.commands.addKeyBinding({command:fe,keys:["Alt C"],selector:".jp-LinkedOutputView"}),e.commands.addKeyBinding({command:pe,keys:["Alt A"],selector:".jp-LinkedOutputView"}),e.commands.addKeyBinding({command:Ce,keys:["Alt O"],selector:".jp-LinkedOutputView"}),e.contextMenu.addItem({command:ce,selector:".jp-Greenflow"})}},{id:"greenflowlab",requires:[i.IFileBrowserFactory,h.IJupyterWidgetRegistry],optional:[a.ILauncher],autoStart:!0,activate:function(e,t,n){Me.apps=e,Me.browserFactory=t,n.registerWidget({name:c,version:l,exports:o})}}]},28856:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(23645),s=n.n(o)()((function(e){return e[1]}));s.push([e.id,"@import url(//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css);"]),s.push([e.id,".tooltip {\n    position: fixed;\n    background-color: gray;\n}\n\n.confeditor {\n      text-align: left;\n      padding: 10px;\n      position: fixed;\n      background-color: yellowgreen;\n      opacity: 0;\n      left: 0;\n      top: 0;\n}\n\n.rungraph {\n    color: green;\n}\n",""]);const i=s}}]);