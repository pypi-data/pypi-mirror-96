(self.webpackChunk_mamba_org_gator_lab=self.webpackChunk_mamba_org_gator_lab||[]).push([[568],{1568:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1408),i=n(7441),s=n(5919),r=n(5389),c=n(7039),l=n(7812),d=n(3817),u=n(7786),m="@mamba-org/gator-lab:plugin",p=[{id:m,autoStart:!0,activate:function(e,t,n,o,s){return a(this,void 0,void 0,(function*(){let a;const{commands:r,shell:l}=e,u="conda-env",p="jupyter_conda:open-ui",g=yield null==t?void 0:t.load(m),_=new c.CondaEnvironments(g);h.loadPackages(_);const f=new i.WidgetTracker({namespace:u});let v;return r.addCommand(p,{label:"Conda Packages Manager",execute:()=>{if(e.restored.then((()=>{let e=0;const t=()=>{setTimeout((()=>{e+=1e3,v.isVisible&&a?r.execute("jupyterlab-tour:launch",{id:a.id,force:!1}):e<5001&&t()}),1e3)};r.hasCommand("jupyterlab-tour:add")&&(a||r.execute("jupyterlab-tour:add",{tour:d.managerTour}).then((e=>{a=e})),t())})),f.currentWidget)return void l.activateById(f.currentWidget.id);v=new c.CondaEnvWidget(_),v.addClass(c.CONDA_WIDGET_CLASS),v.id=u,v.title.label="Packages",v.title.caption="Conda Packages Manager",v.title.icon=c.condaIcon;const t=new i.MainAreaWidget({content:v});f.add(t),l.add(t,"main")}}),n&&n.addItem({command:p,category:"Settings"}),s&&s.restore(f,{command:p,name:()=>u}),o&&o.settingsMenu.addGroup([{command:p}],999),_}))},optional:[r.ISettingRegistry,i.ICommandPalette,s.IMainMenu,o.ILayoutRestorer],provides:c.IEnvironmentManager},{id:u.companionID,autoStart:!0,activate:function(e,t,n,o){return a(this,void 0,void 0,(function*(){const{commands:a,serviceManager:i}=e,s="jupyter_conda:companions",r=yield n.load(m),c=new u.CompanionValidator(i.kernelspecs,t,r);return a.addCommand(s,{label:"Validate kernels compatibility",execute:()=>{c.validate(i.kernelspecs.specs)}}),o&&o.addItem({command:s,category:"Troubleshooting"}),c}))},requires:[c.IEnvironmentManager,r.ISettingRegistry],optional:[i.ICommandPalette],provides:u.ICompanionValidator}];var h;t.default=p,function(e){e.loadPackages=function(e){let t,n=!1;const a=["I know you want to give up, but wait a bit longer...","Why is conda so popular, still loading that gigantic packages list...","Take a break, available packages list are still loading...","Available packages list still loading..."];function o(e){setTimeout((()=>{n||(l.INotification.update({message:e,toastId:t}),a.length>0&&o(a.pop()))}),6e4)}e.getPackageManager().refreshAvailablePackages(!1).then((()=>{n=!0,t&&l.INotification.dismiss(t)})).catch((e=>{console.debug("Fail to cache available packages list.",e),t&&l.INotification.dismiss(t)})),setTimeout((()=>{n||(l.INotification.inProgress("Loading the available packages list in background...").then((e=>{t=e})),o(a.pop()))}),6e4)}}(h||(h={}))},3817:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.managerTour=void 0;const s=n(7039),r=i(n(6271));t.managerTour={id:"jupyterlab-conda:tour",label:"Conda Packages Manager Tour",hasHelpEntry:!0,steps:[{content:r.createElement("p",null,"Thanks for installing ",r.createElement("em",null,"Gator"),".",r.createElement("br",null),"Let's have a tour of the UI."),placement:"center",target:`.${s.CONDA_WIDGET_CLASS}`,title:"Conda Packages Manager"},{content:r.createElement("p",null,"Your conda environment are listed here.",r.createElement("br",null),"Click on it to manage its packages."),placement:"right",target:`#${s.CONDA_ENVIRONMENT_PANEL_ID}`},{content:r.createElement("p",null,"This toolbar contains environment actions like creation, deletion, exportation,..."),placement:"bottom",target:`.${s.CONDA_ENVIRONMENT_TOOLBAR_CLASS}`},{content:r.createElement("p",null,"This table lists all available conda packages and their status within the selected environment (i.e. installed, updatable or available)."),target:`#${s.CONDA_PACKAGES_PANEL_ID}`},{content:r.createElement("p",null,"A package can be installed, removed or updated by selecting a status in these selectors."),placement:"bottom",target:`.${s.CONDA_PACKAGE_SELECT_CLASS}`},{content:r.createElement("p",null,"The package list can be filtered by packages status and with a search term."),placement:"bottom-start",target:`.${s.CONDA_PACKAGES_TOOLBAR_CLASS}`},{content:r.createElement("p",null,"Execute package changes with the cart button."),placement:"bottom",target:`.${s.CONDA_PACKAGES_TOOLBAR_CLASS} .fa-cart-arrow-down`}]}},7786:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}c((a=a.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompanionValidator=t.ICompanionValidator=t.companionID=void 0;const i=n(8275),s=n(1797),r=n(7812),c=o(n(2875));t.companionID="@mamba-org/gator-lab:companion",t.ICompanionValidator=new s.Token("@mamba-org/gator-lab:ICompanionValidator");const l=/[\u0300-\u036F]/g;class d{constructor(e,t,n){this._isDisposed=!1,this._companions={},this._clean=()=>{},this._envManager=t,this._updateCompanions(n),n.changed.connect(this._updateCompanions,this),e.ready.then((()=>{this._validateSpecs(e,e.specs),e.specsChanged.connect(this._validateSpecs,this)})),new Promise((e=>{this._clean=e}).bind(this)).then((()=>{n.changed.disconnect(this._updateCompanions,this),e.specsChanged.disconnect(this._validateSpecs,this)}))}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._clean(),this._isDisposed=!0)}_updateCompanions(e){this._companions=e.get("companions").composite}static kernelNameToEnvironment(e){const t=e.split("-");if("conda"===t[0]){if(t.length>=4)return t[2];if(3===t.length&&"root"===t[2])return"base"}return null}static _semverToPython(e){return e?e.split("||").map((e=>e.split(" ").join(","))).join("|"):null}_validateSpecs(e,t){return a(this,void 0,void 0,(function*(){if(0===Object.keys(this._companions).length)return;const e=yield this._envManager.environments,n={};function a(e,t,n){r.INotification.warning(`Environment "${n}" has some inconsistencies.`,{buttons:[{label:"Correct",caption:"Correct installed packages",callback:()=>{r.INotification.inProgress("Correct the environment.").then((a=>{t.getPackageManager().install(e,n).then((()=>{r.INotification.update({toastId:a,message:"Environment corrected",type:"success",autoClose:5e3})})).catch((e=>{console.error(e),r.INotification.update({toastId:a,message:"Fail to correct the environment.",type:"error"})}))}))}}]})}e.forEach((e=>{const t=e.name.normalize("NFKD").replace(l,"").replace(/[^a-zA-Z0-9._-]/g,"_");n[t]=e.name}));for(const e of Object.keys(t.kernelspecs)){let o;const{conda_env_name:s,conda_env_path:r}=t.kernelspecs[e].metadata;if(r)o="root"===s?"base":i.PathExt.basename(r);else{const t=d.kernelNameToEnvironment(e);o=n[t]}if(o)try{const e=yield this._envManager.getPackageManager().refresh(!1,o),t=Object.keys(this._companions),n=[];e.forEach((e=>{if(t.indexOf(e.name)>=0&&!c.default.satisfies(e.version_installed,this._companions[e.name])){let t=d._semverToPython(c.default.validRange(this._companions[e.name]));t&&("<>=".indexOf(t[0])<0&&(t="="+t),n.push(e.name+t))}})),n.length>0&&a(n,this._envManager,o)}catch(e){console.error(`Fail to check environment '${o}'`,e)}}}))}validate(e){this._validateSpecs(null,e)}}t.CompanionValidator=d}}]);